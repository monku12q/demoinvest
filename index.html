<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoWealth Pro - Advanced Crypto MLM Platform</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0a0a1a;
            --secondary: #00ff88;
            --accent: #8a2be2;
            --warning: #ffaa00;
            --danger: #ff375f;
            --info: #00d4ff;
            --dark: #050510;
            --light: #f0f0f0;
            --card-bg: rgba(20, 20, 40, 0.95);
            --gradient: linear-gradient(135deg, #0a0a1a 0%, #151530 100%);
            --gradient-accent: linear-gradient(135deg, #00ff88 0%, #00d4ff 100%);
            --gradient-purple: linear-gradient(135deg, #8a2be2 0%, #ff00ff 100%);
            --shadow: 0 10px 30px rgba(0, 255, 136, 0.2);
            --glow: 0 0 20px rgba(0, 255, 136, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--gradient);
            color: var(--light);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            margin-bottom: 1rem;
            letter-spacing: 1px;
        }

        .container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(0, 255, 136, 0.3);
            border-radius: 50%;
            border-top-color: var(--secondary);
            animation: spin 1s linear infinite;
            margin-bottom: 2rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Header - Always Visible */
        header {
            background: rgba(10, 10, 26, 0.98);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 900;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
            text-decoration: none;
            white-space: nowrap;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 1rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--light);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 0.8rem;
            border-radius: 8px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
            position: relative;
            overflow: hidden;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        .nav-links a::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: var(--gradient-accent);
            transition: left 0.3s;
        }

        .nav-links a:hover::before {
            left: 0;
        }

        .nav-links a:hover {
            background: rgba(0, 255, 136, 0.1);
        }

        .auth-buttons {
            display: flex;
            gap: 0.5rem;
            margin-left: 1rem;
        }

        .auth-buttons .btn {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .mobile-menu-btn:hover {
            background: rgba(0, 255, 136, 0.1);
        }

        /* Company Overview Page - Always Visible */
        .company-overview {
            min-height: 100vh;
            padding-top: 80px;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 100%);
        }

        .hero-section {
            padding: 4rem 0;
            text-align: center;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(138, 43, 226, 0.1) 100%);
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://images.unsplash.com/photo-1620336655055-bd87c6d6420b?q=80&w=1000') center/cover no-repeat;
            opacity: 0.1;
            z-index: 0;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
        }

        .logo-large {
            font-size: 4rem;
            font-weight: 900;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        .tagline {
            font-size: 1.8rem;
            margin-bottom: 2rem;
            color: var(--light);
            font-weight: 300;
            line-height: 1.4;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 3rem;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 900;
            color: var(--secondary);
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 1rem;
            color: #a0a0c0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .mission-section {
            padding: 5rem 0;
            background: rgba(10, 10, 26, 0.8);
        }

        .mission-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }

        .mission-icon {
            font-size: 4rem;
            margin-bottom: 2rem;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .mission-text {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #cbd5e1;
            margin-bottom: 2rem;
        }

        .features-section {
            padding: 5rem 0;
            background: rgba(20, 20, 40, 0.8);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .feature-card {
            background: rgba(0, 255, 136, 0.05);
            border-radius: 12px;
            padding: 2rem;
            border: 1px solid rgba(0, 255, 136, 0.1);
            transition: all 0.3s;
            text-align: center;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--secondary);
            box-shadow: var(--shadow);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .feature-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--light);
        }

        .feature-description {
            color: #a0a0c0;
            line-height: 1.6;
        }

        .investment-plans-section {
            padding: 5rem 0;
            background: linear-gradient(135deg, rgba(10, 10, 26, 0.9) 0%, rgba(21, 21, 48, 0.9) 100%);
        }

        .plans-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .plan-overview-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            border: 2px solid rgba(0, 255, 136, 0.3);
            transition: all 0.3s;
        }

        .plan-overview-card:hover {
            transform: translateY(-5px);
            border-color: var(--secondary);
            box-shadow: var(--shadow);
        }

        .plan-name {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--secondary);
        }

        .plan-details {
            list-style: none;
            margin: 1.5rem 0;
        }

        .plan-details li {
            margin-bottom: 0.8rem;
            color: #cbd5e1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .plan-details i {
            color: var(--secondary);
        }

        .cta-section {
            padding: 5rem 0;
            text-align: center;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(138, 43, 226, 0.1) 100%);
        }

        .cta-content {
            max-width: 600px;
            margin: 0 auto;
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        /* Auth Modal */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
            overflow-y: auto;
            padding: 20px;
        }

        .auth-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .auth-container {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            padding: 3rem;
            border: 1px solid rgba(0, 255, 136, 0.3);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 136, 0.1), transparent);
            transition: left 0.5s;
        }

        .auth-container:hover::before {
            left: 100%;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-logo {
            font-size: 2rem;
            font-weight: 900;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 2rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 0.5rem;
        }

        .auth-tab {
            flex: 1;
            padding: 1rem;
            background: none;
            border: none;
            color: var(--light);
            font-weight: 600;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .auth-tab.active {
            background: var(--gradient-accent);
            color: var(--dark);
            box-shadow: var(--shadow);
        }

        .auth-form {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .auth-form.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .close-auth-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 55, 95, 0.2);
            border: 1px solid rgba(255, 55, 95, 0.5);
            color: var(--danger);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.4rem 0.8rem;
            border-radius: 50%;
            transition: all 0.3s;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            line-height: 1;
        }

        .close-auth-modal:hover {
            background: rgba(255, 55, 95, 0.3);
            color: var(--danger);
            transform: scale(1.1);
        }

        /* Main App - Hidden Initially */
        .app-container {
            display: none;
            min-height: 100vh;
        }

        /* Main Content */
        .main-content {
            margin-top: 80px;
            padding: 2rem 0;
            min-height: calc(100vh - 200px);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.2rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.2rem;
            border: 1px solid rgba(0, 255, 136, 0.2);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 136, 0.1), transparent);
            transition: left 0.5s;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            border-color: var(--secondary);
            box-shadow: var(--shadow);
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 0.8rem;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 900;
            font-family: 'Orbitron', sans-serif;
            color: var(--secondary);
            margin-bottom: 0.3rem;
        }

        .stat-label {
            color: #a0a0c0;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1.2px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: rgba(20, 20, 40, 0.8);
            border-radius: 10px;
            margin-bottom: 2rem;
            overflow-x: auto;
            padding: 0.4rem;
            gap: 0.4rem;
            scrollbar-width: thin;
            scrollbar-color: var(--secondary) transparent;
        }

        .tabs::-webkit-scrollbar {
            height: 6px;
        }

        .tabs::-webkit-scrollbar-track {
            background: transparent;
        }

        .tabs::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 3px;
        }

        .tab-btn {
            padding: 0.8rem 1rem;
            background: none;
            border: none;
            color: var(--light);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            min-height: 40px;
        }

        .tab-btn:hover {
            background: rgba(0, 255, 136, 0.1);
        }

        .tab-btn.active {
            background: var(--gradient-accent);
            color: var(--dark);
            box-shadow: var(--shadow);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        /* Investment Plans */
        .plans-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .plan-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            border: 2px solid rgba(0, 255, 136, 0.3);
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .plan-card.popular {
            border-color: var(--accent);
            transform: scale(1.02);
        }

        .plan-card.popular::before {
            content: "POPULAR";
            position: absolute;
            top: 12px;
            right: -28px;
            background: var(--accent);
            color: white;
            padding: 4px 25px;
            font-size: 0.7rem;
            font-weight: bold;
            transform: rotate(45deg);
        }

        .plan-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Leadership Rewards */
        .rewards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .reward-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            border: 2px solid rgba(138, 43, 226, 0.3);
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .reward-card.achieved {
            border-color: var(--secondary);
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.95) 0%, rgba(0, 255, 136, 0.1) 100%);
        }

        .reward-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--accent);
        }

        .reward-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            background: var(--gradient-purple);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        /* Level Income */
        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.2rem;
            margin-top: 1.5rem;
        }

        .level-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.2rem;
            border: 1px solid rgba(0, 255, 136, 0.2);
            text-align: center;
        }

        .level-number {
            font-size: 2rem;
            font-weight: 900;
            color: var(--secondary);
            margin-bottom: 0.8rem;
        }

        /* Network Tree */
        .network-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            margin: 1.5rem 0;
            overflow-x: auto;
            padding: 0.8rem;
        }

        .tree-level {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tree-node {
            width: 100px;
            height: 100px;
            background: var(--gradient-accent);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: var(--dark);
            font-weight: bold;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .tree-node:hover {
            transform: scale(1.05);
            box-shadow: var(--glow);
        }

        .tree-node.you {
            background: var(--gradient-purple);
            color: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        /* Crypto Chat */
        .chat-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 320px;
            height: 420px;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid rgba(0, 255, 136, 0.3);
            display: none;
            flex-direction: column;
            z-index: 1001;
            box-shadow: var(--shadow);
        }

        .chat-container.active {
            display: flex;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .chat-header {
            padding: 0.8rem;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex: 1;
            padding: 0.8rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .message {
            max-width: 80%;
            padding: 0.6rem 0.8rem;
            border-radius: 10px;
            position: relative;
            font-size: 0.9rem;
        }

        .message.user {
            align-self: flex-end;
            background: var(--gradient-accent);
            color: var(--dark);
        }

        .message.bot {
            align-self: flex-start;
            background: rgba(138, 43, 226, 0.2);
            border: 1px solid rgba(138, 43, 226, 0.5);
        }

        .chat-input {
            padding: 0.8rem;
            border-top: 1px solid rgba(0, 255, 136, 0.2);
            display: flex;
            gap: 0.4rem;
        }

        .chat-input input {
            flex: 1;
            padding: 0.6rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 6px;
            color: var(--light);
            font-size: 0.9rem;
        }

        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
            overflow-y: auto;
            padding: 20px;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--card-bg);
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid rgba(0, 255, 136, 0.3);
            position: relative;
            box-shadow: var(--shadow);
            margin: auto;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 55, 95, 0.2);
            border: 1px solid rgba(255, 55, 95, 0.5);
            color: var(--danger);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.4rem 0.8rem;
            border-radius: 50%;
            transition: all 0.3s;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            line-height: 1;
        }

        .close-modal:hover {
            background: rgba(255, 55, 95, 0.3);
            color: var(--danger);
            transform: scale(1.1);
        }

        /* Buttons */
        .btn {
            padding: 0.7rem 1.5rem;
            background: var(--gradient-accent);
            color: var(--dark);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            font-size: 0.9rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-success {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffaa00 0%, #ff8800 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff375f 0%, #ff002b 100%);
        }

        .btn-purple {
            background: var(--gradient-purple);
            color: white;
        }

        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.4rem;
            color: #cbd5e1;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-control {
            width: 100%;
            padding: 0.8rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 8px;
            color: var(--light);
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.2);
        }

        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
            font-size: 0.9rem;
        }

        .data-table th {
            background: rgba(0, 255, 136, 0.2);
            padding: 0.8rem;
            text-align: left;
            font-weight: 600;
            color: var(--secondary);
        }

        .data-table td {
            padding: 0.8rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-table tr:hover {
            background: rgba(0, 255, 136, 0.05);
        }

        /* Footer */
        footer {
            background: rgba(10, 10, 26, 0.98);
            padding: 2rem 0;
            margin-top: 3rem;
            border-top: 1px solid rgba(0, 255, 136, 0.1);
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        /* Notifications */
        .notification-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 3000;
        }

        .notification {
            background: var(--card-bg);
            border-left: 4px solid var(--secondary);
            color: white;
            padding: 0.8rem 1.2rem;
            border-radius: 8px;
            margin-bottom: 0.8rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            min-width: 250px;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification i {
            font-size: 1.2rem;
        }

        .notification.success {
            border-left-color: var(--secondary);
        }

        .notification.success i {
            color: var(--secondary);
        }

        .notification.error {
            border-left-color: var(--danger);
        }

        .notification.error i {
            color: var(--danger);
        }

        /* Marketplace Button */
        .marketplace-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--gradient-purple);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(138, 43, 226, 0.4);
            transition: all 0.3s;
        }

        .marketplace-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(138, 43, 226, 0.6);
        }

        /* Crypto Bot Modal */
        .crypto-bot-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 70vh;
            overflow-y: auto;
            z-index: 2001;
            display: none;
            box-shadow: var(--shadow);
            border: 2px solid var(--accent);
        }

        .crypto-bot-modal.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .bot-header {
            padding: 1rem;
            background: rgba(138, 43, 226, 0.2);
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .bot-content {
            padding: 1rem;
        }

        .bot-message {
            background: rgba(138, 43, 226, 0.1);
            padding: 0.8rem;
            border-radius: 8px;
            margin-bottom: 0.8rem;
            border-left: 4px solid var(--accent);
            font-size: 0.9rem;
        }

        .bot-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 0.8rem;
            margin-top: 1.2rem;
        }

        .bot-option {
            background: rgba(0, 255, 136, 0.1);
            padding: 0.8rem;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(0, 255, 136, 0.3);
            font-size: 0.85rem;
        }

        .bot-option:hover {
            background: rgba(0, 255, 136, 0.2);
            transform: translateY(-2px);
        }

        /* Referral Modal */
        .referral-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            border-radius: 15px;
            width: 90%;
            max-width: 450px;
            z-index: 2001;
            display: none;
            box-shadow: var(--shadow);
        }

        .referral-modal.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .referral-link-container {
            background: rgba(0, 255, 136, 0.1);
            padding: 0.8rem;
            border-radius: 8px;
            margin: 0.8rem 0;
            display: flex;
            gap: 0.4rem;
            align-items: center;
        }

        .referral-link {
            flex: 1;
            padding: 0.6rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            word-break: break-all;
            font-size: 0.85rem;
        }

        /* Copy Button Animation */
        .copy-success {
            background: var(--secondary) !important;
            color: var(--dark) !important;
        }

        /* Progress Bars */
        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-accent);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        /* Profile Sidebar */
        .profile-sidebar {
            position: fixed;
            top: 80px;
            right: 0;
            width: 280px;
            height: calc(100vh - 80px);
            background: var(--card-bg);
            border-left: 1px solid rgba(0, 255, 136, 0.2);
            z-index: 900;
            overflow-y: auto;
            padding: 1.5rem;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .profile-sidebar.active {
            transform: translateX(0);
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
        }

        .profile-sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
        }

        .profile-close-btn {
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.3s;
        }

        .profile-close-btn:hover {
            background: rgba(255, 55, 95, 0.2);
            color: var(--danger);
        }

        .profile-info-card {
            background: rgba(0, 255, 136, 0.1);
            border-radius: 10px;
            padding: 1.2rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--gradient-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            margin: 0 auto 1rem;
            border: 3px solid var(--secondary);
        }

        /* Admin Panel */
        .admin-panel {
            position: fixed;
            top: 80px;
            right: 0;
            width: 300px;
            height: calc(100vh - 80px);
            background: var(--card-bg);
            border-left: 1px solid rgba(255, 55, 95, 0.3);
            z-index: 901;
            overflow-y: auto;
            padding: 1.5rem;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .admin-panel.active {
            transform: translateX(0);
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 55, 95, 0.3);
        }

        .admin-close-btn {
            background: none;
            border: none;
            color: var(--danger);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.3s;
        }

        .admin-close-btn:hover {
            background: rgba(255, 55, 95, 0.2);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .nav-links {
                gap: 0.6rem;
            }
            
            .nav-links a {
                padding: 0.4rem 0.6rem;
                font-size: 0.85rem;
            }
            
            .profile-sidebar {
                width: 250px;
            }
            
            .admin-panel {
                width: 250px;
            }
        }

        @media (max-width: 992px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: rgba(10, 10, 26, 0.98);
                flex-direction: column;
                padding: 1rem;
                backdrop-filter: blur(15px);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
                z-index: 1001;
            }

            .nav-links.active {
                display: flex;
            }

            .mobile-menu-btn {
                display: block;
            }

            .logo {
                font-size: 1.3rem;
            }
            
            .profile-sidebar {
                width: 100%;
                transform: translateX(100%);
            }
            
            .admin-panel {
                width: 100%;
                transform: translateX(100%);
            }
            
            .hero-stats {
                gap: 2rem;
            }
            
            .stat-number {
                font-size: 2.5rem;
            }
            
            .logo-large {
                font-size: 3rem;
            }
            
            .tagline {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .tab-btn {
                flex: 1 0 calc(33.333% - 0.4rem);
                min-width: 120px;
                padding: 0.6rem 0.8rem;
            }

            .auth-container {
                padding: 2rem;
            }

            .modal-content {
                padding: 1.5rem;
            }

            .plans-container,
            .rewards-container {
                grid-template-columns: 1fr;
            }

            .level-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .chat-container {
                width: 280px;
                height: 380px;
            }
            
            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
            }
            
            .quick-actions {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .quick-actions .btn {
                flex: 1;
                min-width: 140px;
            }
            
            .hero-stats {
                gap: 1.5rem;
            }
            
            .stat-number {
                font-size: 2rem;
            }
            
            .stat-label {
                font-size: 0.9rem;
            }
            
            .logo-large {
                font-size: 2.5rem;
            }
            
            .tagline {
                font-size: 1.2rem;
            }
            
            .mission-icon {
                font-size: 3rem;
            }
            
            .mission-text {
                font-size: 1.1rem;
            }
            
            .feature-card {
                padding: 1.5rem;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .cta-buttons .btn {
                width: 100%;
                max-width: 300px;
            }
        }

        @media (max-width: 576px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .tab-btn {
                flex: 1 0 calc(50% - 0.4rem);
                min-width: 100px;
                font-size: 0.8rem;
            }

            .container {
                width: 95%;
            }

            .auth-container {
                padding: 1.5rem;
            }

            .tree-node {
                width: 80px;
                height: 80px;
                font-size: 0.8rem;
            }

            .stat-value {
                font-size: 1.6rem;
            }

            .level-grid {
                grid-template-columns: 1fr;
            }

            .chat-container {
                width: calc(100vw - 40px);
                height: 350px;
                right: 20px;
                left: 20px;
            }
            
            .quick-actions .btn {
                min-width: 100%;
            }
            
            .modal-content {
                padding: 1.2rem;
                width: 95%;
            }
            
            .hero-stats {
                flex-direction: column;
                gap: 1rem;
            }
            
            .stat-item {
                width: 100%;
            }
            
            .logo-large {
                font-size: 2rem;
            }
            
            .tagline {
                font-size: 1rem;
            }
            
            .mission-section,
            .features-section,
            .investment-plans-section,
            .cta-section {
                padding: 3rem 0;
            }
            
            .plans-overview {
                grid-template-columns: 1fr;
            }
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .status-active {
            background: rgba(0, 255, 136, 0.2);
            color: var(--secondary);
        }

        .status-pending {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning);
        }

        .status-completed {
            background: rgba(138, 43, 226, 0.2);
            color: var(--accent);
        }

        /* QR Code */
        .qr-code {
            display: flex;
            justify-content: center;
            margin: 1rem 0;
        }

        .qr-code img {
            width: 180px;
            height: 180px;
            border-radius: 8px;
            border: 2px solid rgba(0, 255, 136, 0.3);
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            margin: 1.5rem 0;
        }

        /* Welcome Section */
        .dashboard-header {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(0, 255, 136, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(0, 255, 136, 0.1);
        }
        
        /* Investment Plan Inputs */
        .plan-amount-input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            text-align: center;
        }
        
        .plan-amount-input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.2);
        }
        
        /* Prevent overflow on mobile */
        html, body {
            max-width: 100%;
            overflow-x: hidden;
        }
        
        .modal-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .modal-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        
        .modal-content::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 3px;
        }
        
        /* Admin Badge */
        .admin-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.6rem;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loader"></div>
        <h2>Loading CryptoWealth Pro</h2>
        <p>Connecting to secure network...</p>
    </div>

    <!-- Header with Login/Signup Buttons -->
    <header>
        <div class="container">
            <nav class="navbar">
                <a href="#" class="logo" onclick="showHomePage()">
                    <i class="fas fa-coins"></i>
                    CryptoWealth Pro
                </a>

                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>

                <ul class="nav-links" id="navLinks">
                    <li><a href="#" onclick="scrollToSection('hero')"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#" onclick="scrollToSection('mission')"><i class="fas fa-bullseye"></i> Mission</a></li>
                    <li><a href="#" onclick="scrollToSection('features')"><i class="fas fa-star"></i> Features</a></li>
                    <li><a href="#" onclick="scrollToSection('plans')"><i class="fas fa-chart-line"></i> Investment Plans</a></li>
                    <li><a href="#" onclick="scrollToSection('cta')"><i class="fas fa-handshake"></i> Get Started</a></li>
                    <div class="auth-buttons" id="guestAuthButtons">
                        <button class="btn btn-small" onclick="openAuthModal('login')">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                        <button class="btn btn-small btn-purple" onclick="openAuthModal('signup')">
                            <i class="fas fa-user-plus"></i> Sign Up
                        </button>
                    </div>
                </ul>

                <div class="user-section" id="userSection" style="display: none;">
                    <div class="user-avatar" onclick="toggleProfileSidebar()" id="userAvatar" style="position: relative;">
                        U
                        <div class="admin-badge" id="adminBadge" style="display: none;">ADMIN</div>
                    </div>
                    <button class="btn btn-small btn-danger" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h3 style="margin: 0; font-size: 1.2rem; color: var(--danger);"><i class="fas fa-user-shield"></i> Admin Panel</h3>
            <button class="admin-close-btn" onclick="toggleAdminPanel()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
            <h4 style="margin-bottom: 0.8rem; font-size: 1rem; color: var(--danger);"><i class="fas fa-cog"></i> System Settings</h4>
            <div style="background: rgba(255, 55, 95, 0.1); padding: 0.8rem; border-radius: 8px; font-size: 0.85rem;">
                <div class="form-group">
                    <label>Earning Start Time (Hours)</label>
                    <input type="number" class="form-control" id="earningStartTime" placeholder="24" min="1" max="168">
                    <small style="color: #a0a0c0;">After investment, earnings will start after this time</small>
                </div>
                
                <div class="form-group">
                    <label>Earning Interval (Minutes)</label>
                    <input type="number" class="form-control" id="earningInterval" placeholder="1440" min="1" max="10080">
                    <small style="color: #a0a0c0;">How often earnings are added (1440 = daily)</small>
                </div>
                
                <div class="form-group">
                    <label>Withdrawal Processing Time (Hours)</label>
                    <input type="number" class="form-control" id="withdrawalProcessingTime" placeholder="24" min="1" max="72">
                </div>
                
                <button class="btn btn-danger" style="width: 100%; margin-top: 0.5rem;" onclick="saveSystemSettings()">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
            <h4 style="margin-bottom: 0.8rem; font-size: 1rem; color: var(--danger);"><i class="fas fa-users"></i> User Management</h4>
            <div style="background: rgba(255, 55, 95, 0.1); padding: 0.8rem; border-radius: 8px; font-size: 0.85rem;">
                <div class="form-group">
                    <label>User ID</label>
                    <input type="text" class="form-control" id="adminUserId" placeholder="Enter user ID">
                </div>
                
                <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                    <button class="btn btn-small" style="flex: 1;" onclick="adminGetUserData()">
                        <i class="fas fa-search"></i> Find
                    </button>
                    <button class="btn btn-small btn-danger" style="flex: 1;" onclick="adminUpdateUserBalance()">
                        <i class="fas fa-dollar-sign"></i> Update Balance
                    </button>
                </div>
                
                <div id="adminUserInfo" style="margin-top: 0.8rem; display: none;">
                    <!-- User info will be shown here -->
                </div>
            </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
            <h4 style="margin-bottom: 0.8rem; font-size: 1rem; color: var(--danger);"><i class="fas fa-money-check-alt"></i> Deposit/Withdrawal Approval</h4>
            <div style="background: rgba(255, 55, 95, 0.1); padding: 0.8rem; border-radius: 8px; font-size: 0.85rem;">
                <button class="btn btn-small" style="width: 100%; margin-bottom: 0.5rem;" onclick="adminShowDepositRequests()">
                    <i class="fas fa-arrow-down"></i> Deposit Requests
                </button>
                <button class="btn btn-small" style="width: 100%;" onclick="adminShowWithdrawalRequests()">
                    <i class="fas fa-arrow-up"></i> Withdrawal Requests
                </button>
            </div>
        </div>
        
        <div>
            <h4 style="margin-bottom: 0.8rem; font-size: 1rem; color: var(--danger);"><i class="fas fa-chart-line"></i> System Stats</h4>
            <div style="background: rgba(255, 55, 95, 0.1); padding: 0.8rem; border-radius: 8px; font-size: 0.85rem;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Total Users:</span>
                    <strong id="adminTotalUsers">0</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Total Deposits:</span>
                    <strong id="adminTotalDeposits">0 USDT</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Total Withdrawals:</span>
                    <strong id="adminTotalWithdrawals">0 USDT</strong>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Platform Profit:</span>
                    <strong id="adminPlatformProfit">0 USDT</strong>
                </div>
            </div>
        </div>
        
        <button class="btn" style="width: 100%; margin-top: 1.5rem;" onclick="adminRefreshStats()">
            <i class="fas fa-sync-alt"></i> Refresh Stats
        </button>
    </div>

    <!-- Profile Sidebar -->
    <div class="profile-sidebar" id="profileSidebar">
        <div class="profile-sidebar-header">
            <h3 style="margin: 0; font-size: 1.2rem;"><i class="fas fa-user-circle"></i> Profile</h3>
            <button class="profile-close-btn" onclick="toggleProfileSidebar()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="profile-info-card">
            <div class="profile-avatar" id="sidebarAvatar">U</div>
            <h3 id="sidebarName">User Name</h3>
            <p id="sidebarEmail" style="font-size: 0.9rem; color: #a0a0c0;">user@email.com</p>
            <div style="margin-top: 1rem;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Rank:</span>
                    <strong id="sidebarRank">Bronze</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Level:</span>
                    <strong id="sidebarLevel">1</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Referrals:</span>
                    <strong id="sidebarReferrals">0</strong>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Balance:</span>
                    <strong id="sidebarBalance">0 USDT</strong>
                </div>
            </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
            <h4 style="margin-bottom: 0.8rem; font-size: 1rem;"><i class="fas fa-wallet"></i> Wallet Info</h4>
            <div style="background: rgba(20, 20, 40, 0.5); padding: 0.8rem; border-radius: 8px; font-size: 0.85rem;">
                <div style="margin-bottom: 0.5rem;">
                    <div style="color: #a0a0c0;">Wallet Address:</div>
                    <div style="word-break: break-all; font-size: 0.8rem;" id="sidebarWallet">0x000...0000</div>
                </div>
                <div>
                    <div style="color: #a0a0c0;">Join Date:</div>
                    <div id="sidebarJoinDate">2023-01-01</div>
                </div>
            </div>
        </div>
        
        <div>
            <h4 style="margin-bottom: 0.8rem; font-size: 1rem;"><i class="fas fa-chart-line"></i> Quick Stats</h4>
            <div style="background: rgba(20, 20, 40, 0.5); padding: 0.8rem; border-radius: 8px; font-size: 0.85rem;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Total Earned:</span>
                    <strong id="sidebarTotalEarned">0 USDT</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Withdrawn:</span>
                    <strong id="sidebarWithdrawn">0 USDT</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Active Investments:</span>
                    <strong id="sidebarActiveInvestments">0</strong>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Team Size:</span>
                    <strong id="sidebarTeamSize">0</strong>
                </div>
            </div>
        </div>
        
        <button class="btn btn-purple" style="width: 100%; margin-top: 1.5rem;" onclick="switchTab('profile')">
            <i class="fas fa-user-cog"></i> Edit Profile
        </button>
        
        <!-- Admin Button (only for admin users) -->
        <button class="btn btn-danger" style="width: 100%; margin-top: 0.8rem; display: none;" id="adminPanelBtn" onclick="toggleAdminPanel()">
            <i class="fas fa-user-shield"></i> Admin Panel
        </button>
    </div>

    <!-- Company Overview Page (Always Visible) -->
    <div class="company-overview" id="companyOverview">
        <!-- Hero Section -->
        <section class="hero-section" id="hero">
            <div class="container">
                <div class="hero-content">
                    <div class="logo-large">
                        <i class="fas fa-coins"></i>
                        CryptoWealth Pro
                    </div>
                    
                    <div class="tagline">
                        Advanced Crypto MLM Platform with 9-Level Team Commission & Leadership Rewards
                    </div>
                    
                    <p style="font-size: 1.2rem; margin-bottom: 2rem; color: #cbd5e1;">
                        Join thousands of investors earning daily returns of 6-7.5% with our secure USDT BEP20 investment platform. 
                        Build your team across 9 levels and claim exciting leadership rewards.
                    </p>
                    
                    <div class="hero-stats">
                        <div class="stat-item">
                            <div class="stat-number">360%</div>
                            <div class="stat-label">Total Returns</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">9</div>
                            <div class="stat-label">Commission Levels</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">6-7.5%</div>
                            <div class="stat-label">Daily Returns</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">24h</div>
                            <div class="stat-label">Withdrawal Time</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Mission Section -->
        <section class="mission-section" id="mission">
            <div class="container">
                <div class="mission-content">
                    <div class="mission-icon">
                        <i class="fas fa-bullseye"></i>
                    </div>
                    
                    <h2>Our Mission</h2>
                    
                    <div class="mission-text">
                        At CryptoWealth Pro, our mission is to democratize cryptocurrency investment opportunities 
                        through a transparent, secure, and rewarding MLM platform. We believe in creating wealth 
                        for our members while maintaining the highest standards of security and integrity.
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 3rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--secondary); margin-bottom: 1rem;">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3>Security First</h3>
                            <p style="color: #a0a0c0;">USDT BEP20 transactions with advanced security protocols</p>
                        </div>
                        
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--secondary); margin-bottom: 1rem;">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3>High Returns</h3>
                            <p style="color: #a0a0c0;">6-7.5% daily returns with principal included in all plans</p>
                        </div>
                        
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--secondary); margin-bottom: 1rem;">
                                <i class="fas fa-users"></i>
                            </div>
                            <h3>Team Building</h3>
                            <p style="color: #a0a0c0;">Earn from 9 levels of your network with up to 8% commission</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section" id="features">
            <div class="container">
                <h2 style="text-align: center; margin-bottom: 1rem;">Why Choose CryptoWealth Pro?</h2>
                <p style="text-align: center; margin-bottom: 3rem; color: #a0a0c0; max-width: 800px; margin-left: auto; margin-right: auto;">
                    Our platform combines the best of cryptocurrency investment with multi-level marketing to create 
                    unprecedented earning opportunities for our members.
                </p>
                
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3 class="feature-title">High Daily Returns</h3>
                        <p class="feature-description">
                            Earn 6-7.5% daily returns on your investments with principal included. 
                            Choose from multiple plans ranging from $5 to $5000.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-layer-group"></i>
                        </div>
                        <h3 class="feature-title">9-Level Commission</h3>
                        <p class="feature-description">
                            Build your team and earn commissions from 9 levels. 
                            From 8% on direct referrals to 1% on level 9, maximize your earnings.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <h3 class="feature-title">Leadership Rewards</h3>
                        <p class="feature-description">
                            Claim exciting rewards including iPhones, laptops, and luxury trips 
                            by achieving business targets and growing your team.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <h3 class="feature-title">Fast Withdrawals</h3>
                        <p class="feature-description">
                            Withdraw your earnings within 24 hours via USDT BEP20. 
                            Low 12% withdrawal fee with transparent processing.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <h3 class="feature-title">AI Support Bot</h3>
                        <p class="feature-description">
                            24/7 AI-powered support bot to answer all your cryptocurrency 
                            and investment questions instantly.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <h3 class="feature-title">Mobile Friendly</h3>
                        <p class="feature-description">
                            Fully responsive design that works perfectly on all devices - 
                            desktop, tablet, and mobile phones.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Investment Plans Overview -->
        <section class="investment-plans-section" id="plans">
            <div class="container">
                <h2 style="text-align: center; margin-bottom: 1rem;">Investment Plans Overview</h2>
                <p style="text-align: center; margin-bottom: 3rem; color: #a0a0c0; max-width: 800px; margin-left: auto; margin-right: auto;">
                    Choose from our range of investment plans designed to suit every budget and investment goal. 
                    Minimum investment $5, maximum $5000.
                </p>
                
                <div class="plans-overview">
                    <div class="plan-overview-card">
                        <h3 class="plan-name">Starter Plan</h3>
                        <div style="font-size: 2rem; color: var(--secondary); margin-bottom: 1rem;">6% Daily</div>
                        <ul class="plan-details">
                            <li><i class="fas fa-check"></i> Investment: $5 - $100</li>
                            <li><i class="fas fa-check"></i> Duration: 60 Days</li>
                            <li><i class="fas fa-check"></i> Total Return: 360%</li>
                            <li><i class="fas fa-check"></i> Principal Included</li>
                        </ul>
                    </div>
                    
                    <div class="plan-overview-card" style="border-color: var(--accent);">
                        <h3 class="plan-name">Growth Plan</h3>
                        <div style="font-size: 2rem; color: var(--accent); margin-bottom: 1rem;">6.5% Daily</div>
                        <ul class="plan-details">
                            <li><i class="fas fa-check"></i> Investment: $101 - $500</li>
                            <li><i class="fas fa-check"></i> Duration: 70 Days</li>
                            <li><i class="fas fa-check"></i> Total Return: 455%</li>
                            <li><i class="fas fa-check"></i> Principal Included</li>
                        </ul>
                    </div>
                    
                    <div class="plan-overview-card">
                        <h3 class="plan-name">Premium Plan</h3>
                        <div style="font-size: 2rem; color: var(--secondary); margin-bottom: 1rem;">7% Daily</div>
                        <ul class="plan-details">
                            <li><i class="fas fa-check"></i> Investment: $501 - $1000</li>
                            <li><i class="fas fa-check"></i> Duration: 80 Days</li>
                            <li><i class="fas fa-check"></i> Total Return: 560%</li>
                            <li><i class="fas fa-check"></i> Principal Included</li>
                        </ul>
                    </div>
                    
                    <div class="plan-overview-card">
                        <h3 class="plan-name">VIP Plan</h3>
                        <div style="font-size: 2rem; color: var(--secondary); margin-bottom: 1rem;">7.5% Daily</div>
                        <ul class="plan-details">
                            <li><i class="fas fa-check"></i> Investment: $1001 - $5000</li>
                            <li><i class="fas fa-check"></i> Duration: 100 Days</li>
                            <li><i class="fas fa-check"></i> Total Return: 750%</li>
                            <li><i class="fas fa-check"></i> Principal Included</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section" id="cta">
            <div class="container">
                <div class="cta-content">
                    <h2>Start Your Crypto Wealth Journey Today</h2>
                    <p style="font-size: 1.2rem; margin-bottom: 2rem; color: #cbd5e1;">
                        Join CryptoWealth Pro and unlock your financial potential. 
                        Create your account in minutes and start investing from as little as $5.
                    </p>
                    
                    <div class="cta-buttons">
                        <button class="btn btn-purple" onclick="openAuthModal('signup')" style="font-size: 1.1rem; padding: 1rem 2rem;">
                            <i class="fas fa-user-plus"></i> Create Free Account
                        </button>
                        <button class="btn" onclick="scrollToSection('features')" style="font-size: 1.1rem; padding: 1rem 2rem;">
                            <i class="fas fa-info-circle"></i> Learn More
                        </button>
                    </div>
                    
                    <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1);">
                        <p style="color: #a0a0c0; font-size: 0.9rem;">
                            <i class="fas fa-shield-alt"></i> 256-bit SSL Encryption  
                            <i class="fas fa-user-check"></i> 10,000+ Active Members  
                            <i class="fas fa-money-check-alt"></i> $2M+ Paid Out
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <div class="container">
                <div class="footer-grid">
                    <div>
                        <div class="logo">
                            <i class="fas fa-coins"></i>
                            CryptoWealth Pro
                        </div>
                        <p style="margin-top: 0.8rem; color: #a0a0c0; font-size: 0.9rem;">
                            Advanced Crypto MLM Platform with Leadership Rewards & 9-Level Team Commission
                        </p>
                    </div>
                    
                    <div>
                        <h4 style="font-size: 1rem;">Quick Links</h4>
                        <ul style="list-style: none; margin-top: 0.8rem;">
                            <li><a href="#" onclick="scrollToSection('hero')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Home</a></li>
                            <li><a href="#" onclick="scrollToSection('mission')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Mission</a></li>
                            <li><a href="#" onclick="scrollToSection('features')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Features</a></li>
                            <li><a href="#" onclick="scrollToSection('plans')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Plans</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="font-size: 1rem;">Contact</h4>
                        <p style="margin-top: 0.8rem; color: #a0a0c0; font-size: 0.9rem;">
                            <i class="fas fa-envelope"></i> support@cryptowealthpro.com<br>
                            <i class="fas fa-globe"></i> www.cryptowealthpro.com
                        </p>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1);">
                    <p style="font-size: 0.9rem;"> 2023 CryptoWealth Pro. All rights reserved.</p>
                    <p style="font-size: 0.8rem; color: #a0a0c0;">
                        Cryptocurrency investments involve risk. Please invest responsibly.
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Auth Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-container">
            <button class="close-auth-modal" onclick="closeAuthModal()">
                
            </button>
            
            <div class="auth-header">
                <div class="auth-logo">
                    <i class="fas fa-coins"></i>
                    CryptoWealth Pro
                </div>
                <p>Welcome to your financial freedom journey</p>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" data-auth-tab="login">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button class="auth-tab" data-auth-tab="signup">
                    <i class="fas fa-user-plus"></i> Sign Up
                </button>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="auth-form active">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" class="form-control" id="loginEmail" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-control" id="loginPassword" placeholder="Enter your password" required>
                </div>
                
                <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <input type="checkbox" id="rememberMe">
                        <label for="rememberMe" style="display: inline; margin-left: 5px; font-size: 0.9rem;">Remember me</label>
                    </div>
                    <a href="#" style="color: var(--secondary); text-decoration: none; font-size: 0.9rem;" onclick="showForgotPassword()">Forgot Password?</a>
                </div>
                
                <button type="submit" class="btn" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i> Login to Account
                </button>
                
                <div style="text-align: center; margin-top: 1.5rem; color: #a0a0c0; font-size: 0.9rem;">
                    Don't have an account? <a href="#" style="color: var(--secondary);" onclick="switchAuthTab('signup')">Sign up here</a>
                </div>
            </form>

            <!-- Signup Form -->
            <form id="signupForm" class="auth-form">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" class="form-control" id="signupName" placeholder="Enter your full name" required>
                </div>
                
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" class="form-control" id="signupEmail" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" class="form-control" id="signupPhone" placeholder="Enter your phone number" required>
                </div>
                
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-control" id="signupPassword" placeholder="Create a strong password" required>
                </div>
                
                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" class="form-control" id="signupConfirmPassword" placeholder="Confirm your password" required>
                </div>
                
                <div class="form-group">
                    <label>Referral Code (Optional)</label>
                    <input type="text" class="form-control" id="referralCode" placeholder="Enter referral code if any">
                </div>
                
                <div class="form-group">
                    <label>USDT BEP20 Wallet Address (Optional)</label>
                    <input type="text" class="form-control" id="usdtWallet" placeholder="Enter your USDT BEP20 wallet address">
                </div>
                
                <div class="form-group">
                    <input type="checkbox" id="agreeTerms" required>
                    <label for="agreeTerms" style="display: inline; margin-left: 5px; font-size: 0.9rem;">
                        I agree to the <a href="#" style="color: var(--secondary);">Terms & Conditions</a>
                    </label>
                </div>
                
                <button type="submit" class="btn btn-purple" style="width: 100%;">
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
                
                <div style="text-align: center; margin-top: 1.5rem; color: #a0a0c0; font-size: 0.9rem;">
                    Already have an account? <a href="#" style="color: var(--secondary);" onclick="switchAuthTab('login')">Login here</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Main App (Hidden Initially) -->
    <div class="app-container" id="appContainer">
        <!-- Dashboard Content -->
        <main class="main-content">
            <div class="container">
                <!-- Welcome Section -->
                <div class="dashboard-header">
                    <div>
                        <h1 id="welcomeMessage">Welcome to CryptoWealth Pro</h1>
                        <p id="userInfo">Loading your dashboard...</p>
                    </div>
                    <div class="quick-actions">
                        <button class="btn btn-success" onclick="openDepositModal()">
                            <i class="fas fa-plus"></i> Deposit USDT
                        </button>
                        <button class="btn btn-warning" onclick="openWithdrawModal()">
                            <i class="fas fa-wallet"></i> Withdraw USDT
                        </button>
                        <button class="btn btn-purple" onclick="showReferralModal()">
                            <i class="fas fa-share-alt"></i> Invite & Earn
                        </button>
                        <button class="btn btn-success" onclick="claimDailyBonus()" id="dailyBonusBtn">
                            <i class="fas fa-gift"></i> Claim Daily Bonus ($0.01)
                        </button>
                    </div>
                </div>

                <!-- Dashboard Stats -->
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="stat-value" id="balanceAmount">0 USDT</div>
                        <div class="stat-label">Total Balance</div>
                        <div class="stat-sub" style="font-size: 0.8rem; color: #a0a0c0;">Available for withdrawal</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-value" id="todayEarnings">+0 USDT</div>
                        <div class="stat-label">Today's Earnings</div>
                        <div class="stat-sub" style="font-size: 0.8rem; color: #a0a0c0;">Live updating</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-value" id="totalReferrals">0</div>
                        <div class="stat-label">Total Team</div>
                        <div class="stat-sub" style="font-size: 0.8rem; color: #a0a0c0;">Across 9 levels</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-value" id="userRank">Bronze</div>
                        <div class="stat-label">Current Rank</div>
                        <div class="stat-sub" style="font-size: 0.8rem; color: #a0a0c0;">Complete tasks to level up</div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab-btn active" data-tab="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</button>
                    <button class="tab-btn" data-tab="plans"><i class="fas fa-chart-line"></i> Investment Plans</button>
                    <button class="tab-btn" data-tab="rewards"><i class="fas fa-trophy"></i> Leadership Rewards</button>
                    <button class="tab-btn" data-tab="levels"><i class="fas fa-layer-group"></i> Team Commission</button>
                    <button class="tab-btn" data-tab="network"><i class="fas fa-network-wired"></i> Network Tree</button>
                    <button class="tab-btn" data-tab="earnings"><i class="fas fa-money-bill-wave"></i> Earnings</button>
                    <button class="tab-btn" data-tab="transactions"><i class="fas fa-exchange-alt"></i> Transactions</button>
                    <button class="tab-btn" data-tab="profile"><i class="fas fa-user-cog"></i> Profile</button>
                </div>

                <!-- Dashboard Tab -->
                <div id="dashboard" class="tab-content active">
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem;">
                        <div>
                            <h3><i class="fas fa-history"></i> Recent Activity</h3>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Activity</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="recentActivity">
                                    <tr><td colspan="4" style="text-align: center; padding: 2rem;">No recent activity</td></tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div>
                            <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                            <div style="display: flex; flex-direction: column; gap: 0.8rem; margin-top: 1rem;">
                                <button class="btn" onclick="openDepositModal()">
                                    <i class="fas fa-plus-circle"></i> Deposit USDT
                                </button>
                                <button class="btn btn-purple" onclick="showReferralModal()">
                                    <i class="fas fa-share-alt"></i> Share Referral
                                </button>
                                <button class="btn" onclick="switchTab('rewards')">
                                    <i class="fas fa-trophy"></i> Check Rewards
                                </button>
                                <button class="btn btn-success" onclick="claimDailyBonus()">
                                    <i class="fas fa-gift"></i> Claim Daily Bonus
                                </button>
                            </div>
                            
                            <h3 style="margin-top: 1.5rem;"><i class="fas fa-business-time"></i> Business Summary</h3>
                            <div style="background: rgba(0,255,136,0.1); padding: 1rem; border-radius: 8px; margin-top: 0.8rem;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span>Self Business:</span>
                                    <strong id="selfBusiness">0 USDT</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span>Team Business:</span>
                                    <strong id="teamBusiness">0 USDT</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Total Business:</span>
                                    <strong id="totalBusiness">0 USDT</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Investment Plans Tab -->
                <div id="plans" class="tab-content">
                    <h2><i class="fas fa-chart-line"></i> Investment Plans</h2>
                    <p style="margin-bottom: 1rem;">Invest in any plan with USDT BEP20. Minimum deposit: $5, Maximum: $5000</p>
                    
                    <div class="plans-container">
                        <!-- Plan 1: $5-$100 -->
                        <div class="plan-card">
                            <div class="plan-icon"><i class="fas fa-seedling"></i></div>
                            <h3>Starter Plan</h3>
                            <div class="stat-value">6% Daily</div>
                            <div class="stat-label">For 60 Days</div>
                            <div style="margin: 1.2rem 0; text-align: left; font-size: 0.9rem;">
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Investment: $5 - $100</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Daily Return: 6%</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Duration: 60 Days</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Total Return: 360%</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Principal Included</div>
                            </div>
                            
                            <div class="form-group">
                                <label>Investment Amount ($)</label>
                                <input type="number" class="form-control plan-amount-input" id="plan1Amount" placeholder="5-100" min="5" max="100" value="50" step="1">
                            </div>
                            
                            <div style="margin: 1rem 0; padding: 0.8rem; background: rgba(0,255,136,0.1); border-radius: 8px;">
                                <div>Daily Earning: <strong id="plan1Daily">$3.00</strong></div>
                                <div>Total Return: <strong id="plan1Total">$180.00</strong></div>
                            </div>
                            
                            <button class="btn btn-success" style="width: 100%;" onclick="investInPlan(1)">
                                <i class="fas fa-hand-holding-usd"></i> Invest Now
                            </button>
                        </div>
                        
                        <!-- Plan 2: $101-$500 -->
                        <div class="plan-card popular">
                            <div class="plan-icon"><i class="fas fa-tree"></i></div>
                            <h3>Growth Plan</h3>
                            <div class="stat-value">6.5% Daily</div>
                            <div class="stat-label">For 70 Days</div>
                            <div style="margin: 1.2rem 0; text-align: left; font-size: 0.9rem;">
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Investment: $101 - $500</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Daily Return: 6.5%</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Duration: 70 Days</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Total Return: 455%</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Principal Included</div>
                            </div>
                            
                            <div class="form-group">
                                <label>Investment Amount ($)</label>
                                <input type="number" class="form-control plan-amount-input" id="plan2Amount" placeholder="101-500" min="101" max="500" value="250" step="1">
                            </div>
                            
                            <div style="margin: 1rem 0; padding: 0.8rem; background: rgba(0,255,136,0.1); border-radius: 8px;">
                                <div>Daily Earning: <strong id="plan2Daily">$16.25</strong></div>
                                <div>Total Return: <strong id="plan2Total">$1,137.50</strong></div>
                            </div>
                            
                            <button class="btn btn-success" style="width: 100%;" onclick="investInPlan(2)">
                                <i class="fas fa-hand-holding-usd"></i> Invest Now
                            </button>
                        </div>
                        
                        <!-- Plan 3: $501-$1000 -->
                        <div class="plan-card">
                            <div class="plan-icon"><i class="fas fa-mountain"></i></div>
                            <h3>Premium Plan</h3>
                            <div class="stat-value">7% Daily</div>
                            <div class="stat-label">For 80 Days</div>
                            <div style="margin: 1.2rem 0; text-align: left; font-size: 0.9rem;">
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Investment: $501 - $1000</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Daily Return: 7%</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Duration: 80 Days</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Total Return: 560%</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Principal Included</div>
                            </div>
                            
                            <div class="form-group">
                                <label>Investment Amount ($)</label>
                                <input type="number" class="form-control plan-amount-input" id="plan3Amount" placeholder="501-1000" min="501" max="1000" value="750" step="1">
                            </div>
                            
                            <div style="margin: 1rem 0; padding: 0.8rem; background: rgba(0,255,136,0.1); border-radius: 8px;">
                                <div>Daily Earning: <strong id="plan3Daily">$52.50</strong></div>
                                <div>Total Return: <strong id="plan3Total">$4,200.00</strong></div>
                            </div>
                            
                            <button class="btn btn-success" style="width: 100%;" onclick="investInPlan(3)">
                                <i class="fas fa-hand-holding-usd"></i> Invest Now
                            </button>
                        </div>
                        
                        <!-- Plan 4: $1001-$5000 -->
                        <div class="plan-card">
                            <div class="plan-icon"><i class="fas fa-crown"></i></div>
                            <h3>VIP Plan</h3>
                            <div class="stat-value">7.5% Daily</div>
                            <div class="stat-label">For 100 Days</div>
                            <div style="margin: 1.2rem 0; text-align: left; font-size: 0.9rem;">
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Investment: $1001 - $5000</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Daily Return: 7.5%</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Duration: 100 Days</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Total Return: 750%</div>
                                <div><i class="fas fa-check" style="color: var(--secondary);"></i> Principal Included</div>
                            </div>
                            
                            <div class="form-group">
                                <label>Investment Amount ($)</label>
                                <input type="number" class="form-control plan-amount-input" id="plan4Amount" placeholder="1001-5000" min="1001" max="5000" value="2500" step="1">
                            </div>
                            
                            <div style="margin: 1rem 0; padding: 0.8rem; background: rgba(0,255,136,0.1); border-radius: 8px;">
                                <div>Daily Earning: <strong id="plan4Daily">$187.50</strong></div>
                                <div>Total Return: <strong id="plan4Total">$18,750.00</strong></div>
                            </div>
                            
                            <button class="btn btn-success" style="width: 100%;" onclick="investInPlan(4)">
                                <i class="fas fa-hand-holding-usd"></i> Invest Now
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem;">
                        <h3><i class="fas fa-history"></i> Investment History</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Plan</th>
                                    <th>Amount</th>
                                    <th>Date</th>
                                    <th>Daily Return</th>
                                    <th>Days Left</th>
                                    <th>Total Earned</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="investmentHistory">
                                <tr><td colspan="7" style="text-align: center; padding: 2rem;">No investment history</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Leadership Rewards Tab -->
                <div id="rewards" class="tab-content">
                    <h2><i class="fas fa-trophy"></i> Leadership Performance Rewards</h2>
                    <p style="margin-bottom: 1rem;">Achieve business targets and claim exciting rewards! Minimum deposit $50 required. Business counted from multiple IDs only.</p>
                    
                    <div class="rewards-container">
                        <!-- Reward 1: iPhone 17 Pro Max -->
                        <div class="reward-card" id="reward1">
                            <div class="reward-badge">Reward 1</div>
                            <div class="reward-icon"><i class="fas fa-mobile-alt"></i></div>
                            <h3>iPhone 17 Pro Max</h3>
                            <div style="margin: 1.2rem 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 0.9rem;">
                                    <span>Self Business:</span>
                                    <strong>$1000</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.8rem; font-size: 0.9rem;">
                                    <span>Team Business:</span>
                                    <strong>$3500</strong>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="reward1Progress" style="width: 0%"></div>
                                </div>
                                <div style="text-align: center; margin-top: 0.5rem; font-size: 0.8rem;">
                                    Progress: <span id="reward1ProgressText">0%</span>
                                </div>
                            </div>
                            <div style="margin: 1.2rem 0; padding: 0.8rem; background: rgba(0,255,136,0.1); border-radius: 8px; font-size: 0.85rem;">
                                <div><i class="fas fa-info-circle"></i> Required: $1000 self + $3500 team</div>
                                <div><i class="fas fa-users"></i> Counted from multiple IDs</div>
                            </div>
                            <button class="btn btn-success" id="reward1Btn" style="width: 100%;" onclick="claimReward(1)" disabled>
                                <i class="fas fa-gift"></i> Claim Reward
                            </button>
                        </div>
                        
                        <!-- Reward 2: Apple Laptop -->
                        <div class="reward-card" id="reward2">
                            <div class="reward-badge">Reward 2</div>
                            <div class="reward-icon"><i class="fas fa-laptop"></i></div>
                            <h3>Apple Laptop</h3>
                            <div style="margin: 1.2rem 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 0.9rem;">
                                    <span>Self Business:</span>
                                    <strong>$750</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.8rem; font-size: 0.9rem;">
                                    <span>Team Business:</span>
                                    <strong>$3000</strong>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="reward2Progress" style="width: 0%"></div>
                                </div>
                                <div style="text-align: center; margin-top: 0.5rem; font-size: 0.8rem;">
                                    Progress: <span id="reward2ProgressText">0%</span>
                                </div>
                            </div>
                            <div style="margin: 1.2rem 0; padding: 0.8rem; background: rgba(0,255,136,0.1); border-radius: 8px; font-size: 0.85rem;">
                                <div><i class="fas fa-info-circle"></i> Required: $750 self + $3000 team</div>
                                <div><i class="fas fa-users"></i> Counted from multiple IDs</div>
                            </div>
                            <button class="btn btn-success" id="reward2Btn" style="width: 100%;" onclick="claimReward(2)" disabled>
                                <i class="fas fa-gift"></i> Claim Reward
                            </button>
                        </div>
                        
                        <!-- Reward 3: Goa Trip -->
                        <div class="reward-card" id="reward3">
                            <div class="reward-badge">Reward 3</div>
                            <div class="reward-icon"><i class="fas fa-umbrella-beach"></i></div>
                            <h3>Goa Trip</h3>
                            <div style="margin: 1.2rem 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 0.9rem;">
                                    <span>Self Business:</span>
                                    <strong>$500</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.8rem; font-size: 0.9rem;">
                                    <span>Team Business:</span>
                                    <strong>$2500</strong>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="reward3Progress" style="width: 0%"></div>
                                </div>
                                <div style="text-align: center; margin-top: 0.5rem; font-size: 0.8rem;">
                                    Progress: <span id="reward3ProgressText">0%</span>
                                </div>
                            </div>
                            <div style="margin: 1.2rem 0; padding: 0.8rem; background: rgba(0,255,136,0.1); border-radius: 8px; font-size: 0.85rem;">
                                <div><i class="fas fa-info-circle"></i> Required: $500 self + $2500 team</div>
                                <div><i class="fas fa-users"></i> Counted from multiple IDs</div>
                            </div>
                            <button class="btn btn-success" id="reward3Btn" style="width: 100%;" onclick="claimReward(3)" disabled>
                                <i class="fas fa-gift"></i> Claim Reward
                            </button>
                        </div>
                        
                        <!-- Reward 4: Thailand Trip -->
                        <div class="reward-card" id="reward4">
                            <div class="reward-badge">Reward 4</div>
                            <div class="reward-icon"><i class="fas fa-plane"></i></div>
                            <h3>Thailand Trip</h3>
                            <div style="margin: 1.2rem 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 0.9rem;">
                                    <span>Self Business:</span>
                                    <strong>$1500</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.8rem; font-size: 0.9rem;">
                                    <span>Team Business:</span>
                                    <strong>$5000</strong>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="reward4Progress" style="width: 0%"></div>
                                </div>
                                <div style="text-align: center; margin-top: 0.5rem; font-size: 0.8rem;">
                                    Progress: <span id="reward4ProgressText">0%</span>
                                </div>
                            </div>
                            <div style="margin: 1.2rem 0; padding: 0.8rem; background: rgba(0,255,136,0.1); border-radius: 8px; font-size: 0.85rem;">
                                <div><i class="fas fa-info-circle"></i> Required: $1500 self + $5000 team</div>
                                <div><i class="fas fa-users"></i> Counted from multiple IDs</div>
                            </div>
                            <button class="btn btn-success" id="reward4Btn" style="width: 100%;" onclick="claimReward(4)" disabled>
                                <i class="fas fa-gift"></i> Claim Reward
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem;">
                        <h3><i class="fas fa-award"></i> Claimed Rewards</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Reward</th>
                                    <th>Requirements</th>
                                    <th>Claim Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="claimedRewards">
                                <tr><td colspan="4" style="text-align: center; padding: 2rem;">No rewards claimed yet</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 9-Level Commission Tab -->
                <div id="levels" class="tab-content">
                    <h2><i class="fas fa-layer-group"></i> 9-Level Team Commission</h2>
                    <p style="margin-bottom: 1rem;">Earn from 9 levels of your team with our unique commission structure</p>
                    
                    <div class="level-grid">
                        <div class="level-card">
                            <div class="level-number">Level 1</div>
                            <div class="stat-value">8%</div>
                            <div class="stat-label">Direct Referrals</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level1Count">0</strong></div>
                                <div>Earnings: <strong id="level1Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 2</div>
                            <div class="stat-value">6%</div>
                            <div class="stat-label">Second Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level2Count">0</strong></div>
                                <div>Earnings: <strong id="level2Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 3</div>
                            <div class="stat-value">5%</div>
                            <div class="stat-label">Third Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level3Count">0</strong></div>
                                <div>Earnings: <strong id="level3Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 4</div>
                            <div class="stat-value">4%</div>
                            <div class="stat-label">Fourth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level4Count">0</strong></div>
                                <div>Earnings: <strong id="level4Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 5</div>
                            <div class="stat-value">3%</div>
                            <div class="stat-label">Fifth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level5Count">0</strong></div>
                                <div>Earnings: <strong id="level5Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 6</div>
                            <div class="stat-value">2%</div>
                            <div class="stat-label">Sixth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level6Count">0</strong></div>
                                <div>Earnings: <strong id="level6Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 7</div>
                            <div class="stat-value">2%</div>
                            <div class="stat-label">Seventh Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level7Count">0</strong></div>
                                <div>Earnings: <strong id="level7Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 8</div>
                            <div class="stat-value">1%</div>
                            <div class="stat-label">Eighth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level8Count">0</strong></div>
                                <div>Earnings: <strong id="level8Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 9</div>
                            <div class="stat-value">1%</div>
                            <div class="stat-label">Ninth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level9Count">0</strong></div>
                                <div>Earnings: <strong id="level9Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem; padding: 1.2rem; background: rgba(0,255,136,0.1); border-radius: 10px;">
                        <h3><i class="fas fa-calculator"></i> Total Team Commission</h3>
                        <div class="stat-value" id="totalTeamCommission">0 USDT</div>
                        <div class="stat-label">Total earnings from all 9 levels</div>
                    </div>
                </div>

                <!-- Network Tab -->
                <div id="network" class="tab-content">
                    <h2><i class="fas fa-network-wired"></i> Your Network Tree</h2>
                    
                    <div class="network-tree" id="networkTree">
                        <div class="tree-level">
                            <div class="tree-node you">
                                YOU
                                <div class="node-info">You</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <h3><i class="fas fa-info-circle"></i> Network Statistics</h3>
                        <div class="dashboard-grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));">
                            <div class="stat-card">
                                <div class="stat-value" id="totalDownline">0</div>
                                <div class="stat-label">Total Downline</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="activeDownline">0</div>
                                <div class="stat-label">Active Members</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="totalTeams">0</div>
                                <div class="stat-label">Teams</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="networkGrowth">0%</div>
                                <div class="stat-label">Monthly Growth</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Earnings Tab -->
                <div id="earnings" class="tab-content">
                    <h2><i class="fas fa-money-bill-wave"></i> Earnings Report</h2>
                    
                    <div class="dashboard-grid" style="grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));">
                        <div class="stat-card">
                            <div class="stat-value" id="totalEarningsAmount">0 USDT</div>
                            <div class="stat-label">Total Earnings</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="withdrawnAmount">0 USDT</div>
                            <div class="stat-label">Withdrawn</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="availableEarnings">0 USDT</div>
                            <div class="stat-label">Available</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="pendingEarnings">0 USDT</div>
                            <div class="stat-label">Pending</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 1.5rem;"><i class="fas fa-chart-bar"></i> Earning Sources</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Source</th>
                                <th>Amount</th>
                                <th>Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="earningsTable">
                            <tr><td colspan="4" style="text-align: center; padding: 2rem;">No earnings yet</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Transactions Tab -->
                <div id="transactions" class="tab-content">
                    <h2><i class="fas fa-exchange-alt"></i> Transaction History</h2>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem;">
                        <div>
                            <h3><i class="fas fa-arrow-down"></i> Deposits</h3>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Amount</th>
                                        <th>Method</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="depositsTable">
                                    <tr><td colspan="4" style="text-align: center; padding: 2rem;">No deposits yet</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div>
                            <h3><i class="fas fa-arrow-up"></i> Withdrawals</h3>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Amount</th>
                                        <th>Net Amount</th>
                                        <th>Fee (12%)</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="withdrawalsTable">
                                    <tr><td colspan="5" style="text-align: center; padding: 2rem;">No withdrawals yet</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Profile Tab -->
                <div id="profile" class="tab-content">
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 1.5rem;">
                        <div>
                            <div class="stat-card" style="text-align: center;">
                                <div class="user-avatar" style="width: 80px; height: 80px; margin: 0 auto 0.8rem; font-size: 1.8rem;">
                                    <span id="profileAvatar">U</span>
                                </div>
                                <h3 id="profileName">User Name</h3>
                                <p id="profileEmail" style="font-size: 0.9rem;">user@email.com</p>
                                <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                    <p>Member ID: <strong id="userId">USER001</strong></p>
                                    <p>Join Date: <strong id="joinDate">2023-11-01</strong></p>
                                    <p>Referral Code: <strong id="userReferralCode">ABC123</strong></p>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3><i class="fas fa-user-cog"></i> Account Settings</h3>
                            <div class="form-group">
                                <label>Full Name</label>
                                <input type="text" class="form-control" id="settingsName">
                            </div>
                            <div class="form-group">
                                <label>Email Address</label>
                                <input type="email" class="form-control" id="settingsEmail">
                            </div>
                            <div class="form-group">
                                <label>Phone Number</label>
                                <input type="tel" class="form-control" id="settingsPhone">
                            </div>
                            <div class="form-group">
                                <label>USDT BEP20 Wallet Address</label>
                                <input type="text" class="form-control" id="walletAddress" placeholder="Enter your USDT BEP20 wallet address">
                            </div>
                            <button class="btn" onclick="updateProfile()">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- All Modals -->
        <!-- Deposit Modal -->
        <div class="modal" id="depositModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closeDepositModal()">
                    
                </button>
                
                <h2><i class="fas fa-plus-circle"></i> Deposit USDT</h2>
                <p style="margin-bottom: 1rem;">Deposit USDT via BEP20 network only. Minimum: $5, Maximum: $5000</p>
                
                <div class="form-group">
                    <label>Amount (USDT)</label>
                    <input type="number" class="form-control" id="depositAmount" placeholder="5" min="5" max="5000" value="50">
                    <small style="color: #a0a0c0; font-size: 0.85rem;">Minimum $5, Maximum $5000</small>
                </div>
                
                <div class="qr-code">
                    <img src="" alt="USDT Deposit QR Code" id="depositQRCode">
                </div>
                
                <div class="form-group">
                    <label>USDT BEP20 Wallet Address</label>
                    <input type="text" class="form-control" id="depositAddress" value="0x742d35Cc6634C0532925a3b844Bc9e0F3A5C3a2E" readonly>
                </div>
                
                <div style="background: rgba(0,255,136,0.1); padding: 0.8rem; border-radius: 8px; margin-top: 1rem; font-size: 0.9rem;">
                    <p><i class="fas fa-info-circle"></i> Important Instructions:</p>
                    <ol style="margin-left: 1.2rem; margin-top: 0.5rem;">
                        <li>Send USDT via BEP20 network only</li>
                        <li>Minimum deposit: <span id="minDepositAmount">5</span> USDT</li>
                        <li>Maximum deposit: <span id="maxDepositAmount">5000</span> USDT</li>
                        <li>Deposit will be credited within 5 minutes</li>
                        <li>Contact support if deposit not credited within 30 minutes</li>
                    </ol>
                </div>
                
                <div style="display: flex; gap: 0.8rem; margin-top: 1.2rem;">
                    <button class="btn" onclick="closeDepositModal()" style="flex: 1;">
                        <i class="fas fa-times"></i> Close
                    </button>
                    <button class="btn btn-success" style="flex: 2;" onclick="processDeposit()">
                        <i class="fas fa-paper-plane"></i> Confirm Deposit Request
                    </button>
                </div>
            </div>
        </div>

        <!-- Withdraw Modal -->
        <div class="modal" id="withdrawModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closeWithdrawModal()">
                    
                </button>
                
                <h2><i class="fas fa-wallet"></i> Withdraw USDT</h2>
                
                <div style="background: rgba(0,255,136,0.1); padding: 0.8rem; border-radius: 8px; margin-bottom: 1.2rem; font-size: 0.9rem;">
                    <p><i class="fas fa-info-circle"></i> Available Balance: <strong id="availableBalance">0 USDT</strong></p>
                    <p>Minimum Withdrawal: <strong>1 USDT</strong></p>
                    <p>Withdrawal Fee: <strong id="withdrawalFeePercent">12%</strong></p>
                    <p>Processing Time: <strong>1-24 hours</strong></p>
                    <p>Network: <strong>BEP20 Only</strong></p>
                </div>
                
                <div class="form-group">
                    <label>Amount (USDT)</label>
                    <input type="number" class="form-control" id="withdrawAmount" placeholder="1" min="1">
                    <small style="color: #a0a0c0; font-size: 0.85rem;">Minimum withdrawal: 1 USDT</small>
                </div>
                
                <div class="form-group">
                    <label>Withdrawal Fee (<span id="feePercent">12</span>%)</label>
                    <input type="text" class="form-control" id="withdrawalFee" value="0" readonly>
                </div>
                
                <div class="form-group">
                    <label>Net Amount (You Receive)</label>
                    <input type="text" class="form-control" id="netAmount" value="0" readonly>
                </div>
                
                <div class="form-group">
                    <label>USDT BEP20 Wallet Address</label>
                    <input type="text" class="form-control" id="withdrawAddress" placeholder="Enter your USDT BEP20 wallet address">
                </div>
                
                <div style="display: flex; gap: 0.8rem; margin-top: 1.2rem;">
                    <button class="btn" onclick="closeWithdrawModal()" style="flex: 1;">
                        <i class="fas fa-times"></i> Close
                    </button>
                    <button class="btn btn-warning" style="flex: 2;" onclick="processWithdrawal()">
                        <i class="fas fa-paper-plane"></i> Request Withdrawal
                    </button>
                </div>
            </div>
        </div>

        <!-- Support Chat -->
        <div class="chat-container" id="chatContainer">
            <div class="chat-header">
                <h3 style="margin: 0; font-size: 1rem;"><i class="fas fa-comments"></i> Support Chat</h3>
                <button class="btn btn-small" onclick="hideChat()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message bot">
                    <strong>Support Bot:</strong> Welcome to Support Chat! How can I help you today?
                </div>
            </div>
            
            <div class="chat-input">
                <input type="text" id="chatInput" placeholder="Type your message...">
                <button class="btn" onclick="sendChatMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>

        <!-- Marketplace Button -->
        <div class="marketplace-button" onclick="showCryptoBot()">
            <i class="fas fa-robot"></i>
        </div>

        <!-- Crypto Bot Modal -->
        <div class="crypto-bot-modal" id="cryptoBotModal">
            <div class="bot-header">
                <h3 style="margin: 0; font-size: 1rem;"><i class="fas fa-robot"></i> Crypto Currency Chat Bot</h3>
                <button class="btn btn-small" onclick="hideCryptoBot()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="bot-content">
                <div class="bot-message">
                    <strong>Crypto Bot:</strong> Welcome! I'm your AI cryptocurrency assistant. How can I help you today?
                </div>
                
                <div class="bot-options">
                    <div class="bot-option" onclick="askBotQuestion('bitcoin')">
                        <i class="fab fa-bitcoin"></i>
                        <div>Bitcoin Info</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('ethereum')">
                        <i class="fab fa-ethereum"></i>
                        <div>Ethereum Info</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('usdt')">
                        <i class="fas fa-coins"></i>
                        <div>USDT Guide</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('investment')">
                        <i class="fas fa-chart-line"></i>
                        <div>Investment Tips</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('security')">
                        <i class="fas fa-shield-alt"></i>
                        <div>Security Tips</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('withdrawal')">
                        <i class="fas fa-wallet"></i>
                        <div>Withdrawal Help</div>
                    </div>
                </div>
                
                <div style="margin-top: 1.2rem;">
                    <input type="text" class="form-control" id="botQuestion" placeholder="Ask me anything about crypto..." onkeypress="if(event.key==='Enter') askCustomQuestion()">
                    <button class="btn" style="width: 100%; margin-top: 0.5rem;" onclick="askCustomQuestion()">
                        <i class="fas fa-paper-plane"></i> Ask Question
                    </button>
                </div>
            </div>
        </div>

        <!-- Referral Modal -->
        <div class="referral-modal" id="referralModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closeReferralModal()">
                    
                </button>
                
                <h2><i class="fas fa-share-alt"></i> Invite & Earn</h2>
                <p style="margin-bottom: 1rem;">Share your referral link and earn commissions from 9 levels!</p>
                
                <div class="referral-link-container">
                    <div class="referral-link" id="referralLinkText"></div>
                    <button class="btn btn-small" onclick="copyReferralLink()" id="copyBtn">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
                
                <div style="background: rgba(0,255,136,0.1); padding: 0.8rem; border-radius: 8px; margin-top: 0.8rem; font-size: 0.9rem;">
                    <h4 style="margin-bottom: 0.5rem;"><i class="fas fa-money-bill-wave"></i> Commission Structure</h4>
                    <ul style="margin-left: 1.2rem; margin-top: 0.5rem;">
                        <li>Level 1 (Direct Referrals): <strong>8%</strong></li>
                        <li>Level 2: <strong>6%</strong></li>
                        <li>Level 3: <strong>5%</strong></li>
                        <li>Level 4: <strong>4%</strong></li>
                        <li>Level 5: <strong>3%</strong></li>
                        <li>Level 6: <strong>2%</strong></li>
                        <li>Level 7: <strong>2%</strong></li>
                        <li>Level 8: <strong>1%</strong></li>
                        <li>Level 9: <strong>1%</strong></li>
                    </ul>
                </div>
                
                <div style="background: rgba(138,43,226,0.1); padding: 0.8rem; border-radius: 8px; margin-top: 0.8rem;">
                    <h4 style="margin-bottom: 0.5rem; font-size: 1rem;"><i class="fas fa-bullhorn"></i> Share Your Link</h4>
                    <div style="display: flex; gap: 0.4rem; margin-top: 0.5rem;">
                        <button class="btn btn-small" style="flex: 1;" onclick="shareOnFacebook()">
                            <i class="fab fa-facebook"></i> Facebook
                        </button>
                        <button class="btn btn-small" style="flex: 1;" onclick="shareOnWhatsApp()">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </button>
                        <button class="btn btn-small" style="flex: 1;" onclick="shareOnTelegram()">
                            <i class="fab fa-telegram"></i> Telegram
                        </button>
                    </div>
                </div>
                
                <button class="btn btn-purple" style="width: 100%; margin-top: 1.2rem;" onclick="closeReferralModal()">
                    <i class="fas fa-check"></i> Done
                </button>
            </div>
        </div>

        <!-- Footer for App -->
        <footer>
            <div class="container">
                <div class="footer-grid">
                    <div>
                        <div class="logo">
                            <i class="fas fa-coins"></i>
                            CryptoWealth Pro
                        </div>
                        <p style="margin-top: 0.8rem; color: #a0a0c0; font-size: 0.9rem;">Advanced Crypto MLM Platform with Leadership Rewards & 9-Level Team Commission</p>
                    </div>
                    
                    <div>
                        <h4 style="font-size: 1rem;">Quick Links</h4>
                        <ul style="list-style: none; margin-top: 0.8rem;">
                            <li><a href="#" onclick="switchTab('dashboard')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Dashboard</a></li>
                            <li><a href="#" onclick="switchTab('plans')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Investment Plans</a></li>
                            <li><a href="#" onclick="switchTab('rewards')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Leadership Rewards</a></li>
                            <li><a href="#" onclick="switchTab('network')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Network</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="font-size: 1rem;">Contact</h4>
                        <p style="margin-top: 0.8rem; color: #a0a0c0; font-size: 0.9rem;">
                            <i class="fas fa-envelope"></i> support@cryptowealthpro.com<br>
                            <i class="fas fa-globe"></i> www.cryptowealthpro.com
                        </p>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1);">
                    <p style="font-size: 0.9rem;"> 2023 CryptoWealth Pro. All rights reserved.</p>
                    <p style="font-size: 0.8rem; color: #a0a0c0;">Cryptocurrency investments involve risk. Please invest responsibly.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- JavaScript -->
    <script>
        // ====================
        // FIREBASE CONFIGURATION
        // ====================
        const firebaseConfig = {
            apiKey: "AIzaSyB6vD81slzYeX4RrV-9Xn4agsEyo9eNWNE",
            authDomain: "fir-85dcd.firebaseapp.com",
            databaseURL: "https://fir-85dcd-default-rtdb.firebaseio.com",
            projectId: "fir-85dcd",
            storageBucket: "fir-85dcd.firebasestorage.app",
            messagingSenderId: "789997788238",
            appId: "1:789997788238:web:8c2e4fe48e12f6b8a5b71f"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // ====================
        // APPLICATION STATE
        // ====================
        let currentUser = null;
        let userData = null;
        let chatActive = false;
        let investmentIntervals = {};
        let profileSidebarOpen = false;
        let adminPanelOpen = false;
        let systemSettings = {
            earningStartTime: 24, // hours after investment
            earningInterval: 1440, // minutes (24 hours)
            withdrawalProcessingTime: 24 // hours
        };

        // Investment Plan Configuration
        const investmentPlans = {
            1: { min: 5, max: 100, dailyReturn: 6, days: 60, name: "Starter Plan" },
            2: { min: 101, max: 500, dailyReturn: 6.5, days: 70, name: "Growth Plan" },
            3: { min: 501, max: 1000, dailyReturn: 7, days: 80, name: "Premium Plan" },
            4: { min: 1001, max: 5000, dailyReturn: 7.5, days: 100, name: "VIP Plan" }
        };

        // Leadership Rewards Configuration
        const leadershipRewards = {
            1: { name: "iPhone 17 Pro Max", selfBusiness: 1000, teamBusiness: 3500, type: "gadget" },
            2: { name: "Apple Laptop", selfBusiness: 750, teamBusiness: 3000, type: "gadget" },
            3: { name: "Goa Trip", selfBusiness: 500, teamBusiness: 2500, type: "travel" },
            4: { name: "Thailand Trip", selfBusiness: 1500, teamBusiness: 5000, type: "travel" }
        };

        // 9-Level Commission Structure
        const commissionLevels = {
            1: 8,  // Level 1: 8%
            2: 6,  // Level 2: 6%
            3: 5,  // Level 3: 5%
            4: 4,  // Level 4: 4%
            5: 3,  // Level 5: 3%
            6: 2,  // Level 6: 2%
            7: 2,  // Level 7: 2%
            8: 1,  // Level 8: 1%
            9: 1   // Level 9: 1%
        };

        // Admin users list (add your admin emails here)
        const adminEmails = ["admin@cryptowealthpro.com", "test@admin.com"];

        // ====================
        // INITIALIZATION
        // ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Check for referral parameter in URL
            checkReferralFromURL();
            
            // Hide loading screen after 2 seconds
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
                
                // Check auth state
                auth.onAuthStateChanged((user) => {
                    if (user) {
                        // User is signed in
                        currentUser = user;
                        loadUserData();
                        loadSystemSettings();
                        showApp();
                        // Setup plan calculators
                        setupPlanCalculators();
                        // Setup withdrawal calculator
                        setupWithdrawalCalculator();
                        // Update plan calculations
                        updatePlanCalculators();
                        // Update UI for logged in user
                        updateAuthUI(true);
                    } else {
                        // User is signed out
                        showCompanyOverview();
                        updateAuthUI(false);
                    }
                });
            }, 2000);

            // Setup event listeners
            setupEventListeners();
            
            // Prevent overflow issues
            preventOverflow();
        });

        // ====================
        // REFERRAL SYSTEM FIX
        // ====================
        function checkReferralFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const referralCode = urlParams.get('ref');
            
            if (referralCode) {
                // Store referral code in localStorage
                localStorage.setItem('referralCode', referralCode);
                
                // Remove ref parameter from URL
                const newUrl = window.location.pathname;
                window.history.replaceState({}, document.title, newUrl);
                
                // If user is not logged in, show signup modal
                if (!currentUser) {
                    setTimeout(() => {
                        openAuthModal('signup');
                        document.getElementById('referralCode').value = referralCode;
                        showNotification('Referral code applied: ' + referralCode, 'success');
                    }, 1000);
                }
            }
        }

        // ====================
        // RESPONSIVE FIXES
        // ====================
        function preventOverflow() {
            document.body.style.overflowX = 'hidden';
            
            const viewportMeta = document.querySelector('meta[name="viewport"]');
            if (viewportMeta) {
                viewportMeta.content = "width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";
            }
            
            window.addEventListener('resize', handleResize);
            handleResize();
        }
        
        function handleResize() {
            if (window.innerWidth <= 768) {
                document.querySelectorAll('.modal-content').forEach(modal => {
                    modal.style.padding = '1.2rem';
                });
            }
        }

        // ====================
        // UI NAVIGATION
        // ====================
        function showCompanyOverview() {
            document.getElementById('companyOverview').style.display = 'block';
            document.getElementById('appContainer').style.display = 'none';
            profileSidebarOpen = false;
            document.getElementById('profileSidebar').classList.remove('active');
            adminPanelOpen = false;
            document.getElementById('adminPanel').classList.remove('active');
        }

        function showApp() {
            document.getElementById('companyOverview').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            if (userData) {
                updateDashboard();
                updateSidebarProfile();
            }
        }

        function showHomePage() {
            if (currentUser) {
                showApp();
                switchTab('dashboard');
            } else {
                showCompanyOverview();
                scrollToSection('hero');
            }
        }

        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
                document.getElementById('navLinks').classList.remove('active');
            }
        }

        // ====================
        // AUTH UI MANAGEMENT
        // ====================
        function updateAuthUI(isLoggedIn) {
            const guestAuthButtons = document.getElementById('guestAuthButtons');
            const userSection = document.getElementById('userSection');
            const navLinks = document.getElementById('navLinks');
            const adminBadge = document.getElementById('adminBadge');
            
            if (isLoggedIn) {
                if (guestAuthButtons) guestAuthButtons.style.display = 'none';
                if (userSection) userSection.style.display = 'flex';
                
                // Check if user is admin
                const isAdmin = adminEmails.includes(currentUser.email);
                if (adminBadge) {
                    adminBadge.style.display = isAdmin ? 'block' : 'none';
                }
                
                if (navLinks) {
                    navLinks.innerHTML = `
                        <li><a href="#" onclick="switchTab('dashboard')"><i class="fas fa-home"></i> Dashboard</a></li>
                        <li><a href="#" onclick="switchTab('plans')"><i class="fas fa-chart-line"></i> Investment Plans</a></li>
                        <li><a href="#" onclick="switchTab('rewards')"><i class="fas fa-trophy"></i> Leadership Rewards</a></li>
                        <li><a href="#" onclick="switchTab('levels')"><i class="fas fa-layer-group"></i> Team Commission</a></li>
                        <li><a href="#" onclick="switchTab('network')"><i class="fas fa-users"></i> Network</a></li>
                        <li><a href="#" onclick="switchTab('earnings')"><i class="fas fa-money-bill-wave"></i> Earnings</a></li>
                        <li><a href="#" onclick="switchTab('transactions')"><i class="fas fa-exchange-alt"></i> Transactions</a></li>
                        <li><a href="#" onclick="showChat()" id="chatBtn"><i class="fas fa-comments"></i> Support Chat</a></li>
                        <li><a href="#" onclick="openDepositModal()"><i class="fas fa-plus-circle"></i> Deposit</a></li>
                        <li><a href="#" onclick="openWithdrawModal()"><i class="fas fa-wallet"></i> Withdraw</a></li>
                        <li><a href="#" onclick="toggleProfileSidebar()"><i class="fas fa-user-circle"></i> Profile</a></li>
                    `;
                }
            } else {
                if (guestAuthButtons) guestAuthButtons.style.display = 'flex';
                if (userSection) userSection.style.display = 'none';
                
                if (navLinks) {
                    navLinks.innerHTML = `
                        <li><a href="#" onclick="scrollToSection('hero')"><i class="fas fa-home"></i> Home</a></li>
                        <li><a href="#" onclick="scrollToSection('mission')"><i class="fas fa-bullseye"></i> Mission</a></li>
                        <li><a href="#" onclick="scrollToSection('features')"><i class="fas fa-star"></i> Features</a></li>
                        <li><a href="#" onclick="scrollToSection('plans')"><i class="fas fa-chart-line"></i> Investment Plans</a></li>
                        <li><a href="#" onclick="scrollToSection('cta')"><i class="fas fa-handshake"></i> Get Started</a></li>
                        <div class="auth-buttons" id="guestAuthButtons">
                            <button class="btn btn-small" onclick="openAuthModal('login')">
                                <i class="fas fa-sign-in-alt"></i> Login
                            </button>
                            <button class="btn btn-small btn-purple" onclick="openAuthModal('signup')">
                                <i class="fas fa-user-plus"></i> Sign Up
                            </button>
                        </div>
                    `;
                }
            }
        }

        // ====================
        // AUTH MODAL FUNCTIONS
        // ====================
        function openAuthModal(tab) {
            document.getElementById('authModal').classList.add('active');
            switchAuthTab(tab);
            
            // Auto-fill referral code from localStorage if exists
            const storedReferralCode = localStorage.getItem('referralCode');
            if (storedReferralCode && document.getElementById('referralCode')) {
                document.getElementById('referralCode').value = storedReferralCode;
            }
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
        }

        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => {
                t.classList.remove('active');
                if (t.getAttribute('data-auth-tab') === tab) {
                    t.classList.add('active');
                }
            });
            
            document.querySelectorAll('.auth-form').forEach(form => {
                form.classList.remove('active');
                if (form.id === tab + 'Form') {
                    form.classList.add('active');
                }
            });
        }

        // Login Form Submission
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showNotification('Please enter email and password', 'error');
                return;
            }
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    showNotification('Login successful!', 'success');
                    closeAuthModal();
                })
                .catch((error) => {
                    showNotification(error.message, 'error');
                });
        });

        // Signup Form Submission - WITH OPTIONAL USDT WALLET
        document.getElementById('signupForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const phone = document.getElementById('signupPhone').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            let referralCode = document.getElementById('referralCode').value;
            const usdtWallet = document.getElementById('usdtWallet').value;
            
            // If no referral code in form, check localStorage
            if (!referralCode) {
                referralCode = localStorage.getItem('referralCode') || '';
            }
            
            // Validation
            if (!name || !email || !phone || !password || !confirmPassword) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }
            
            if (password.length < 6) {
                showNotification('Password must be at least 6 characters', 'error');
                return;
            }
            
            // Create user with Firebase Auth
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    
                    // Generate referral code
                    const refCode = generateReferralCode(name);
                    
                    // Create user data in Firebase
                    const userData = {
                        uid: user.uid,
                        name: name,
                        email: email,
                        phone: phone,
                        referralCode: refCode,
                        upline: null,
                        usdtWallet: usdtWallet || "", // Optional field
                        joinDate: new Date().toISOString(),
                        balance: 0,
                        totalEarnings: 0,
                        level: 1,
                        rank: 'Bronze',
                        directReferrals: 0,
                        totalDownline: 0,
                        walletAddress: usdtWallet || "",
                        activeInvestments: [],
                        totalInvested: 0,
                        totalWithdrawn: 0,
                        selfBusiness: 0,
                        teamBusiness: 0,
                        claimedRewards: [],
                        lastBonusClaimDate: null,
                        levelEarnings: {
                            level1: 0,
                            level2: 0,
                            level3: 0,
                            level4: 0,
                            level5: 0,
                            level6: 0,
                            level7: 0,
                            level8: 0,
                            level9: 0
                        },
                        levelCounts: {
                            level1: 0,
                            level2: 0,
                            level3: 0,
                            level4: 0,
                            level5: 0,
                            level6: 0,
                            level7: 0,
                            level8: 0,
                            level9: 0
                        },
                        isAdmin: adminEmails.includes(email)
                    };
                    
                    // Check if referral code exists and update upline
                    if (referralCode) {
                        database.ref('users').orderByChild('referralCode').equalTo(referralCode).once('value')
                            .then((snapshot) => {
                                if (snapshot.exists()) {
                                    const uplineData = snapshot.val();
                                    const uplineId = Object.keys(uplineData)[0];
                                    const upline = uplineData[uplineId];
                                    
                                    // Update user's upline
                                    userData.upline = uplineId;
                                    userData.uplineCode = upline.referralCode;
                                    
                                    // Update upline's referral count
                                    const updates = {};
                                    updates['users/' + uplineId + '/directReferrals'] = (upline.directReferrals || 0) + 1;
                                    updates['users/' + uplineId + '/levelCounts/level1'] = (upline.levelCounts?.level1 || 0) + 1;
                                    
                                    database.ref().update(updates);
                                }
                                
                                // Save user data
                                return database.ref('users/' + user.uid).set(userData);
                            });
                    } else {
                        // Save user data without upline
                        return database.ref('users/' + user.uid).set(userData);
                    }
                })
                .then(() => {
                    // Clear referral code from localStorage after successful signup
                    localStorage.removeItem('referralCode');
                    
                    // AUTO LOGIN: Sign in the user after successful signup
                    return auth.signInWithEmailAndPassword(email, password);
                })
                .then((userCredential) => {
                    showNotification('Account created successfully! Welcome to CryptoWealth Pro!', 'success');
                    closeAuthModal();
                })
                .catch((error) => {
                    showNotification(error.message, 'error');
                });
        });

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                auth.signOut().then(() => {
                    showNotification('Logged out successfully', 'success');
                    profileSidebarOpen = false;
                    document.getElementById('profileSidebar').classList.remove('active');
                    adminPanelOpen = false;
                    document.getElementById('adminPanel').classList.remove('active');
                });
            }
        }

        function showForgotPassword() {
            const email = prompt('Enter your email address to reset password:');
            if (email) {
                auth.sendPasswordResetEmail(email)
                    .then(() => {
                        showNotification('Password reset email sent! Check your inbox.', 'success');
                    })
                    .catch((error) => {
                        showNotification(error.message, 'error');
                    });
            }
        }

        // ====================
        // PROFILE SIDEBAR
        // ====================
        function toggleProfileSidebar() {
            const sidebar = document.getElementById('profileSidebar');
            profileSidebarOpen = !profileSidebarOpen;
            
            if (profileSidebarOpen) {
                sidebar.classList.add('active');
                // Close admin panel if open
                adminPanelOpen = false;
                document.getElementById('adminPanel').classList.remove('active');
                // Close mobile menu if open
                document.getElementById('navLinks').classList.remove('active');
                updateSidebarProfile();
            } else {
                sidebar.classList.remove('active');
            }
        }
        
        function toggleAdminPanel() {
            const panel = document.getElementById('adminPanel');
            adminPanelOpen = !adminPanelOpen;
            
            if (adminPanelOpen) {
                panel.classList.add('active');
                // Close profile sidebar if open
                profileSidebarOpen = false;
                document.getElementById('profileSidebar').classList.remove('active');
                // Close mobile menu if open
                document.getElementById('navLinks').classList.remove('active');
                // Load admin data
                adminRefreshStats();
                loadSystemSettingsToAdmin();
            } else {
                panel.classList.remove('active');
            }
        }
        
        function updateSidebarProfile() {
            if (!userData) return;
            
            const initial = userData.name.charAt(0).toUpperCase();
            document.getElementById('sidebarAvatar').textContent = initial;
            document.getElementById('sidebarName').textContent = userData.name;
            document.getElementById('sidebarEmail').textContent = userData.email;
            document.getElementById('sidebarRank').textContent = userData.rank;
            document.getElementById('sidebarLevel').textContent = userData.level || 1;
            document.getElementById('sidebarReferrals').textContent = userData.directReferrals || 0;
            document.getElementById('sidebarBalance').textContent = userData.balance.toFixed(2) + ' USDT';
            
            // Truncate wallet address for display
            const wallet = userData.usdtWallet || '';
            if (wallet.length > 20) {
                document.getElementById('sidebarWallet').textContent = 
                    wallet.substring(0, 10) + '...' + wallet.substring(wallet.length - 10);
            } else {
                document.getElementById('sidebarWallet').textContent = wallet;
            }
            
            document.getElementById('sidebarJoinDate').textContent = 
                new Date(userData.joinDate).toLocaleDateString();
            
            document.getElementById('sidebarTotalEarned').textContent = 
                (userData.totalEarnings || 0).toFixed(2) + ' USDT';
            
            document.getElementById('sidebarWithdrawn').textContent = 
                (userData.totalWithdrawn || 0).toFixed(2) + ' USDT';
            
            document.getElementById('sidebarActiveInvestments').textContent = 
                (userData.activeInvestments || []).length;
            
            document.getElementById('sidebarTeamSize').textContent = 
                userData.totalDownline || 0;
            
            // Show/hide admin panel button
            const adminPanelBtn = document.getElementById('adminPanelBtn');
            if (adminPanelBtn) {
                adminPanelBtn.style.display = userData.isAdmin ? 'block' : 'none';
            }
        }

        // ====================
        // SYSTEM SETTINGS
        // ====================
        function loadSystemSettings() {
            database.ref('systemSettings').once('value')
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        systemSettings = snapshot.val();
                    }
                })
                .catch((error) => {
                    console.error('Error loading system settings:', error);
                });
        }
        
        function loadSystemSettingsToAdmin() {
            document.getElementById('earningStartTime').value = systemSettings.earningStartTime;
            document.getElementById('earningInterval').value = systemSettings.earningInterval;
            document.getElementById('withdrawalProcessingTime').value = systemSettings.withdrawalProcessingTime;
        }
        
        function saveSystemSettings() {
            const newSettings = {
                earningStartTime: parseInt(document.getElementById('earningStartTime').value) || 24,
                earningInterval: parseInt(document.getElementById('earningInterval').value) || 1440,
                withdrawalProcessingTime: parseInt(document.getElementById('withdrawalProcessingTime').value) || 24
            };
            
            database.ref('systemSettings').set(newSettings)
                .then(() => {
                    systemSettings = newSettings;
                    showNotification('System settings saved successfully!', 'success');
                })
                .catch((error) => {
                    showNotification('Error saving settings: ' + error.message, 'error');
                });
        }

        // ====================
        // USER DATA MANAGEMENT
        // ====================
        function loadUserData() {
            if (!currentUser) return;
            
            database.ref('users/' + currentUser.uid).on('value', (snapshot) => {
                userData = snapshot.val();
                if (userData) {
                    updateDashboard();
                    updateLevelIncome();
                    updateNetworkTree();
                    updateActiveInvestments();
                    updateTransactions();
                    updateBusinessSummary();
                    updateRewardsProgress();
                    checkDailyBonusEligibility();
                    updateInvestmentHistory();
                    
                    // Update sidebar profile
                    if (profileSidebarOpen) {
                        updateSidebarProfile();
                    }
                    
                    // Start investment earnings if any active investments
                    startInvestmentEarnings();
                }
            });
        }

        function updateUserData(updates) {
            if (!currentUser || !userData) return;
            
            return database.ref('users/' + currentUser.uid).update(updates)
                .then(() => {
                    console.log('User data updated successfully');
                    return true;
                })
                .catch((error) => {
                    showNotification('Error updating data: ' + error.message, 'error');
                    return false;
                });
        }

        // ====================
        // APP FUNCTIONS
        // ====================
        function setupEventListeners() {
            // Mobile menu
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const navLinks = document.getElementById('navLinks');
            
            if (mobileMenuBtn && navLinks) {
                mobileMenuBtn.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                    // Close sidebars if open
                    if (profileSidebarOpen) {
                        profileSidebarOpen = false;
                        document.getElementById('profileSidebar').classList.remove('active');
                    }
                    if (adminPanelOpen) {
                        adminPanelOpen = false;
                        document.getElementById('adminPanel').classList.remove('active');
                    }
                });
            }
            
            // Auth tab switching
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-auth-tab');
                    switchAuthTab(tabName);
                });
            });
            
            // Main tab switching
            document.querySelectorAll('.tab-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            // Chat input enter key
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendChatMessage();
                    }
                });
            }
            
            // Bot question enter key
            const botQuestion = document.getElementById('botQuestion');
            if (botQuestion) {
                botQuestion.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        askCustomQuestion();
                    }
                });
            }
            
            // Close modals when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                    }
                });
            });
            
            // Close auth modal when clicking outside
            document.getElementById('authModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAuthModal();
                }
            });
            
            // Close sidebars when clicking outside
            document.addEventListener('click', function(e) {
                const sidebar = document.getElementById('profileSidebar');
                const adminPanel = document.getElementById('adminPanel');
                const userAvatar = document.getElementById('userAvatar');
                
                if (profileSidebarOpen && sidebar && 
                    !sidebar.contains(e.target) && 
                    !userAvatar.contains(e.target)) {
                    profileSidebarOpen = false;
                    sidebar.classList.remove('active');
                }
                
                if (adminPanelOpen && adminPanel && 
                    !adminPanel.contains(e.target) && 
                    !userAvatar.contains(e.target)) {
                    adminPanelOpen = false;
                    adminPanel.classList.remove('active');
                }
            });
            
            // Handle escape key to close modals and sidebars
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal.active').forEach(modal => {
                        modal.classList.remove('active');
                    });
                    
                    closeAuthModal();
                    
                    document.getElementById('cryptoBotModal').classList.remove('active');
                    
                    if (chatActive) {
                        hideChat();
                    }
                    
                    if (profileSidebarOpen) {
                        profileSidebarOpen = false;
                        document.getElementById('profileSidebar').classList.remove('active');
                    }
                    
                    if (adminPanelOpen) {
                        adminPanelOpen = false;
                        document.getElementById('adminPanel').classList.remove('active');
                    }
                }
            });
        }

        function switchTab(tabId) {
            // Update active tab button
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-tab') === tabId) {
                    btn.classList.add('active');
                }
            });
            
            // Update active tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId) {
                    content.classList.add('active');
                }
            });
            
            // Close mobile menu if open
            document.getElementById('navLinks').classList.remove('active');
            
            // Load specific tab data
            if (tabId === 'levels' && userData) {
                updateLevelIncome();
            } else if (tabId === 'earnings' && userData) {
                updateEarnings();
            } else if (tabId === 'transactions' && userData) {
                updateTransactions();
            } else if (tabId === 'plans' && userData) {
                updatePlanCalculators();
            } else if (tabId === 'rewards' && userData) {
                updateRewardsProgress();
            } else if (tabId === 'network' && userData) {
                updateNetworkTree();
            } else if (tabId === 'profile') {
                profileSidebarOpen = false;
                document.getElementById('profileSidebar').classList.remove('active');
            }
        }

        function updateDashboard() {
            if (!userData) return;
            
            // Update user info
            document.getElementById('welcomeMessage').textContent = `Welcome, ${userData.name}`;
            document.getElementById('userInfo').textContent = `${userData.rank} Member | Level ${userData.level}`;
            
            // Update avatar
            const initial = userData.name.charAt(0).toUpperCase();
            document.getElementById('userAvatar').textContent = initial;
            document.getElementById('profileAvatar').textContent = initial;
            
            // Update stats
            document.getElementById('balanceAmount').textContent = userData.balance.toFixed(2) + ' USDT';
            document.getElementById('todayEarnings').textContent = '+' + calculateTodayEarnings().toFixed(2) + ' USDT';
            document.getElementById('totalReferrals').textContent = userData.directReferrals;
            document.getElementById('userRank').textContent = userData.rank;
            
            // Update profile
            document.getElementById('profileName').textContent = userData.name;
            document.getElementById('profileEmail').textContent = userData.email;
            document.getElementById('userId').textContent = currentUser.uid.substring(0, 8);
            document.getElementById('joinDate').textContent = new Date(userData.joinDate).toLocaleDateString();
            document.getElementById('userReferralCode').textContent = userData.referralCode;
            
            // Update settings form
            document.getElementById('settingsName').value = userData.name;
            document.getElementById('settingsEmail').value = userData.email;
            document.getElementById('settingsPhone').value = userData.phone || '';
            document.getElementById('walletAddress').value = userData.usdtWallet || '';
            
            // Update recent activity
            updateRecentActivity();
        }

        function updateRecentActivity() {
            if (!userData) return;
            
            const activityTable = document.getElementById('recentActivity');
            activityTable.innerHTML = '';
            
            // Add recent transactions
            const transactions = userData.transactions || [];
            const recentTransactions = transactions.slice(-5).reverse();
            
            if (recentTransactions.length === 0) {
                activityTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 2rem;">No recent activity</td></tr>';
                return;
            }
            
            recentTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const time = new Date(transaction.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                const amount = transaction.amount.toFixed(2);
                let statusBadge = '';
                
                if (transaction.status === 'completed') {
                    statusBadge = '<span class="status-badge status-completed">Completed</span>';
                } else if (transaction.status === 'pending') {
                    statusBadge = '<span class="status-badge status-pending">Pending</span>';
                } else {
                    statusBadge = '<span class="status-badge status-active">Active</span>';
                }
                
                row.innerHTML = `
                    <td>${time}</td>
                    <td>${transaction.type} ${transaction.description || ''}</td>
                    <td>${amount} USDT</td>
                    <td>${statusBadge}</td>
                `;
                activityTable.appendChild(row);
            });
        }

        function calculateTodayEarnings() {
            if (!userData || !userData.activeInvestments) return 0;
            
            let todayEarnings = 0;
            const today = new Date().toDateString();
            
            userData.activeInvestments.forEach(investment => {
                if (investment.status === 'active') {
                    // Check if 24 hours have passed since investment
                    const investmentDate = new Date(investment.startDate);
                    const now = new Date();
                    const hoursSinceInvestment = (now - investmentDate) / (1000 * 60 * 60);
                    
                    if (hoursSinceInvestment >= 24) {
                        // Calculate daily earnings
                        const dailyEarning = (investment.amount * investment.dailyReturn / 100);
                        todayEarnings += dailyEarning;
                    }
                }
            });
            
            // Add level earnings
            if (userData.levelEarnings) {
                Object.values(userData.levelEarnings).forEach(earning => {
                    todayEarnings += (earning || 0);
                });
            }
            
            return todayEarnings;
        }

        function checkDailyBonusEligibility() {
            if (!userData) return;
            
            const today = new Date().toDateString();
            const lastClaimDate = userData.lastBonusClaimDate ? new Date(userData.lastBonusClaimDate).toDateString() : null;
            const dailyBonusBtn = document.getElementById('dailyBonusBtn');
            
            if (lastClaimDate === today) {
                dailyBonusBtn.disabled = true;
                dailyBonusBtn.innerHTML = '<i class="fas fa-check"></i> Bonus Claimed Today';
            } else {
                dailyBonusBtn.disabled = false;
                dailyBonusBtn.innerHTML = '<i class="fas fa-gift"></i> Claim Daily Bonus ($0.01)';
            }
        }

        function claimDailyBonus() {
            if (!userData) return;
            
            const today = new Date().toDateString();
            const lastClaimDate = userData.lastBonusClaimDate ? new Date(userData.lastBonusClaimDate).toDateString() : null;
            
            if (lastClaimDate === today) {
                showNotification('You have already claimed your daily bonus today!', 'error');
                return;
            }
            
            // Update user balance and claim date
            const updates = {
                balance: userData.balance + 0.01,
                lastBonusClaimDate: new Date().toISOString(),
                totalEarnings: (userData.totalEarnings || 0) + 0.01
            };
            
            // Add transaction
            addTransaction('bonus', 0.01, 'Daily Bonus Claim', 'completed');
            
            updateUserData(updates)
                .then(() => {
                    showNotification('Daily bonus claimed! $0.01 added to your balance.', 'success');
                    checkDailyBonusEligibility();
                })
                .catch((error) => {
                    showNotification('Error claiming bonus: ' + error.message, 'error');
                });
        }

        function addTransaction(type, amount, description, status) {
            if (!currentUser || !userData) return;
            
            const transaction = {
                type: type,
                amount: amount,
                description: description,
                status: status,
                timestamp: new Date().toISOString()
            };
            
            // Get existing transactions
            const transactions = userData.transactions || [];
            transactions.push(transaction);
            
            // Update user data
            return database.ref('users/' + currentUser.uid + '/transactions').set(transactions);
        }

        function setupPlanCalculators() {
            // Plan 1
            const plan1Input = document.getElementById('plan1Amount');
            if (plan1Input) {
                plan1Input.addEventListener('input', function() {
                    const amount = parseFloat(this.value) || 0;
                    const plan = investmentPlans[1];
                    
                    if (amount < plan.min) {
                        this.value = plan.min;
                        updatePlan1();
                        return;
                    }
                    
                    if (amount > plan.max) {
                        this.value = plan.max;
                        updatePlan1();
                        return;
                    }
                    
                    updatePlan1();
                });
            }
            
            // Plan 2
            const plan2Input = document.getElementById('plan2Amount');
            if (plan2Input) {
                plan2Input.addEventListener('input', function() {
                    const amount = parseFloat(this.value) || 0;
                    const plan = investmentPlans[2];
                    
                    if (amount < plan.min) {
                        this.value = plan.min;
                        updatePlan2();
                        return;
                    }
                    
                    if (amount > plan.max) {
                        this.value = plan.max;
                        updatePlan2();
                        return;
                    }
                    
                    updatePlan2();
                });
            }
            
            // Plan 3
            const plan3Input = document.getElementById('plan3Amount');
            if (plan3Input) {
                plan3Input.addEventListener('input', function() {
                    const amount = parseFloat(this.value) || 0;
                    const plan = investmentPlans[3];
                    
                    if (amount < plan.min) {
                        this.value = plan.min;
                        updatePlan3();
                        return;
                    }
                    
                    if (amount > plan.max) {
                        this.value = plan.max;
                        updatePlan3();
                        return;
                    }
                    
                    updatePlan3();
                });
            }
            
            // Plan 4
            const plan4Input = document.getElementById('plan4Amount');
            if (plan4Input) {
                plan4Input.addEventListener('input', function() {
                    const amount = parseFloat(this.value) || 0;
                    const plan = investmentPlans[4];
                    
                    if (amount < plan.min) {
                        this.value = plan.min;
                        updatePlan4();
                        return;
                    }
                    
                    if (amount > plan.max) {
                        this.value = plan.max;
                        updatePlan4();
                        return;
                    }
                    
                    updatePlan4();
                });
            }
        }

        function updatePlanCalculators() {
            updatePlan1();
            updatePlan2();
            updatePlan3();
            updatePlan4();
        }

        function updatePlan1() {
            const amount = parseFloat(document.getElementById('plan1Amount').value) || 0;
            const plan = investmentPlans[1];
            
            const dailyEarning = (amount * plan.dailyReturn / 100).toFixed(2);
            const totalReturn = (dailyEarning * plan.days).toFixed(2);
            
            document.getElementById('plan1Daily').textContent = '$' + dailyEarning;
            document.getElementById('plan1Total').textContent = '$' + totalReturn;
        }

        function updatePlan2() {
            const amount = parseFloat(document.getElementById('plan2Amount').value) || 0;
            const plan = investmentPlans[2];
            
            const dailyEarning = (amount * plan.dailyReturn / 100).toFixed(2);
            const totalReturn = (dailyEarning * plan.days).toFixed(2);
            
            document.getElementById('plan2Daily').textContent = '$' + dailyEarning;
            document.getElementById('plan2Total').textContent = '$' + totalReturn;
        }

        function updatePlan3() {
            const amount = parseFloat(document.getElementById('plan3Amount').value) || 0;
            const plan = investmentPlans[3];
            
            const dailyEarning = (amount * plan.dailyReturn / 100).toFixed(2);
            const totalReturn = (dailyEarning * plan.days).toFixed(2);
            
            document.getElementById('plan3Daily').textContent = '$' + dailyEarning;
            document.getElementById('plan3Total').textContent = '$' + totalReturn;
        }

        function updatePlan4() {
            const amount = parseFloat(document.getElementById('plan4Amount').value) || 0;
            const plan = investmentPlans[4];
            
            const dailyEarning = (amount * plan.dailyReturn / 100).toFixed(2);
            const totalReturn = (dailyEarning * plan.days).toFixed(2);
            
            document.getElementById('plan4Daily').textContent = '$' + dailyEarning;
            document.getElementById('plan4Total').textContent = '$' + totalReturn;
        }

        // FIXED: Users can only invest if they have enough balance
        function investInPlan(planNumber) {
            if (!userData) {
                showNotification('Please login to invest', 'error');
                return;
            }
            
            const planInput = document.getElementById(`plan${planNumber}Amount`);
            const amount = parseFloat(planInput.value) || 0;
            const plan = investmentPlans[planNumber];
            
            // Validation
            if (amount < plan.min || amount > plan.max) {
                showNotification(`Please enter amount between $${plan.min} and $${plan.max}`, 'error');
                return;
            }
            
            if (amount > userData.balance) {
                showNotification('Insufficient balance. Please deposit first.', 'error');
                openDepositModal();
                return;
            }
            
            // Check if user already has this plan active (prevent double purchase)
            const activeInvestments = userData.activeInvestments || [];
            const hasActivePlan = activeInvestments.some(inv => 
                inv.planId === planNumber && inv.status === 'active'
            );
            
            if (hasActivePlan) {
                showNotification(`You already have an active ${plan.name}. Wait for it to complete before investing again.`, 'error');
                return;
            }
            
            // Create investment
            const investment = {
                planId: planNumber,
                planName: plan.name,
                amount: amount,
                dailyReturn: plan.dailyReturn,
                days: plan.days,
                startDate: new Date().toISOString(),
                endDate: new Date(Date.now() + plan.days * 24 * 60 * 60 * 1000).toISOString(),
                status: 'active',
                totalEarned: 0,
                daysCompleted: 0,
                nextEarningDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(), // 24 hours later
                earningsStarted: false
            };
            
            // Update user data
            activeInvestments.push(investment);
            
            const updates = {
                activeInvestments: activeInvestments,
                balance: userData.balance - amount,
                totalInvested: (userData.totalInvested || 0) + amount,
                selfBusiness: (userData.selfBusiness || 0) + amount
            };
            
            // Add transaction
            addTransaction('investment', amount, `Invested in ${plan.name}`, 'completed');
            
            // Distribute commission to upline
            distributeCommissionToUpline(amount, userData.upline);
            
            updateUserData(updates)
                .then(() => {
                    showNotification(`Successfully invested $${amount} in ${plan.name}! Earnings will start in 24 hours.`, 'success');
                    updateInvestmentHistory();
                    updateBusinessSummary();
                    
                    // Schedule earnings after 24 hours
                    scheduleInvestmentEarning(investment);
                })
                .catch((error) => {
                    showNotification('Error processing investment: ' + error.message, 'error');
                });
        }

        function distributeCommissionToUpline(amount, uplineId, level = 1) {
            if (!uplineId || level > 9) return;
            
            database.ref('users/' + uplineId).once('value')
                .then((snapshot) => {
                    const upline = snapshot.val();
                    if (!upline) return;
                    
                    const commissionRate = commissionLevels[level];
                    const commission = (amount * commissionRate / 100);
                    
                    // Update upline's earnings
                    const updates = {};
                    updates['balance'] = (upline.balance || 0) + commission;
                    updates['totalEarnings'] = (upline.totalEarnings || 0) + commission;
                    updates[`levelEarnings/level${level}`] = (upline.levelEarnings?.[`level${level}`] || 0) + commission;
                    updates[`levelCounts/level${level}`] = (upline.levelCounts?.[`level${level}`] || 0) + 1;
                    updates['teamBusiness'] = (upline.teamBusiness || 0) + amount;
                    
                    database.ref('users/' + uplineId).update(updates);
                    
                    // Add transaction for upline
                    addUplineTransaction(uplineId, commission, `Level ${level} commission from ${userData.name}`);
                    
                    // Continue to next level
                    if (upline.upline) {
                        distributeCommissionToUpline(amount, upline.upline, level + 1);
                    }
                });
        }

        function addUplineTransaction(userId, amount, description) {
            database.ref('users/' + userId + '/transactions').once('value')
                .then((snapshot) => {
                    const transactions = snapshot.val() || [];
                    transactions.push({
                        type: 'commission',
                        amount: amount,
                        description: description,
                        status: 'completed',
                        timestamp: new Date().toISOString()
                    });
                    
                    database.ref('users/' + userId + '/transactions').set(transactions);
                });
        }

        function updateInvestmentHistory() {
            if (!userData || !userData.activeInvestments) return;
            
            const historyTable = document.getElementById('investmentHistory');
            historyTable.innerHTML = '';
            
            if (userData.activeInvestments.length === 0) {
                historyTable.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 2rem;">No investment history</td></tr>';
                return;
            }
            
            userData.activeInvestments.forEach((investment, index) => {
                const startDate = new Date(investment.startDate);
                const endDate = new Date(investment.endDate);
                const now = new Date();
                const daysLeft = Math.max(0, Math.ceil((endDate - now) / (1000 * 60 * 60 * 24)));
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${investment.planName}</td>
                    <td>$${investment.amount.toFixed(2)}</td>
                    <td>${startDate.toLocaleDateString()}</td>
                    <td>${investment.dailyReturn}%</td>
                    <td>${daysLeft}</td>
                    <td>$${investment.totalEarned.toFixed(2)}</td>
                    <td><span class="status-badge ${investment.status === 'active' ? 'status-active' : 'status-completed'}">${investment.status}</span></td>
                `;
                historyTable.appendChild(row);
            });
        }

        function startInvestmentEarnings() {
            if (!userData || !userData.activeInvestments) return;
            
            // Clear any existing intervals
            Object.values(investmentIntervals).forEach(interval => clearInterval(interval));
            investmentIntervals = {};
            
            // Start earning simulation for each active investment
            userData.activeInvestments.forEach((investment, index) => {
                if (investment.status === 'active') {
                    scheduleInvestmentEarning(investment);
                }
            });
        }

        function scheduleInvestmentEarning(investment) {
            const investmentId = Date.now() + Math.random();
            const now = new Date();
            const nextEarningDate = new Date(investment.nextEarningDate || new Date(now.getTime() + 24 * 60 * 60 * 1000));
            
            // Calculate time until next earning (24 hours after investment)
            const timeUntilNextEarning = nextEarningDate - now;
            
            if (timeUntilNextEarning > 0) {
                // Schedule first earning after 24 hours
                setTimeout(() => {
                    processInvestmentEarning(investment);
                    // Start interval for daily earnings
                    startDailyEarnings(investment);
                }, timeUntilNextEarning);
            } else {
                // Already past 24 hours, process immediately
                processInvestmentEarning(investment);
                startDailyEarnings(investment);
            }
        }

        function startDailyEarnings(investment) {
            const investmentId = Date.now() + Math.random();
            
            // Set interval for daily earnings (24 hours)
            const interval = setInterval(() => {
                if (!userData) {
                    clearInterval(interval);
                    return;
                }
                
                processInvestmentEarning(investment);
                
            }, 24 * 60 * 60 * 1000); // 24 hours in milliseconds
            
            investmentIntervals[investmentId] = interval;
        }

        function processInvestmentEarning(investment) {
            if (!userData) return;
            
            const now = new Date();
            const endDate = new Date(investment.endDate);
            
            if (now >= endDate) {
                // Investment completed
                updateInvestmentStatus(investment, 'completed');
                return;
            }
            
            // Calculate daily earnings
            const dailyEarning = investment.amount * investment.dailyReturn / 100;
            
            // Update user balance
            const updates = {
                balance: userData.balance + dailyEarning,
                totalEarnings: (userData.totalEarnings || 0) + dailyEarning
            };
            
            // Update investment earnings
            const activeInvestments = userData.activeInvestments || [];
            const investmentIndex = activeInvestments.findIndex(inv => 
                inv.planId === investment.planId && 
                inv.startDate === investment.startDate
            );
            
            if (investmentIndex !== -1) {
                activeInvestments[investmentIndex].totalEarned += dailyEarning;
                activeInvestments[investmentIndex].daysCompleted += 1;
                activeInvestments[investmentIndex].nextEarningDate = new Date(now.getTime() + 24 * 60 * 60 * 1000).toISOString();
                activeInvestments[investmentIndex].earningsStarted = true;
                updates.activeInvestments = activeInvestments;
                
                // Add transaction for earnings
                addTransaction('investment_earning', dailyEarning, `Daily earnings from ${investment.planName}`, 'completed');
            }
            
            updateUserData(updates);
        }

        function updateInvestmentStatus(investment, status) {
            if (!userData) return;
            
            const activeInvestments = userData.activeInvestments || [];
            const investmentIndex = activeInvestments.findIndex(inv => 
                inv.planId === investment.planId && 
                inv.startDate === investment.startDate
            );
            
            if (investmentIndex !== -1) {
                activeInvestments[investmentIndex].status = status;
                updateUserData({ activeInvestments: activeInvestments });
            }
        }

        function updateBusinessSummary() {
            if (!userData) return;
            
            document.getElementById('selfBusiness').textContent = (userData.selfBusiness || 0).toFixed(2) + ' USDT';
            document.getElementById('teamBusiness').textContent = (userData.teamBusiness || 0).toFixed(2) + ' USDT';
            document.getElementById('totalBusiness').textContent = ((userData.selfBusiness || 0) + (userData.teamBusiness || 0)).toFixed(2) + ' USDT';
        }

        function updateRewardsProgress() {
            if (!userData) return;
            
            Object.keys(leadershipRewards).forEach(rewardId => {
                const reward = leadershipRewards[rewardId];
                const selfBusiness = userData.selfBusiness || 0;
                const teamBusiness = userData.teamBusiness || 0;
                
                const selfProgress = Math.min((selfBusiness / reward.selfBusiness) * 100, 100);
                const teamProgress = Math.min((teamBusiness / reward.teamBusiness) * 100, 100);
                const totalProgress = Math.min((selfProgress + teamProgress) / 2, 100);
                
                // Update progress bars
                const progressBar = document.getElementById(`reward${rewardId}Progress`);
                const progressText = document.getElementById(`reward${rewardId}ProgressText`);
                const claimBtn = document.getElementById(`reward${rewardId}Btn`);
                
                if (progressBar) {
                    progressBar.style.width = totalProgress + '%';
                }
                
                if (progressText) {
                    progressText.textContent = totalProgress.toFixed(0) + '%';
                }
                
                if (claimBtn) {
                    const isClaimed = userData.claimedRewards?.includes(parseInt(rewardId)) || false;
                    const canClaim = selfBusiness >= reward.selfBusiness && teamBusiness >= reward.teamBusiness;
                    
                    if (isClaimed) {
                        claimBtn.disabled = true;
                        claimBtn.innerHTML = '<i class="fas fa-check"></i> Claimed';
                        document.getElementById(`reward${rewardId}`).classList.add('achieved');
                    } else if (canClaim) {
                        claimBtn.disabled = false;
                        claimBtn.innerHTML = '<i class="fas fa-gift"></i> Claim Reward';
                    } else {
                        claimBtn.disabled = true;
                        claimBtn.innerHTML = '<i class="fas fa-gift"></i> Claim Reward';
                    }
                }
            });
            
            updateClaimedRewards();
        }

        function updateClaimedRewards() {
            if (!userData) return;
            
            const claimedTable = document.getElementById('claimedRewards');
            claimedTable.innerHTML = '';
            
            const claimedRewards = userData.claimedRewards || [];
            
            if (claimedRewards.length === 0) {
                claimedTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 2rem;">No rewards claimed yet</td></tr>';
                return;
            }
            
            claimedRewards.forEach(rewardId => {
                const reward = leadershipRewards[rewardId];
                if (!reward) return;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${reward.name}</td>
                    <td>$${reward.selfBusiness} self + $${reward.teamBusiness} team</td>
                    <td>${new Date().toLocaleDateString()}</td>
                    <td><span class="status-badge status-completed">Claimed</span></td>
                `;
                claimedTable.appendChild(row);
            });
        }

        function claimReward(rewardId) {
            if (!userData) return;
            
            const reward = leadershipRewards[rewardId];
            if (!reward) return;
            
            // Check if already claimed
            const isClaimed = userData.claimedRewards?.includes(parseInt(rewardId)) || false;
            if (isClaimed) {
                showNotification('Reward already claimed!', 'error');
                return;
            }
            
            // Check requirements
            if ((userData.selfBusiness || 0) < reward.selfBusiness || (userData.teamBusiness || 0) < reward.teamBusiness) {
                showNotification('Requirements not met for this reward!', 'error');
                return;
            }
            
            // Update claimed rewards
            const claimedRewards = userData.claimedRewards || [];
            claimedRewards.push(parseInt(rewardId));
            
            updateUserData({ claimedRewards: claimedRewards })
                .then(() => {
                    showNotification(`Congratulations! You've claimed ${reward.name}!`, 'success');
                    updateRewardsProgress();
                })
                .catch((error) => {
                    showNotification('Error claiming reward: ' + error.message, 'error');
                });
        }

        function updateLevelIncome() {
            if (!userData) return;
            
            let totalCommission = 0;
            
            // Update level counts and earnings
            for (let level = 1; level <= 9; level++) {
                const count = userData.levelCounts?.[`level${level}`] || 0;
                const earnings = userData.levelEarnings?.[`level${level}`] || 0;
                
                document.getElementById(`level${level}Count`).textContent = count;
                document.getElementById(`level${level}Earnings`).textContent = earnings.toFixed(2) + ' USDT';
                
                totalCommission += earnings;
            }
            
            document.getElementById('totalTeamCommission').textContent = totalCommission.toFixed(2) + ' USDT';
        }

        function updateNetworkTree() {
            if (!userData) return;
            
            // Update network statistics
            document.getElementById('totalDownline').textContent = userData.totalDownline || 0;
            document.getElementById('activeDownline').textContent = userData.directReferrals || 0;
            document.getElementById('totalTeams').textContent = Object.values(userData.levelCounts || {}).reduce((a, b) => a + b, 0);
            
            // Simple network tree visualization
            const networkTree = document.getElementById('networkTree');
            networkTree.innerHTML = '';
            
            // Add user node
            const userLevel = document.createElement('div');
            userLevel.className = 'tree-level';
            userLevel.innerHTML = `
                <div class="tree-node you" onclick="showUserDetails('${currentUser.uid}')">
                    YOU
                    <div class="node-info">${userData.name}</div>
                </div>
            `;
            networkTree.appendChild(userLevel);
            
            // Add direct referrals (level 1)
            if (userData.directReferrals > 0) {
                const level1 = document.createElement('div');
                level1.className = 'tree-level';
                
                for (let i = 0; i < Math.min(userData.directReferrals, 5); i++) {
                    level1.innerHTML += `
                        <div class="tree-node" onclick="showUserDetails('level1_${i}')">
                            L1
                            <div class="node-info">Member ${i + 1}</div>
                        </div>
                    `;
                }
                
                if (userData.directReferrals > 5) {
                    level1.innerHTML += `
                        <div class="tree-node">
                            +${userData.directReferrals - 5}
                            <div class="node-info">More</div>
                        </div>
                    `;
                }
                
                networkTree.appendChild(level1);
            }
        }

        function showUserDetails(userId) {
            if (userId === currentUser.uid) {
                alert(`Your Details:\n\nName: ${userData.name}\nEmail: ${userData.email}\nJoin Date: ${new Date(userData.joinDate).toLocaleDateString()}\nLevel: ${userData.level}\nReferrals: ${userData.directReferrals}\nBalance: $${userData.balance.toFixed(2)}\nSelf Business: $${userData.selfBusiness.toFixed(2)}\nTeam Business: $${userData.teamBusiness.toFixed(2)}`);
            } else {
                alert('This is a simplified demo. In a real system, this would show detailed user information from the database.');
            }
        }

        function updateEarnings() {
            if (!userData) return;
            
            document.getElementById('totalEarningsAmount').textContent = (userData.totalEarnings || 0).toFixed(2) + ' USDT';
            document.getElementById('withdrawnAmount').textContent = (userData.totalWithdrawn || 0).toFixed(2) + ' USDT';
            document.getElementById('availableEarnings').textContent = userData.balance.toFixed(2) + ' USDT';
            
            // Calculate pending earnings from active investments
            let pendingEarnings = 0;
            if (userData.activeInvestments) {
                userData.activeInvestments.forEach(investment => {
                    if (investment.status === 'active') {
                        const dailyEarning = investment.amount * investment.dailyReturn / 100;
                        pendingEarnings += dailyEarning;
                    }
                });
            }
            
            document.getElementById('pendingEarnings').textContent = pendingEarnings.toFixed(2) + ' USDT';
            
            updateEarningsTable();
        }

        function updateEarningsTable() {
            if (!userData) return;
            
            const earningsTable = document.getElementById('earningsTable');
            earningsTable.innerHTML = '';
            
            const transactions = userData.transactions || [];
            const earningTransactions = transactions.filter(t => 
                t.type === 'commission' || t.type === 'investment_earning' || t.type === 'bonus'
            ).slice(-10).reverse();
            
            if (earningTransactions.length === 0) {
                earningsTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 2rem;">No earnings yet</td></tr>';
                return;
            }
            
            earningTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const date = new Date(transaction.timestamp).toLocaleDateString();
                let source = '';
                
                switch (transaction.type) {
                    case 'commission':
                        source = 'Team Commission';
                        break;
                    case 'investment_earning':
                        source = 'Investment Return';
                        break;
                    case 'bonus':
                        source = 'Daily Bonus';
                        break;
                    default:
                        source = transaction.type;
                }
                
                row.innerHTML = `
                    <td>${source}</td>
                    <td>${transaction.amount.toFixed(2)} USDT</td>
                    <td>${date}</td>
                    <td><span class="status-badge status-completed">Completed</span></td>
                `;
                earningsTable.appendChild(row);
            });
        }

        function updateTransactions() {
            updateDepositsTable();
            updateWithdrawalsTable();
        }

        function updateDepositsTable() {
            if (!userData) return;
            
            const depositsTable = document.getElementById('depositsTable');
            depositsTable.innerHTML = '';
            
            const transactions = userData.transactions || [];
            const depositTransactions = transactions.filter(t => t.type === 'deposit').slice(-5).reverse();
            
            if (depositTransactions.length === 0) {
                depositsTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 2rem;">No deposits yet</td></tr>';
                return;
            }
            
            depositTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const date = new Date(transaction.timestamp).toLocaleDateString();
                
                row.innerHTML = `
                    <td>${date}</td>
                    <td>${transaction.amount.toFixed(2)} USDT</td>
                    <td>USDT BEP20</td>
                    <td><span class="status-badge status-completed">Completed</span></td>
                `;
                depositsTable.appendChild(row);
            });
        }

        function updateWithdrawalsTable() {
            if (!userData) return;
            
            const withdrawalsTable = document.getElementById('withdrawalsTable');
            withdrawalsTable.innerHTML = '';
            
            const transactions = userData.transactions || [];
            const withdrawalTransactions = transactions.filter(t => t.type === 'withdrawal').slice(-5).reverse();
            
            if (withdrawalTransactions.length === 0) {
                withdrawalsTable.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 2rem;">No withdrawals yet</td></tr>';
                return;
            }
            
            withdrawalTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const date = new Date(transaction.timestamp).toLocaleDateString();
                const fee = transaction.fee || (transaction.amount * 12 / 100);
                const netAmount = transaction.netAmount || (transaction.amount - fee);
                
                row.innerHTML = `
                    <td>${date}</td>
                    <td>${transaction.amount.toFixed(2)} USDT</td>
                    <td>${netAmount.toFixed(2)} USDT</td>
                    <td>${fee.toFixed(2)} USDT</td>
                    <td><span class="status-badge ${transaction.status === 'pending' ? 'status-pending' : transaction.status === 'completed' ? 'status-completed' : 'status-active'}">${transaction.status}</span></td>
                `;
                withdrawalsTable.appendChild(row);
            });
        }

        // ====================
        // MODAL FUNCTIONS
        // ====================
        function openDepositModal() {
            document.getElementById('depositModal').classList.add('active');
            const depositInput = document.getElementById('depositAmount');
            depositInput.max = 5000;
            depositInput.min = 5; // Minimum deposit is $5
            depositInput.placeholder = "5";
            depositInput.value = 50;
        }

        function closeDepositModal() {
            document.getElementById('depositModal').classList.remove('active');
        }

        function processDeposit() {
            const amount = parseFloat(document.getElementById('depositAmount').value) || 0;
            
            if (amount < 5 || amount > 5000) {
                showNotification(`Please enter amount between $5 and $5000`, 'error');
                return;
            }
            
            // Create deposit request
            const depositRequest = {
                userId: currentUser.uid,
                userName: userData.name,
                amount: amount,
                status: 'pending',
                timestamp: new Date().toISOString(),
                type: 'deposit'
            };
            
            // Save deposit request to database
            database.ref('depositRequests').push(depositRequest)
                .then(() => {
                    showNotification('Deposit request submitted! Admin will approve it shortly.', 'success');
                    closeDepositModal();
                    
                    // Add to user transactions
                    addTransaction('deposit', amount, 'Deposit Request', 'pending');
                })
                .catch((error) => {
                    showNotification('Error submitting deposit request: ' + error.message, 'error');
                });
        }

        function openWithdrawModal() {
            document.getElementById('withdrawModal').classList.add('active');
            
            // Update available balance
            document.getElementById('availableBalance').textContent = userData.balance.toFixed(2) + ' USDT';
            
            // Setup withdrawal amount calculator
            const withdrawInput = document.getElementById('withdrawAmount');
            withdrawInput.value = Math.max(1, Math.min(userData.balance, 100));
            withdrawInput.max = userData.balance;
            withdrawInput.min = 1;
            withdrawInput.placeholder = "1";
            calculateWithdrawalAmount();
        }

        function closeWithdrawModal() {
            document.getElementById('withdrawModal').classList.remove('active');
        }

        function setupWithdrawalCalculator() {
            const withdrawInput = document.getElementById('withdrawAmount');
            if (withdrawInput) {
                withdrawInput.addEventListener('input', calculateWithdrawalAmount);
            }
        }

        function calculateWithdrawalAmount() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value) || 0;
            const withdrawalFee = (amount * 12 / 100);
            const netAmount = amount - withdrawalFee;
            
            document.getElementById('withdrawalFee').value = withdrawalFee.toFixed(2) + ' USDT';
            document.getElementById('netAmount').value = netAmount.toFixed(2) + ' USDT';
        }

        function processWithdrawal() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value) || 0;
            const walletAddress = document.getElementById('withdrawAddress').value.trim();
            
            if (amount < 1) {
                showNotification(`Minimum withdrawal amount is 1 USDT`, 'error');
                return;
            }
            
            if (amount > userData.balance) {
                showNotification('Insufficient balance', 'error');
                return;
            }
            
            if (!walletAddress || walletAddress.length < 20) {
                showNotification('Please enter a valid USDT BEP20 wallet address', 'error');
                return;
            }
            
            const withdrawalFee = (amount * 12 / 100);
            const netAmount = amount - withdrawalFee;
            
            // Update user balance
            const updates = {
                balance: userData.balance - amount,
                totalWithdrawn: (userData.totalWithdrawn || 0) + amount
            };
            
            // Create withdrawal request
            const withdrawalRequest = {
                userId: currentUser.uid,
                userName: userData.name,
                amount: amount,
                fee: withdrawalFee,
                netAmount: netAmount,
                walletAddress: walletAddress,
                status: 'pending',
                timestamp: new Date().toISOString(),
                type: 'withdrawal'
            };
            
            // Save withdrawal request to database
            database.ref('withdrawalRequests').push(withdrawalRequest)
                .then(() => {
                    // Update user data
                    return updateUserData(updates);
                })
                .then(() => {
                    // Add to user transactions
                    return addTransaction('withdrawal', amount, 'Withdrawal Request', 'pending');
                })
                .then(() => {
                    showNotification('Withdrawal request submitted! $' + amount + ' deducted from your balance. Admin will process it within ' + systemSettings.withdrawalProcessingTime + ' hours.', 'success');
                    closeWithdrawModal();
                })
                .catch((error) => {
                    showNotification('Error submitting withdrawal request: ' + error.message, 'error');
                });
        }

        // ====================
        // CHAT FUNCTIONS
        // ====================
        function showChat() {
            document.getElementById('chatContainer').classList.add('active');
            chatActive = true;
        }

        function hideChat() {
            document.getElementById('chatContainer').classList.remove('active');
            chatActive = false;
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addChatMessage('user', message);
            input.value = '';
            
            // Simulate bot response
            setTimeout(() => {
                const responses = [
                    "Thanks for your message! Our support team will get back to you soon.",
                    "I understand your concern. Can you please provide more details?",
                    "For immediate assistance, please email support@cryptowealthpro.com",
                    "Your query has been noted. We'll respond within 24 hours.",
                    "Is there anything specific about our platform you'd like to know?"
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addChatMessage('bot', randomResponse);
            }, 1000);
        }

        function addChatMessage(sender, message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            if (sender === 'user') {
                messageDiv.innerHTML = `<strong>You:</strong> ${message}`;
            } else {
                messageDiv.innerHTML = `<strong>Support Bot:</strong> ${message}`;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // ====================
        // CRYPTO BOT FUNCTIONS
        // ====================
        function showCryptoBot() {
            document.getElementById('cryptoBotModal').classList.add('active');
        }

        function hideCryptoBot() {
            document.getElementById('cryptoBotModal').classList.remove('active');
        }

        function askBotQuestion(topic) {
            let response = "";
            
            switch(topic) {
                case 'bitcoin':
                    response = "Bitcoin (BTC) is the first decentralized cryptocurrency, created in 2009. It operates on blockchain technology with a limited supply of 21 million coins. Current market cap: $1.2 trillion+";
                    break;
                case 'ethereum':
                    response = "Ethereum (ETH) is a decentralized platform for smart contracts and dApps. It's the second-largest cryptocurrency by market cap. ETH 2.0 upgrade transitioned to Proof-of-Stake consensus.";
                    break;
                case 'usdt':
                    response = "USDT (Tether) is a stablecoin pegged 1:1 to the US Dollar. Use BEP20 network for fast and low-cost transactions. Always verify contract address before sending.";
                    break;
                case 'investment':
                    response = "Diversify your portfolio, start with small amounts, research thoroughly, never invest more than you can afford to lose, and consider long-term holding strategies.";
                    break;
                case 'security':
                    response = "Use hardware wallets for large amounts, enable 2FA, never share private keys, verify addresses before sending, and beware of phishing sites.";
                    break;
                case 'withdrawal':
                    response = "Withdrawals take 1-24 hours. Minimum withdrawal: 1 USDT. Fee: 12%. Use BEP20 network only. Ensure wallet address is correct.";
                    break;
                default:
                    response = "I'm here to help with cryptocurrency questions. What would you like to know?";
            }
            
            const botContent = document.querySelector('.bot-content');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'bot-message';
            messageDiv.innerHTML = `<strong>Crypto Bot:</strong> ${response}`;
            
            botContent.insertBefore(messageDiv, botContent.children[1]);
        }

        function askCustomQuestion() {
            const input = document.getElementById('botQuestion');
            const question = input.value.trim();
            
            if (!question) return;
            
            const responses = [
                "That's a great question about cryptocurrency! The key is to research thoroughly and understand the risks involved.",
                "Based on my analysis, diversification and long-term holding often yield better results than short-term trading.",
                "Security should always be your top priority. Use trusted wallets and enable all available security features.",
                "The crypto market is volatile. Consider dollar-cost averaging to minimize risk during price fluctuations.",
                "Always verify information from multiple sources before making investment decisions in cryptocurrency."
            ];
            
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            
            const botContent = document.querySelector('.bot-content');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'bot-message';
            messageDiv.innerHTML = `<strong>Crypto Bot:</strong> ${randomResponse}`;
            
            botContent.insertBefore(messageDiv, botContent.children[1]);
            input.value = '';
        }

        // ====================
        // REFERRAL FUNCTIONS
        // ====================
        function showReferralModal() {
            if (!userData) return;
            
            document.getElementById('referralModal').classList.add('active');
            const currentUrl = window.location.origin + window.location.pathname;
            const referralLink = `${currentUrl}?ref=${userData.referralCode}`;
            document.getElementById('referralLinkText').textContent = referralLink;
        }

        function closeReferralModal() {
            document.getElementById('referralModal').classList.remove('active');
        }

        function copyReferralLink() {
            const link = document.getElementById('referralLinkText').textContent;
            const copyBtn = document.getElementById('copyBtn');
            
            navigator.clipboard.writeText(link)
                .then(() => {
                    copyBtn.classList.add('copy-success');
                    copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                    
                    setTimeout(() => {
                        copyBtn.classList.remove('copy-success');
                        copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copy';
                    }, 2000);
                    
                    showNotification('Referral link copied to clipboard!', 'success');
                })
                .catch((error) => {
                    showNotification('Failed to copy link', 'error');
                });
        }

        function shareOnFacebook() {
            const link = encodeURIComponent(document.getElementById('referralLinkText').textContent);
            const text = encodeURIComponent("Join CryptoWealth Pro and earn 6-7.5% daily returns! 9-level commission structure.");
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${link}&quote=${text}`, '_blank');
        }

        function shareOnWhatsApp() {
            const link = document.getElementById('referralLinkText').textContent;
            const text = `Join CryptoWealth Pro and earn 6-7.5% daily returns! 9-level commission structure. Sign up here: ${link}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }

        function shareOnTelegram() {
            const link = document.getElementById('referralLinkText').textContent;
            const text = `Join CryptoWealth Pro and earn 6-7.5% daily returns! 9-level commission structure. Sign up here: ${link}`;
            window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`, '_blank');
        }

        // ====================
        // PROFILE FUNCTIONS
        // ====================
        function updateProfile() {
            if (!userData) return;
            
            const name = document.getElementById('settingsName').value;
            const email = document.getElementById('settingsEmail').value;
            const phone = document.getElementById('settingsPhone').value;
            const walletAddress = document.getElementById('walletAddress').value;
            
            const updates = {};
            if (name !== userData.name) updates.name = name;
            if (email !== userData.email) updates.email = email;
            if (phone !== userData.phone) updates.phone = phone;
            if (walletAddress !== userData.usdtWallet) {
                updates.usdtWallet = walletAddress;
                updates.walletAddress = walletAddress;
            }
            
            if (Object.keys(updates).length > 0) {
                updateUserData(updates)
                    .then(() => {
                        showNotification('Profile updated successfully!', 'success');
                        updateSidebarProfile();
                    })
                    .catch((error) => {
                        showNotification('Error: ' + error.message, 'error');
                    });
            }
        }

        // ====================
        // ADMIN FUNCTIONS
        // ====================
        function adminRefreshStats() {
            // Get total users
            database.ref('users').once('value')
                .then((snapshot) => {
                    const users = snapshot.val();
                    const totalUsers = users ? Object.keys(users).length : 0;
                    document.getElementById('adminTotalUsers').textContent = totalUsers;
                    
                    // Calculate total deposits and withdrawals
                    let totalDeposits = 0;
                    let totalWithdrawals = 0;
                    let platformProfit = 0;
                    
                    if (users) {
                        Object.values(users).forEach(user => {
                            totalDeposits += user.totalInvested || 0;
                            totalWithdrawals += user.totalWithdrawn || 0;
                        });
                        
                        // Platform profit = total deposits - total withdrawals
                        platformProfit = totalDeposits - totalWithdrawals;
                    }
                    
                    document.getElementById('adminTotalDeposits').textContent = totalDeposits.toFixed(2) + ' USDT';
                    document.getElementById('adminTotalWithdrawals').textContent = totalWithdrawals.toFixed(2) + ' USDT';
                    document.getElementById('adminPlatformProfit').textContent = platformProfit.toFixed(2) + ' USDT';
                })
                .catch((error) => {
                    showNotification('Error loading stats: ' + error.message, 'error');
                });
        }

        function adminGetUserData() {
            const userId = document.getElementById('adminUserId').value.trim();
            
            if (!userId) {
                showNotification('Please enter a user ID', 'error');
                return;
            }
            
            database.ref('users/' + userId).once('value')
                .then((snapshot) => {
                    const user = snapshot.val();
                    if (!user) {
                        showNotification('User not found', 'error');
                        document.getElementById('adminUserInfo').style.display = 'none';
                        return;
                    }
                    
                    const userInfoDiv = document.getElementById('adminUserInfo');
                    userInfoDiv.style.display = 'block';
                    userInfoDiv.innerHTML = `
                        <div style="background: rgba(0,255,136,0.1); padding: 0.8rem; border-radius: 8px;">
                            <p><strong>Name:</strong> ${user.name}</p>
                            <p><strong>Email:</strong> ${user.email}</p>
                            <p><strong>Balance:</strong> ${user.balance.toFixed(2)} USDT</p>
                            <p><strong>Total Earnings:</strong> ${user.totalEarnings.toFixed(2)} USDT</p>
                            <p><strong>Total Withdrawn:</strong> ${user.totalWithdrawn.toFixed(2)} USDT</p>
                            <p><strong>Self Business:</strong> ${user.selfBusiness.toFixed(2)} USDT</p>
                            <p><strong>Team Business:</strong> ${user.teamBusiness.toFixed(2)} USDT</p>
                        </div>
                    `;
                })
                .catch((error) => {
                    showNotification('Error finding user: ' + error.message, 'error');
                });
        }

        function adminUpdateUserBalance() {
            const userId = document.getElementById('adminUserId').value.trim();
            const newBalance = prompt('Enter new balance (USDT):');
            
            if (!userId || !newBalance) {
                showNotification('Please enter user ID and new balance', 'error');
                return;
            }
            
            const balance = parseFloat(newBalance);
            if (isNaN(balance) || balance < 0) {
                showNotification('Please enter a valid positive number', 'error');
                return;
            }
            
            database.ref('users/' + userId + '/balance').set(balance)
                .then(() => {
                    showNotification('User balance updated successfully!', 'success');
                    adminGetUserData(); // Refresh user info
                })
                .catch((error) => {
                    showNotification('Error updating balance: ' + error.message, 'error');
                });
        }

        function adminShowDepositRequests() {
            alert('Deposit requests management would open here. In a real system, this would show a list of pending deposit requests for approval.');
        }

        function adminShowWithdrawalRequests() {
            alert('Withdrawal requests management would open here. In a real system, this would show a list of pending withdrawal requests for approval.');
        }

        // ====================
        // UTILITY FUNCTIONS
        // ====================
        function generateReferralCode(name) {
            const initials = name.split(' ').map(n => n[0]).join('').toUpperCase();
            const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
            return initials + random;
        }

        function showNotification(message, type) {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                <div>${message}</div>
            `;
            
            container.appendChild(notification);
            
            // Show notification
            setTimeout(() => notification.classList.add('show'), 10);
            
            // Remove after 5 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }

        // ====================
        // ACTIVE INVESTMENTS SIMULATION
        // ====================
        function simulateActiveInvestments() {
            if (!userData || !userData.activeInvestments) return;
            
            setInterval(() => {
                if (!userData) return;
                
                let hasUpdate = false;
                const updates = {};
                const now = new Date();
                
                // Check each active investment
                userData.activeInvestments.forEach((investment, index) => {
                    if (investment.status === 'active') {
                        const endDate = new Date(investment.endDate);
                        
                        if (now >= endDate) {
                            // Investment completed
                            userData.activeInvestments[index].status = 'completed';
                            hasUpdate = true;
                        } else {
                            // Check if 24 hours have passed since investment
                            const startDate = new Date(investment.startDate);
                            const hoursSinceInvestment = (now - startDate) / (1000 * 60 * 60);
                            
                            if (hoursSinceInvestment >= 24) {
                                // Check last earning time
                                const lastEarning = investment.lastEarning ? new Date(investment.lastEarning) : new Date(startDate.getTime() + 24 * 60 * 60 * 1000);
                                const hoursSinceLastEarning = (now - lastEarning) / (1000 * 60 * 60);
                                
                                if (hoursSinceLastEarning >= 24) {
                                    const dailyEarning = investment.amount * investment.dailyReturn / 100;
                                    
                                    userData.balance += dailyEarning;
                                    userData.totalEarnings += dailyEarning;
                                    userData.activeInvestments[index].totalEarned += dailyEarning;
                                    userData.activeInvestments[index].lastEarning = now.toISOString();
                                    hasUpdate = true;
                                }
                            }
                        }
                    }
                });
                
                if (hasUpdate) {
                    updates.balance = userData.balance;
                    updates.totalEarnings = userData.totalEarnings;
                    updates.activeInvestments = userData.activeInvestments;
                    updateUserData(updates);
                }
                
            }, 60000); // Check every minute
        }

        // Start investment simulation
        if (userData && userData.activeInvestments) {
            simulateActiveInvestments();
        }
    </script>
</body>
</html>
