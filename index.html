<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoWealth Pro - Advanced Crypto MLM Platform</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0a0a1a;
            --secondary: #00ff88;
            --accent: #8a2be2;
            --warning: #ffaa00;
            --danger: #ff375f;
            --info: #00d4ff;
            --dark: #050510;
            --light: #f0f0f0;
            --card-bg: rgba(20, 20, 40, 0.95);
            --gradient: linear-gradient(135deg, #0a0a1a 0%, #151530 100%);
            --gradient-accent: linear-gradient(135deg, #00ff88 0%, #00d4ff 100%);
            --gradient-purple: linear-gradient(135deg, #8a2be2 0%, #ff00ff 100%);
            --gradient-3d: linear-gradient(145deg, #0a0a1a 0%, #1a1a3a 50%, #0a0a1a 100%);
            --shadow: 0 10px 30px rgba(0, 255, 136, 0.2);
            --shadow-3d: 0 20px 40px rgba(0, 0, 0, 0.5), 0 10px 20px rgba(0, 255, 136, 0.15);
            --glow: 0 0 20px rgba(0, 255, 136, 0.4);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --modern-primary: #0f0f23;
            --modern-secondary: #00ff9d;
            --modern-accent: #a855f7;
            --modern-warning: #f59e0b;
            --modern-danger: #ef4444;
            --modern-info: #3b82f6;
            --gradient-modern: linear-gradient(135deg, #0f0f23 0%, #1e1e40 50%, #0f0f23 100%);
            --gradient-card: linear-gradient(145deg, rgba(20, 20, 45, 0.95) 0%, rgba(30, 30, 60, 0.95) 100%);
            --gradient-button: linear-gradient(135deg, #00ff9d 0%, #3b82f6 100%);
            --gradient-gold: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);
            --gradient-silver: linear-gradient(135deg, #d1d5db 0%, #9ca3af 50%, #6b7280 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--gradient-modern);
            color: var(--light);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            background-attachment: fixed;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 255, 157, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(168, 85, 247, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);
            z-index: -1;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            margin-bottom: 1rem;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-modern);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(0, 255, 157, 0.3);
            border-radius: 50%;
            border-top-color: var(--modern-secondary);
            animation: spin 1s linear infinite;
            margin-bottom: 2rem;
            box-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Header - Always Visible */
        header {
            background: rgba(15, 15, 35, 0.98);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(0, 255, 157, 0.2);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-3d);
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 900;
            background: var(--gradient-button);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
            text-decoration: none;
            white-space: nowrap;
            text-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 1rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--light);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 0.8rem;
            border-radius: 8px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
            position: relative;
            overflow: hidden;
            font-size: 0.9rem;
            white-space: nowrap;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
        }

        .nav-links a::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: var(--gradient-button);
            transition: left 0.3s;
        }

        .nav-links a:hover::before {
            left: 0;
        }

        .nav-links a:hover {
            background: rgba(0, 255, 157, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.2);
        }

        .auth-buttons {
            display: flex;
            gap: 0.5rem;
            margin-left: 1rem;
        }

        .auth-buttons .btn {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .mobile-menu-btn:hover {
            background: rgba(0, 255, 157, 0.1);
        }

        /* Company Overview Page - Always Visible */
        .company-overview {
            min-height: 100vh;
            padding-top: 80px;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3a 100%);
            position: relative;
            overflow: hidden;
        }

        .company-overview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(0, 255, 157, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(168, 85, 247, 0.05) 0%, transparent 40%);
            z-index: 0;
        }

        .hero-section {
            padding: 4rem 0;
            text-align: center;
            background: linear-gradient(135deg, rgba(0, 255, 157, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            border-radius: 20px;
            margin: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-3d);
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://images.unsplash.com/photo-1620336655055-bd87c6d6420b?q=80&w=1000') center/cover no-repeat;
            opacity: 0.1;
            z-index: 0;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
        }

        .logo-large {
            font-size: 4rem;
            font-weight: 900;
            background: var(--gradient-button);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        .tagline {
            font-size: 1.8rem;
            margin-bottom: 2rem;
            color: var(--light);
            font-weight: 300;
            line-height: 1.4;
            background: linear-gradient(135deg, #ffffff 0%, #a0a0c0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 3rem;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            background: var(--gradient-card);
            padding: 1.5rem;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            min-width: 180px;
            box-shadow: var(--shadow-3d);
            transition: all 0.3s;
        }

        .stat-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.6);
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 900;
            color: var(--modern-secondary);
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }

        .stat-label {
            font-size: 1rem;
            color: #a0a0c0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .mission-section {
            padding: 5rem 0;
            background: rgba(15, 15, 35, 0.8);
            position: relative;
        }

        .mission-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .mission-icon {
            font-size: 4rem;
            margin-bottom: 2rem;
            background: var(--gradient-button);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .mission-text {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #cbd5e1;
            margin-bottom: 2rem;
        }

        .features-section {
            padding: 5rem 0;
            background: rgba(20, 20, 45, 0.8);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .feature-card {
            background: var(--gradient-card);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid rgba(0, 255, 157, 0.1);
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-3d);
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 157, 0.1), transparent);
            transition: left 0.5s;
        }

        .feature-card:hover::before {
            left: 100%;
        }

        .feature-card:hover {
            transform: translateY(-10px) scale(1.02);
            background: linear-gradient(145deg, rgba(30, 30, 60, 0.95) 0%, rgba(40, 40, 80, 0.95) 100%);
            border-color: var(--modern-secondary);
            box-shadow: 0 25px 50px rgba(0, 255, 157, 0.3);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            background: var(--gradient-button);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .feature-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--light);
        }

        .feature-description {
            color: #a0a0c0;
            line-height: 1.6;
        }

        .investment-plans-section {
            padding: 5rem 0;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.9) 0%, rgba(25, 25, 55, 0.9) 100%);
        }

        .plans-overview {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            margin-top: 3rem;
        }

        .plan-overview-card {
            background: var(--gradient-card);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            border: 2px solid rgba(0, 255, 157, 0.3);
            transition: all 0.3s;
            flex: 1;
            min-width: 250px;
            max-width: 300px;
            box-shadow: var(--shadow-3d);
            position: relative;
            overflow: hidden;
        }

        .plan-overview-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 157, 0.1), transparent);
            transition: left 0.5s;
        }

        .plan-overview-card:hover::before {
            left: 100%;
        }

        .plan-overview-card:hover {
            transform: translateY(-5px);
            border-color: var(--modern-secondary);
            box-shadow: 0 20px 40px rgba(0, 255, 157, 0.3);
        }

        .plan-name {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--modern-secondary);
        }

        .plan-details {
            list-style: none;
            margin: 1.5rem 0;
        }

        .plan-details li {
            margin-bottom: 0.8rem;
            color: #cbd5e1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .plan-details i {
            color: var(--modern-secondary);
        }

        .cta-section {
            padding: 5rem 0;
            text-align: center;
            background: linear-gradient(135deg, rgba(0, 255, 157, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
        }

        .cta-content {
            max-width: 600px;
            margin: 0 auto;
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        /* Auth Modal */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
            overflow-y: auto;
            padding: 20px;
        }

        .auth-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .auth-container {
            background: var(--gradient-card);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            padding: 3rem;
            border: 1px solid rgba(0, 255, 157, 0.3);
            box-shadow: var(--shadow-3d);
            position: relative;
            overflow: hidden;
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 157, 0.1), transparent);
            transition: left 0.5s;
        }

        .auth-container:hover::before {
            left: 100%;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-logo {
            font-size: 2rem;
            font-weight: 900;
            background: var(--gradient-button);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 2rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 0.5rem;
        }

        .auth-tab {
            flex: 1;
            padding: 1rem;
            background: none;
            border: none;
            color: var(--light);
            font-weight: 600;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .auth-tab.active {
            background: var(--gradient-button);
            color: var(--dark);
            box-shadow: var(--shadow-3d);
        }

        .auth-form {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .auth-form.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .close-auth-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: var(--modern-danger);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.4rem 0.8rem;
            border-radius: 50%;
            transition: all 0.3s;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            line-height: 1;
        }

        .close-auth-modal:hover {
            background: rgba(239, 68, 68, 0.3);
            color: var(--modern-danger);
            transform: scale(1.1);
        }

        /* Main App - Hidden Initially */
        .app-container {
            display: none;
            min-height: 100vh;
        }

        /* Main Content */
        .main-content {
            margin-top: 80px;
            padding: 2rem 0;
            min-height: calc(100vh - 200px);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.2rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--gradient-card);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid rgba(0, 255, 157, 0.2);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-3d);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 157, 0.1), transparent);
            transition: left 0.5s;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--modern-secondary);
            box-shadow: 0 20px 40px rgba(0, 255, 157, 0.3);
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 0.8rem;
            background: var(--gradient-button);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 900;
            font-family: 'Orbitron', sans-serif;
            color: var(--modern-secondary);
            margin-bottom: 0.3rem;
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }

        .stat-label {
            color: #a0a0c0;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1.2px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: rgba(20, 20, 45, 0.8);
            border-radius: 10px;
            margin-bottom: 2rem;
            overflow-x: auto;
            padding: 0.4rem;
            gap: 0.4rem;
            scrollbar-width: thin;
            scrollbar-color: var(--modern-secondary) transparent;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tabs::-webkit-scrollbar {
            height: 6px;
        }

        .tabs::-webkit-scrollbar-track {
            background: transparent;
        }

        .tabs::-webkit-scrollbar-thumb {
            background: var(--modern-secondary);
            border-radius: 3px;
        }

        .tab-btn {
            padding: 0.8rem 1rem;
            background: none;
            border: none;
            color: var(--light);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            min-height: 40px;
        }

        .tab-btn:hover {
            background: rgba(0, 255, 157, 0.1);
        }

        .tab-btn.active {
            background: var(--gradient-button);
            color: var(--dark);
            box-shadow: var(--shadow-3d);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        /* Investment Plans - LEFT TO RIGHT */
        .plans-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 1.5rem;
            justify-content: flex-start;
        }

        .plan-card {
            background: var(--gradient-card);
            border-radius: 15px;
            padding: 1.8rem;
            border: 2px solid rgba(0, 255, 157, 0.3);
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
            flex: 1;
            min-width: 280px;
            max-width: 320px;
            box-shadow: var(--shadow-3d);
        }

        .plan-card.already-invested {
            opacity: 0.7;
            border-color: rgba(239, 68, 68, 0.3);
        }

        .plan-card.popular {
            border-color: var(--modern-accent);
            transform: scale(1.02);
            box-shadow: 0 20px 40px rgba(168, 85, 247, 0.3);
        }

        .plan-card.popular::before {
            content: "POPULAR";
            position: absolute;
            top: 12px;
            right: -28px;
            background: var(--gradient-button);
            color: var(--dark);
            padding: 4px 25px;
            font-size: 0.7rem;
            font-weight: bold;
            transform: rotate(45deg);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .plan-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--gradient-button);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .already-invested-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--gradient-button);
            color: var(--dark);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
            z-index: 1;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Leadership Rewards */
        .rewards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .reward-card {
            background: var(--gradient-card);
            border-radius: 15px;
            padding: 1.8rem;
            border: 2px solid rgba(168, 85, 247, 0.3);
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-3d);
        }

        .reward-card.achieved {
            border-color: var(--modern-secondary);
            background: linear-gradient(135deg, rgba(20, 20, 45, 0.95) 0%, rgba(0, 255, 157, 0.1) 100%);
            box-shadow: 0 20px 40px rgba(0, 255, 157, 0.3);
        }

        .reward-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--gradient-button);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .reward-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            background: var(--gradient-button);
            color: var(--dark);
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Level Income */
        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.2rem;
            margin-top: 1.5rem;
        }

        .level-card {
            background: var(--gradient-card);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid rgba(0, 255, 157, 0.2);
            text-align: center;
            box-shadow: var(--shadow-3d);
        }

        .level-number {
            font-size: 2rem;
            font-weight: 900;
            color: var(--modern-secondary);
            margin-bottom: 0.8rem;
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }

        /* Network Tree */
        .network-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            margin: 1.5rem 0;
            overflow-x: auto;
            padding: 0.8rem;
        }

        .tree-level {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tree-node {
            width: 100px;
            height: 100px;
            background: var(--gradient-button);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: var(--dark);
            font-weight: bold;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .tree-node:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 30px rgba(0, 255, 157, 0.3);
        }

        .tree-node.you {
            background: var(--gradient-button);
            color: var(--dark);
            animation: pulse 2s infinite;
            box-shadow: 0 10px 20px rgba(168, 85, 247, 0.3);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        /* Crypto Chat */
        .chat-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 320px;
            height: 420px;
            background: var(--gradient-card);
            border-radius: 15px;
            border: 1px solid rgba(0, 255, 157, 0.3);
            display: none;
            flex-direction: column;
            z-index: 1001;
            box-shadow: var(--shadow-3d);
        }

        .chat-container.active {
            display: flex;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .chat-header {
            padding: 0.8rem;
            background: rgba(0, 255, 157, 0.1);
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex: 1;
            padding: 0.8rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .message {
            max-width: 80%;
            padding: 0.6rem 0.8rem;
            border-radius: 10px;
            position: relative;
            font-size: 0.9rem;
        }

        .message.user {
            align-self: flex-end;
            background: var(--gradient-button);
            color: var(--dark);
        }

        .message.bot {
            align-self: flex-start;
            background: rgba(168, 85, 247, 0.2);
            border: 1px solid rgba(168, 85, 247, 0.5);
        }

        .chat-input {
            padding: 0.8rem;
            border-top: 1px solid rgba(0, 255, 157, 0.2);
            display: flex;
            gap: 0.4rem;
        }

        .chat-input input {
            flex: 1;
            padding: 0.6rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 157, 0.3);
            border-radius: 6px;
            color: var(--light);
            font-size: 0.9rem;
        }

        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
            overflow-y: auto;
            padding: 20px;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--gradient-card);
            width: 90%;
            max-width: 500px;
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(0, 255, 157, 0.3);
            position: relative;
            box-shadow: var(--shadow-3d);
            margin: auto;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: var(--modern-danger);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.4rem 0.8rem;
            border-radius: 50%;
            transition: all 0.3s;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            line-height: 1;
        }

        .close-modal:hover {
            background: rgba(239, 68, 68, 0.3);
            color: var(--modern-danger);
            transform: scale(1.1);
        }

        /* Admin Modal */
        .admin-modal {
            max-width: 800px;
        }

        .admin-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .admin-tab-btn {
            padding: 0.6rem 1rem;
            background: rgba(0, 255, 157, 0.1);
            border: 1px solid rgba(0, 255, 157, 0.3);
            color: var(--light);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .admin-tab-btn.active {
            background: var(--gradient-button);
            color: var(--dark);
        }

        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
        }

        /* Admin Panel Button */
        .admin-panel-btn {
            position: fixed;
            bottom: 20px;
            right: 90px;
            background: var(--gradient-button);
            color: var(--dark);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4);
            transition: all 0.3s;
        }

        .admin-panel-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.6);
        }

        /* Buttons */
        .btn {
            padding: 0.7rem 1.5rem;
            background: var(--gradient-button);
            color: var(--dark);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            font-size: 0.9rem;
            box-shadow: var(--shadow-3d);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 255, 157, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-success {
            background: var(--gradient-button);
        }

        .btn-warning {
            background: var(--gradient-gold);
            color: var(--dark);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .btn-purple {
            background: var(--gradient-button);
            color: var(--dark);
        }

        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.4rem;
            color: #cbd5e1;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-control {
            width: 100%;
            padding: 0.8rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 157, 0.3);
            border-radius: 8px;
            color: var(--light);
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--modern-secondary);
            box-shadow: 0 0 0 3px rgba(0, 255, 157, 0.2);
            background: rgba(255, 255, 255, 0.15);
        }

        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
            font-size: 0.9rem;
        }

        .data-table th {
            background: rgba(0, 255, 157, 0.2);
            padding: 0.8rem;
            text-align: left;
            font-weight: 600;
            color: var(--modern-secondary);
        }

        .data-table td {
            padding: 0.8rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-table tr:hover {
            background: rgba(0, 255, 157, 0.05);
        }

        /* Footer */
        footer {
            background: rgba(15, 15, 35, 0.98);
            padding: 2rem 0;
            margin-top: 3rem;
            border-top: 1px solid rgba(0, 255, 157, 0.1);
            backdrop-filter: blur(10px);
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        /* Notifications */
        .notification-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 3000;
        }

        .notification {
            background: var(--gradient-card);
            border-left: 4px solid var(--modern-secondary);
            color: white;
            padding: 0.8rem 1.2rem;
            border-radius: 8px;
            margin-bottom: 0.8rem;
            box-shadow: var(--shadow-3d);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            min-width: 250px;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification i {
            font-size: 1.2rem;
        }

        .notification.success {
            border-left-color: var(--modern-secondary);
        }

        .notification.success i {
            color: var(--modern-secondary);
        }

        .notification.error {
            border-left-color: var(--modern-danger);
        }

        .notification.error i {
            color: var(--modern-danger);
        }

        /* Marketplace Button */
        .marketplace-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--gradient-button);
            color: var(--dark);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(168, 85, 247, 0.4);
            transition: all 0.3s;
        }

        .marketplace-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(168, 85, 247, 0.6);
        }

        /* Crypto Bot Modal */
        .crypto-bot-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--gradient-card);
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            max-height: 70vh;
            overflow-y: auto;
            z-index: 2001;
            display: none;
            box-shadow: var(--shadow-3d);
            border: 2px solid var(--modern-accent);
        }

        .crypto-bot-modal.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .bot-header {
            padding: 1rem;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .bot-content {
            padding: 1rem;
        }

        .bot-message {
            background: rgba(168, 85, 247, 0.1);
            padding: 0.8rem;
            border-radius: 8px;
            margin-bottom: 0.8rem;
            border-left: 4px solid var(--modern-accent);
            font-size: 0.9rem;
        }

        .bot-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 0.8rem;
            margin-top: 1.2rem;
        }

        .bot-option {
            background: rgba(0, 255, 157, 0.1);
            padding: 0.8rem;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(0, 255, 157, 0.3);
            font-size: 0.85rem;
        }

        .bot-option:hover {
            background: rgba(0, 255, 157, 0.2);
            transform: translateY(-2px);
        }

        /* Referral Modal */
        .referral-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--gradient-card);
            border-radius: 20px;
            width: 90%;
            max-width: 450px;
            z-index: 2001;
            display: none;
            box-shadow: var(--shadow-3d);
        }

        .referral-modal.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .referral-link-container {
            background: rgba(0, 255, 157, 0.1);
            padding: 0.8rem;
            border-radius: 8px;
            margin: 0.8rem 0;
            display: flex;
            gap: 0.4rem;
            align-items: center;
        }

        .referral-link {
            flex: 1;
            padding: 0.6rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            word-break: break-all;
            font-size: 0.85rem;
        }

        /* Copy Button Animation */
        .copy-success {
            background: var(--modern-secondary) !important;
            color: var(--dark) !important;
        }

        /* Progress Bars */
        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-button);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        /* Profile Sidebar */
        .profile-sidebar {
            position: fixed;
            top: 80px;
            right: 0;
            width: 280px;
            height: calc(100vh - 80px);
            background: var(--gradient-card);
            border-left: 1px solid rgba(0, 255, 157, 0.2);
            z-index: 900;
            overflow-y: auto;
            padding: 1.5rem;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            box-shadow: var(--shadow-3d);
        }

        .profile-sidebar.active {
            transform: translateX(0);
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
        }

        .profile-sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0, 255, 157, 0.2);
        }

        .profile-close-btn {
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.3s;
        }

        .profile-close-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            color: var(--modern-danger);
        }

        .profile-info-card {
            background: rgba(0, 255, 157, 0.1);
            border-radius: 10px;
            padding: 1.2rem;
            margin-bottom: 1.5rem;
            text-align: center;
            border: 1px solid rgba(0, 255, 157, 0.2);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--gradient-button);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            margin: 0 auto 1rem;
            border: 3px solid var(--modern-secondary);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.3);
        }

        /* Investment Timer */
        .investment-timer {
            background: rgba(0, 255, 157, 0.1);
            padding: 0.8rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-size: 0.9rem;
            border: 1px solid rgba(0, 255, 157, 0.2);
        }

        .timer-display {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--modern-secondary);
            margin-top: 0.3rem;
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .nav-links {
                gap: 0.6rem;
            }
            
            .nav-links a {
                padding: 0.4rem 0.6rem;
                font-size: 0.85rem;
            }
            
            .profile-sidebar {
                width: 250px;
            }
        }

        @media (max-width: 992px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: rgba(15, 15, 35, 0.98);
                flex-direction: column;
                padding: 1rem;
                backdrop-filter: blur(15px);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
                z-index: 1001;
            }

            .nav-links.active {
                display: flex;
            }

            .mobile-menu-btn {
                display: block;
            }

            .logo {
                font-size: 1.3rem;
            }
            
            .profile-sidebar {
                width: 100%;
                transform: translateX(100%);
            }
            
            .hero-stats {
                gap: 2rem;
            }
            
            .stat-number {
                font-size: 2.5rem;
            }
            
            .logo-large {
                font-size: 3rem;
            }
            
            .tagline {
                font-size: 1.5rem;
            }
            
            .plans-container {
                justify-content: center;
            }
            
            .plan-card {
                min-width: 100%;
            }
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .tab-btn {
                flex: 1 0 calc(33.333% - 0.4rem);
                min-width: 120px;
                padding: 0.6rem 0.8rem;
            }

            .auth-container {
                padding: 2rem;
            }

            .modal-content {
                padding: 1.5rem;
            }

            .plans-container {
                grid-template-columns: 1fr;
            }

            .rewards-container {
                grid-template-columns: 1fr;
            }

            .level-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .chat-container {
                width: 280px;
                height: 380px;
            }
            
            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
            }
            
            .quick-actions {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .quick-actions .btn {
                flex: 1;
                min-width: 140px;
            }
            
            .hero-stats {
                gap: 1.5rem;
            }
            
            .stat-number {
                font-size: 2rem;
            }
            
            .stat-label {
                font-size: 0.9rem;
            }
            
            .logo-large {
                font-size: 2.5rem;
            }
            
            .tagline {
                font-size: 1.2rem;
            }
            
            .mission-icon {
                font-size: 3rem;
            }
            
            .mission-text {
                font-size: 1.1rem;
            }
            
            .feature-card {
                padding: 1.5rem;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .cta-buttons .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .admin-panel-btn {
                right: 20px;
                bottom: 80px;
            }
        }

        @media (max-width: 576px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .tab-btn {
                flex: 1 0 calc(50% - 0.4rem);
                min-width: 100px;
                font-size: 0.8rem;
            }

            .container {
                width: 95%;
            }

            .auth-container {
                padding: 1.5rem;
            }

            .tree-node {
                width: 80px;
                height: 80px;
                font-size: 0.8rem;
            }

            .stat-value {
                font-size: 1.6rem;
            }

            .level-grid {
                grid-template-columns: 1fr;
            }

            .chat-container {
                width: calc(100vw - 40px);
                height: 350px;
                right: 20px;
                left: 20px;
            }
            
            .quick-actions .btn {
                min-width: 100%;
            }
            
            .modal-content {
                padding: 1.2rem;
                width: 95%;
            }
            
            .hero-stats {
                flex-direction: column;
                gap: 1rem;
            }
            
            .stat-item {
                width: 100%;
            }
            
            .logo-large {
                font-size: 2rem;
            }
            
            .tagline {
                font-size: 1rem;
            }
            
            .mission-section,
            .features-section,
            .investment-plans-section,
            .cta-section {
                padding: 3rem 0;
            }
            
            .plans-overview {
                grid-template-columns: 1fr;
            }
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .status-active {
            background: rgba(0, 255, 157, 0.2);
            color: var(--modern-secondary);
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--modern-warning);
        }

        .status-completed {
            background: rgba(168, 85, 247, 0.2);
            color: var(--modern-accent);
        }

        /* QR Code */
        .qr-code {
            display: flex;
            justify-content: center;
            margin: 1rem 0;
        }

        .qr-code img {
            width: 180px;
            height: 180px;
            border-radius: 8px;
            border: 2px solid rgba(0, 255, 157, 0.3);
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            margin: 1.5rem 0;
        }

        /* Welcome Section */
        .dashboard-header {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(0, 255, 157, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(0, 255, 157, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-3d);
        }
        
        /* Investment Plan Inputs - FIXED */
        .plan-amount-input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid rgba(0, 255, 157, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            text-align: center;
            -moz-appearance: textfield;
        }
        
        .plan-amount-input::-webkit-outer-spin-button,
        .plan-amount-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        .plan-amount-input:focus {
            outline: none;
            border-color: var(--modern-secondary);
            box-shadow: 0 0 0 3px rgba(0, 255, 157, 0.2);
            background: rgba(255, 255, 255, 0.15);
        }
        
        /* Prevent overflow on mobile */
        html, body {
            max-width: 100%;
            overflow-x: hidden;
        }
        
        .modal-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .modal-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        
        .modal-content::-webkit-scrollbar-thumb {
            background: var(--modern-secondary);
            border-radius: 3px;
        }
        
        /* 3D Effects */
        .card-3d {
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .card-3d:hover {
            transform: rotateY(5deg) rotateX(5deg);
        }
        
        /* Glass Morphism */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Floating Animation */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .floating {
            animation: float 3s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loader"></div>
        <h2>Loading CryptoWealth Pro</h2>
        <p>Connecting to secure network...</p>
    </div>

    <!-- Header with Login/Signup Buttons -->
    <header>
        <div class="container">
            <nav class="navbar">
                <a href="#" class="logo" onclick="showHomePage()">
                    <i class="fas fa-coins"></i>
                    CryptoWealth Pro
                </a>

                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>

                <ul class="nav-links" id="navLinks">
                    <li><a href="#" onclick="scrollToSection('hero')"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#" onclick="scrollToSection('mission')"><i class="fas fa-bullseye"></i> Mission</a></li>
                    <li><a href="#" onclick="scrollToSection('features')"><i class="fas fa-star"></i> Features</a></li>
                    <li><a href="#" onclick="scrollToSection('plans')"><i class="fas fa-chart-line"></i> Investment Plans</a></li>
                    <li><a href="#" onclick="scrollToSection('cta')"><i class="fas fa-handshake"></i> Get Started</a></li>
                    <div class="auth-buttons" id="guestAuthButtons">
                        <button class="btn btn-small" onclick="openAuthModal('login')">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                        <button class="btn btn-small btn-purple" onclick="openAuthModal('signup')">
                            <i class="fas fa-user-plus"></i> Sign Up
                        </button>
                    </div>
                </ul>

                <div class="user-section" id="userSection" style="display: none;">
                    <div class="user-avatar" onclick="toggleProfileSidebar()" id="userAvatar">
                        U
                    </div>
                    <button class="btn btn-small btn-danger" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Profile Sidebar -->
    <div class="profile-sidebar" id="profileSidebar">
        <div class="profile-sidebar-header">
            <h3 style="margin: 0; font-size: 1.2rem;"><i class="fas fa-user-circle"></i> Profile</h3>
            <button class="profile-close-btn" onclick="toggleProfileSidebar()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="profile-info-card">
            <div class="profile-avatar" id="sidebarAvatar">U</div>
            <h3 id="sidebarName">User Name</h3>
            <p id="sidebarEmail" style="font-size: 0.9rem; color: #a0a0c0;">user@email.com</p>
            <div style="margin-top: 1rem;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Rank:</span>
                    <strong id="sidebarRank">Bronze</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Level:</span>
                    <strong id="sidebarLevel">1</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Referrals:</span>
                    <strong id="sidebarReferrals">0</strong>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Balance:</span>
                    <strong id="sidebarBalance">0 USDT</strong>
                </div>
            </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
            <h4 style="margin-bottom: 0.8rem; font-size: 1rem;"><i class="fas fa-wallet"></i> Wallet Info</h4>
            <div style="background: rgba(20, 20, 45, 0.5); padding: 0.8rem; border-radius: 8px; font-size: 0.85rem;">
                <div style="margin-bottom: 0.5rem;">
                    <div style="color: #a0a0c0;">Wallet Address:</div>
                    <div style="word-break: break-all; font-size: 0.8rem;" id="sidebarWallet">0x000...0000</div>
                </div>
                <div>
                    <div style="color: #a0a0c0;">Join Date:</div>
                    <div id="sidebarJoinDate">2023-01-01</div>
                </div>
            </div>
        </div>
        
        <div>
            <h4 style="margin-bottom: 0.8rem; font-size: 1rem;"><i class="fas fa-chart-line"></i> Quick Stats</h4>
            <div style="background: rgba(20, 20, 45, 0.5); padding: 0.8rem; border-radius: 8px; font-size: 0.85rem;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Total Earned:</span>
                    <strong id="sidebarTotalEarned">0 USDT</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Withdrawn:</span>
                    <strong id="sidebarWithdrawn">0 USDT</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Active Investments:</span>
                    <strong id="sidebarActiveInvestments">0</strong>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Team Size:</span>
                    <strong id="sidebarTeamSize">0</strong>
                </div>
            </div>
        </div>
        
        <button class="btn btn-purple" style="width: 100%; margin-top: 1.5rem;" onclick="switchTab('profile')">
            <i class="fas fa-user-cog"></i> Edit Profile
        </button>
    </div>

    <!-- Company Overview Page (Always Visible) -->
    <div class="company-overview" id="companyOverview">
        <!-- Hero Section -->
        <section class="hero-section" id="hero">
            <div class="container">
                <div class="hero-content">
                    <div class="logo-large">
                        <i class="fas fa-coins"></i>
                        CryptoWealth Pro
                    </div>
                    
                    <div class="tagline">
                        Advanced Crypto MLM Platform with 9-Level Team Commission & Leadership Rewards
                    </div>
                    
                    <p style="font-size: 1.2rem; margin-bottom: 2rem; color: #cbd5e1;">
                        Join thousands of investors earning daily returns of 6-7.5% with our secure USDT BEP20 investment platform. 
                        Build your team across 9 levels and claim exciting leadership rewards.
                    </p>
                    
                    <div class="hero-stats">
                        <div class="stat-item">
                            <div class="stat-number">360%</div>
                            <div class="stat-label">Total Returns</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">9</div>
                            <div class="stat-label">Commission Levels</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">6-7.5%</div>
                            <div class="stat-label">Daily Returns</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">24h</div>
                            <div class="stat-label">Withdrawal Time</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Mission Section -->
        <section class="mission-section" id="mission">
            <div class="container">
                <div class="mission-content">
                    <div class="mission-icon">
                        <i class="fas fa-bullseye"></i>
                    </div>
                    
                    <h2>Our Mission</h2>
                    
                    <div class="mission-text">
                        At CryptoWealth Pro, our mission is to democratize cryptocurrency investment opportunities 
                        through a transparent, secure, and rewarding MLM platform. We believe in creating wealth 
                        for our members while maintaining the highest standards of security and integrity.
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 3rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--modern-secondary); margin-bottom: 1rem;">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3>Security First</h3>
                            <p style="color: #a0a0c0;">USDT BEP20 transactions with advanced security protocols</p>
                        </div>
                        
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--modern-secondary); margin-bottom: 1rem;">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3>High Returns</h3>
                            <p style="color: #a0a0c0;">6-7.5% daily returns with principal included in all plans</p>
                        </div>
                        
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--modern-secondary); margin-bottom: 1rem;">
                                <i class="fas fa-users"></i>
                            </div>
                            <h3>Team Building</h3>
                            <p style="color: #a0a0c0;">Earn from 9 levels of your network with up to 8% commission</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section" id="features">
            <div class="container">
                <h2 style="text-align: center; margin-bottom: 1rem;">Why Choose CryptoWealth Pro?</h2>
                <p style="text-align: center; margin-bottom: 3rem; color: #a0a0c0; max-width: 800px; margin-left: auto; margin-right: auto;">
                    Our platform combines the best of cryptocurrency investment with multi-level marketing to create 
                    unprecedented earning opportunities for our members.
                </p>
                
                <div class="features-grid">
                    <div class="feature-card card-3d">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3 class="feature-title">High Daily Returns</h3>
                        <p class="feature-description">
                            Earn 6-7.5% daily returns on your investments with principal included. 
                            Choose from multiple plans ranging from $5 to $5000.
                        </p>
                    </div>
                    
                    <div class="feature-card card-3d">
                        <div class="feature-icon">
                            <i class="fas fa-layer-group"></i>
                        </div>
                        <h3 class="feature-title">9-Level Commission</h3>
                        <p class="feature-description">
                            Build your team and earn commissions from 9 levels. 
                            From 8% on direct referrals to 1% on level 9, maximize your earnings.
                        </p>
                    </div>
                    
                    <div class="feature-card card-3d">
                        <div class="feature-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <h3 class="feature-title">Leadership Rewards</h3>
                        <p class="feature-description">
                            Claim exciting rewards including iPhones, laptops, and luxury trips 
                            by achieving business targets and growing your team.
                        </p>
                    </div>
                    
                    <div class="feature-card card-3d">
                        <div class="feature-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <h3 class="feature-title">Fast Withdrawals</h3>
                        <p class="feature-description">
                            Withdraw your earnings within 24 hours via USDT BEP20. 
                            Low 12% withdrawal fee with transparent processing.
                        </p>
                    </div>
                    
                    <div class="feature-card card-3d">
                        <div class="feature-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <h3 class="feature-title">AI Support Bot</h3>
                        <p class="feature-description">
                            24/7 AI-powered support bot to answer all your cryptocurrency 
                            and investment questions instantly.
                        </p>
                    </div>
                    
                    <div class="feature-card card-3d">
                        <div class="feature-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <h3 class="feature-title">Mobile Friendly</h3>
                        <p class="feature-description">
                            Fully responsive design that works perfectly on all devices - 
                            desktop, tablet, and mobile phones.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Investment Plans Overview -->
        <section class="investment-plans-section" id="plans">
            <div class="container">
                <h2 style="text-align: center; margin-bottom: 1rem;">Investment Plans Overview</h2>
                <p style="text-align: center; margin-bottom: 3rem; color: #a0a0c0; max-width: 800px; margin-left: auto; margin-right: auto;">
                    Choose from our range of investment plans designed to suit every budget and investment goal. 
                    Minimum investment $5, maximum $5000.
                </p>
                
                <div class="plans-overview">
                    <div class="plan-overview-card card-3d">
                        <h3 class="plan-name">Starter Plan</h3>
                        <div style="font-size: 2rem; color: var(--modern-secondary); margin-bottom: 1rem;">6% Daily</div>
                        <ul class="plan-details">
                            <li><i class="fas fa-check"></i> Investment: $5 - $100</li>
                            <li><i class="fas fa-check"></i> Duration: 60 Days</li>
                            <li><i class="fas fa-check"></i> Total Return: 360%</li>
                            <li><i class="fas fa-check"></i> Principal Included</li>
                        </ul>
                    </div>
                    
                    <div class="plan-overview-card card-3d" style="border-color: var(--modern-accent);">
                        <h3 class="plan-name">Growth Plan</h3>
                        <div style="font-size: 2rem; color: var(--modern-accent); margin-bottom: 1rem;">6.5% Daily</div>
                        <ul class="plan-details">
                            <li><i class="fas fa-check"></i> Investment: $101 - $500</li>
                            <li><i class="fas fa-check"></i> Duration: 70 Days</li>
                            <li><i class="fas fa-check"></i> Total Return: 455%</li>
                            <li><i class="fas fa-check"></i> Principal Included</li>
                        </ul>
                    </div>
                    
                    <div class="plan-overview-card card-3d">
                        <h3 class="plan-name">Premium Plan</h3>
                        <div style="font-size: 2rem; color: var(--modern-secondary); margin-bottom: 1rem;">7% Daily</div>
                        <ul class="plan-details">
                            <li><i class="fas fa-check"></i> Investment: $501 - $1000</li>
                            <li><i class="fas fa-check"></i> Duration: 80 Days</li>
                            <li><i class="fas fa-check"></i> Total Return: 560%</li>
                            <li><i class="fas fa-check"></i> Principal Included</li>
                        </ul>
                    </div>
                    
                    <div class="plan-overview-card card-3d">
                        <h3 class="plan-name">VIP Plan</h3>
                        <div style="font-size: 2rem; color: var(--modern-secondary); margin-bottom: 1rem;">7.5% Daily</div>
                        <ul class="plan-details">
                            <li><i class="fas fa-check"></i> Investment: $1001 - $5000</li>
                            <li><i class="fas fa-check"></i> Duration: 100 Days</li>
                            <li><i class="fas fa-check"></i> Total Return: 750%</li>
                            <li><i class="fas fa-check"></i> Principal Included</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section" id="cta">
            <div class="container">
                <div class="cta-content">
                    <h2>Start Your Crypto Wealth Journey Today</h2>
                    <p style="font-size: 1.2rem; margin-bottom: 2rem; color: #cbd5e1;">
                        Join CryptoWealth Pro and unlock your financial potential. 
                        Create your account in minutes and start investing from as little as $5.
                    </p>
                    
                    <div class="cta-buttons">
                        <button class="btn btn-purple" onclick="openAuthModal('signup')" style="font-size: 1.1rem; padding: 1rem 2rem;">
                            <i class="fas fa-user-plus"></i> Create Free Account
                        </button>
                        <button class="btn" onclick="scrollToSection('features')" style="font-size: 1.1rem; padding: 1rem 2rem;">
                            <i class="fas fa-info-circle"></i> Learn More
                        </button>
                    </div>
                    
                    <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1);">
                        <p style="color: #a0a0c0; font-size: 0.9rem;">
                            <i class="fas fa-shield-alt"></i> 256-bit SSL Encryption  
                            <i class="fas fa-user-check"></i> 10,000+ Active Members  
                            <i class="fas fa-money-check-alt"></i> $2M+ Paid Out
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <div class="container">
                <div class="footer-grid">
                    <div>
                        <div class="logo">
                            <i class="fas fa-coins"></i>
                            CryptoWealth Pro
                        </div>
                        <p style="margin-top: 0.8rem; color: #a0a0c0; font-size: 0.9rem;">
                            Advanced Crypto MLM Platform with Leadership Rewards & 9-Level Team Commission
                        </p>
                    </div>
                    
                    <div>
                        <h4 style="font-size: 1rem;">Quick Links</h4>
                        <ul style="list-style: none; margin-top: 0.8rem;">
                            <li><a href="#" onclick="scrollToSection('hero')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Home</a></li>
                            <li><a href="#" onclick="scrollToSection('mission')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Mission</a></li>
                            <li><a href="#" onclick="scrollToSection('features')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Features</a></li>
                            <li><a href="#" onclick="scrollToSection('plans')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Plans</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="font-size: 1rem;">Contact</h4>
                        <p style="margin-top: 0.8rem; color: #a0a0c0; font-size: 0.9rem;">
                            <i class="fas fa-envelope"></i> support@cryptowealth.pro<br>
                            <i class="fas fa-globe"></i> cryptowealth.pro
                        </p>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1);">
                    <p style="font-size: 0.9rem;"> 2023 CryptoWealth Pro. All rights reserved.</p>
                    <p style="font-size: 0.8rem; color: #a0a0c0;">
                        Cryptocurrency investments involve risk. Please invest responsibly.
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Auth Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-container">
            <button class="close-auth-modal" onclick="closeAuthModal()">
                
            </button>
            
            <div class="auth-header">
                <div class="auth-logo">
                    <i class="fas fa-coins"></i>
                    CryptoWealth Pro
                </div>
                <p>Welcome to your financial freedom journey</p>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" data-auth-tab="login">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button class="auth-tab" data-auth-tab="signup">
                    <i class="fas fa-user-plus"></i> Sign Up
                </button>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="auth-form active">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" class="form-control" id="loginEmail" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-control" id="loginPassword" placeholder="Enter your password" required>
                </div>
                
                <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <input type="checkbox" id="rememberMe">
                        <label for="rememberMe" style="display: inline; margin-left: 5px; font-size: 0.9rem;">Remember me</label>
                    </div>
                    <a href="#" style="color: var(--modern-secondary); text-decoration: none; font-size: 0.9rem;" onclick="showForgotPassword()">Forgot Password?</a>
                </div>
                
                <button type="submit" class="btn" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i> Login to Account
                </button>
                
                <div style="text-align: center; margin-top: 1.5rem; color: #a0a0c0; font-size: 0.9rem;">
                    Don't have an account? <a href="#" style="color: var(--modern-secondary);" onclick="switchAuthTab('signup')">Sign up here</a>
                </div>
            </form>

            <!-- Signup Form -->
            <form id="signupForm" class="auth-form">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" class="form-control" id="signupName" placeholder="Enter your full name" required>
                </div>
                
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" class="form-control" id="signupEmail" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" class="form-control" id="signupPhone" placeholder="Enter your phone number" required>
                </div>
                
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-control" id="signupPassword" placeholder="Create a strong password" required>
                </div>
                
                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" class="form-control" id="signupConfirmPassword" placeholder="Confirm your password" required>
                </div>
                
                <div class="form-group">
                    <label>Referral Code (Optional)</label>
                    <input type="text" class="form-control" id="referralCode" placeholder="Enter referral code if any">
                </div>
                
                <!-- USDT BEP20 Wallet Address - Made Optional -->
                <div class="form-group">
                    <label>USDT BEP20 Wallet Address (Optional)</label>
                    <input type="text" class="form-control" id="usdtWallet" placeholder="Enter your USDT BEP20 wallet address (optional)">
                </div>
                
                <div class="form-group">
                    <input type="checkbox" id="agreeTerms" required>
                    <label for="agreeTerms" style="display: inline; margin-left: 5px; font-size: 0.9rem;">
                        I agree to the <a href="#" style="color: var(--modern-secondary);">Terms & Conditions</a>
                    </label>
                </div>
                
                <button type="submit" class="btn btn-purple" style="width: 100%;">
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
                
                <div style="text-align: center; margin-top: 1.5rem; color: #a0a0c0; font-size: 0.9rem;">
                    Already have an account? <a href="#" style="color: var(--modern-secondary);" onclick="switchAuthTab('login')">Login here</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Main App (Hidden Initially) -->
    <div class="app-container" id="appContainer">
        <!-- Dashboard Content -->
        <main class="main-content">
            <div class="container">
                <!-- Welcome Section -->
                <div class="dashboard-header">
                    <div>
                        <h1 id="welcomeMessage">Welcome to CryptoWealth Pro</h1>
                        <p id="userInfo">Loading your dashboard...</p>
                        <div class="investment-timer" id="nextEarningTimer" style="display: none;">
                            <div>Next Daily Return In:</div>
                            <div class="timer-display" id="nextEarningTime">00:00:00</div>
                        </div>
                    </div>
                    <div class="quick-actions">
                        <button class="btn btn-success" onclick="openDepositModal()">
                            <i class="fas fa-plus"></i> Deposit USDT
                        </button>
                        <button class="btn btn-warning" onclick="openWithdrawModal()">
                            <i class="fas fa-wallet"></i> Withdraw USDT
                        </button>
                        <button class="btn btn-purple" onclick="showReferralModal()">
                            <i class="fas fa-share-alt"></i> Invite & Earn
                        </button>
                        <button class="btn btn-success" onclick="claimDailyBonus()" id="dailyBonusBtn">
                            <i class="fas fa-gift"></i> Claim Daily Bonus ($0.01)
                        </button>
                    </div>
                </div>

                <!-- Dashboard Stats -->
                <div class="dashboard-grid">
                    <div class="stat-card card-3d">
                        <div class="stat-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="stat-value" id="balanceAmount">0 USDT</div>
                        <div class="stat-label">Total Balance</div>
                        <div class="stat-sub" style="font-size: 0.8rem; color: #a0a0c0;">Available for withdrawal</div>
                    </div>

                    <div class="stat-card card-3d">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-value" id="todayEarnings">+0 USDT</div>
                        <div class="stat-label">Today's Earnings</div>
                        <div class="stat-sub" style="font-size: 0.8rem; color: #a0a0c0;">Live updating</div>
                    </div>

                    <div class="stat-card card-3d">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-value" id="totalReferrals">0</div>
                        <div class="stat-label">Total Team</div>
                        <div class="stat-sub" style="font-size: 0.8rem; color: #a0a0c0;">Across 9 levels</div>
                    </div>

                    <div class="stat-card card-3d">
                        <div class="stat-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-value" id="userRank">Bronze</div>
                        <div class="stat-label">Current Rank</div>
                        <div class="stat-sub" style="font-size: 0.8rem; color: #a0a0c0;">Complete tasks to level up</div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab-btn active" data-tab="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</button>
                    <button class="tab-btn" data-tab="plans"><i class="fas fa-chart-line"></i> Investment Plans</button>
                    <button class="tab-btn" data-tab="rewards"><i class="fas fa-trophy"></i> Leadership Rewards</button>
                    <button class="tab-btn" data-tab="levels"><i class="fas fa-layer-group"></i> Team Commission</button>
                    <button class="tab-btn" data-tab="network"><i class="fas fa-network-wired"></i> Network Tree</button>
                    <button class="tab-btn" data-tab="earnings"><i class="fas fa-money-bill-wave"></i> Earnings</button>
                    <button class="tab-btn" data-tab="transactions"><i class="fas fa-exchange-alt"></i> Transactions</button>
                    <button class="tab-btn" data-tab="profile"><i class="fas fa-user-cog"></i> Profile</button>
                </div>

                <!-- Dashboard Tab -->
                <div id="dashboard" class="tab-content active">
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem;">
                        <div>
                            <h3><i class="fas fa-history"></i> Recent Activity</h3>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Activity</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="recentActivity">
                                    <tr><td colspan="4" style="text-align: center; padding: 2rem;">No recent activity</td></tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div>
                            <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                            <div style="display: flex; flex-direction: column; gap: 0.8rem; margin-top: 1rem;">
                                <button class="btn" onclick="openDepositModal()">
                                    <i class="fas fa-plus-circle"></i> Deposit USDT
                                </button>
                                <button class="btn btn-purple" onclick="showReferralModal()">
                                    <i class="fas fa-share-alt"></i> Share Referral
                                </button>
                                <button class="btn" onclick="switchTab('rewards')">
                                    <i class="fas fa-trophy"></i> Check Rewards
                                </button>
                                <button class="btn btn-success" onclick="claimDailyBonus()">
                                    <i class="fas fa-gift"></i> Claim Daily Bonus
                                </button>
                            </div>
                            
                            <h3 style="margin-top: 1.5rem;"><i class="fas fa-business-time"></i> Business Summary</h3>
                            <div style="background: rgba(0,255,157,0.1); padding: 1rem; border-radius: 8px; margin-top: 0.8rem;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span>Self Business:</span>
                                    <strong id="selfBusiness">0 USDT</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span>Team Business:</span>
                                    <strong id="teamBusiness">0 USDT</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Total Business:</span>
                                    <strong id="totalBusiness">0 USDT</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Investment Plans Tab -->
                <div id="plans" class="tab-content">
                    <h2><i class="fas fa-chart-line"></i> Investment Plans</h2>
                    <p style="margin-bottom: 1rem;">Invest in any plan with USDT BEP20. Minimum deposit: $5, Maximum: $5000</p>
                    
                    <div class="plans-container" id="plansContainer">
                        <!-- Plans will be dynamically loaded from Firebase -->
                        <div class="plan-card" style="text-align: center; padding: 3rem;">
                            <div class="loader" style="margin: 0 auto 1rem;"></div>
                            <p>Loading investment plans...</p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem;">
                        <h3><i class="fas fa-history"></i> Investment History</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Plan</th>
                                    <th>Amount</th>
                                    <th>Date</th>
                                    <th>Daily Return</th>
                                    <th>Days Left</th>
                                    <th>Total Earned</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="investmentHistory">
                                <tr><td colspan="7" style="text-align: center; padding: 2rem;">No investment history</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Leadership Rewards Tab -->
                <div id="rewards" class="tab-content">
                    <h2><i class="fas fa-trophy"></i> Leadership Performance Rewards</h2>
                    <p style="margin-bottom: 1rem;">Achieve business targets and claim exciting rewards! Minimum deposit $50 required. Business counted from multiple IDs only.</p>
                    
                    <div class="rewards-container" id="rewardsContainer">
                        <!-- Rewards will be dynamically loaded from Firebase -->
                        <div class="reward-card" style="text-align: center; padding: 3rem;">
                            <div class="loader" style="margin: 0 auto 1rem;"></div>
                            <p>Loading leadership rewards...</p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem;">
                        <h3><i class="fas fa-award"></i> Claimed Rewards</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Reward</th>
                                    <th>Requirements</th>
                                    <th>Claim Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="claimedRewards">
                                <tr><td colspan="4" style="text-align: center; padding: 2rem;">No rewards claimed yet</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 9-Level Commission Tab -->
                <div id="levels" class="tab-content">
                    <h2><i class="fas fa-layer-group"></i> Team Commission</h2>
                    <p style="margin-bottom: 1rem;">Earn from 9 levels of your team with our unique commission structure</p>
                    
                    <div class="level-grid">
                        <!-- Levels will be dynamically populated -->
                        <div class="level-card card-3d">
                            <div class="level-number">Level 1</div>
                            <div class="stat-value" id="level1Percent">8%</div>
                            <div class="stat-label">Direct Referrals</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level1Count">0</strong></div>
                                <div>Earnings: <strong id="level1Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card card-3d">
                            <div class="level-number">Level 2</div>
                            <div class="stat-value" id="level2Percent">6%</div>
                            <div class="stat-label">Second Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level2Count">0</strong></div>
                                <div>Earnings: <strong id="level2Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card card-3d">
                            <div class="level-number">Level 3</div>
                            <div class="stat-value" id="level3Percent">5%</div>
                            <div class="stat-label">Third Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level3Count">0</strong></div>
                                <div>Earnings: <strong id="level3Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card card-3d">
                            <div class="level-number">Level 4</div>
                            <div class="stat-value" id="level4Percent">4%</div>
                            <div class="stat-label">Fourth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level4Count">0</strong></div>
                                <div>Earnings: <strong id="level4Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card card-3d">
                            <div class="level-number">Level 5</div>
                            <div class="stat-value" id="level5Percent">3%</div>
                            <div class="stat-label">Fifth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level5Count">0</strong></div>
                                <div>Earnings: <strong id="level5Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card card-3d">
                            <div class="level-number">Level 6</div>
                            <div class="stat-value" id="level6Percent">2%</div>
                            <div class="stat-label">Sixth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level6Count">0</strong></div>
                                <div>Earnings: <strong id="level6Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card card-3d">
                            <div class="level-number">Level 7</div>
                            <div class="stat-value" id="level7Percent">2%</div>
                            <div class="stat-label">Seventh Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level7Count">0</strong></div>
                                <div>Earnings: <strong id="level7Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card card-3d">
                            <div class="level-number">Level 8</div>
                            <div class="stat-value" id="level8Percent">1%</div>
                            <div class="stat-label">Eighth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level8Count">0</strong></div>
                                <div>Earnings: <strong id="level8Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                        
                        <div class="level-card card-3d">
                            <div class="level-number">Level 9</div>
                            <div class="stat-value" id="level9Percent">1%</div>
                            <div class="stat-label">Ninth Level</div>
                            <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                <div>Members: <strong id="level9Count">0</strong></div>
                                <div>Earnings: <strong id="level9Earnings">0 USDT</strong></div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem; padding: 1.2rem; background: rgba(0,255,157,0.1); border-radius: 10px;">
                        <h3><i class="fas fa-calculator"></i> Total Team Commission</h3>
                        <div class="stat-value" id="totalTeamCommission">0 USDT</div>
                        <div class="stat-label">Total earnings from all 9 levels</div>
                    </div>
                </div>

                <!-- Network Tab -->
                <div id="network" class="tab-content">
                    <h2><i class="fas fa-network-wired"></i> Your Network Tree</h2>
                    
                    <div class="network-tree" id="networkTree">
                        <div class="tree-level">
                            <div class="tree-node you">
                                YOU
                                <div class="node-info">You</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <h3><i class="fas fa-info-circle"></i> Network Statistics</h3>
                        <div class="dashboard-grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));">
                            <div class="stat-card card-3d">
                                <div class="stat-value" id="totalDownline">0</div>
                                <div class="stat-label">Total Downline</div>
                            </div>
                            <div class="stat-card card-3d">
                                <div class="stat-value" id="activeDownline">0</div>
                                <div class="stat-label">Active Members</div>
                            </div>
                            <div class="stat-card card-3d">
                                <div class="stat-value" id="totalTeams">0</div>
                                <div class="stat-label">Teams</div>
                            </div>
                            <div class="stat-card card-3d">
                                <div class="stat-value" id="networkGrowth">0%</div>
                                <div class="stat-label">Monthly Growth</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Earnings Tab -->
                <div id="earnings" class="tab-content">
                    <h2><i class="fas fa-money-bill-wave"></i> Earnings Report</h2>
                    
                    <div class="dashboard-grid" style="grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));">
                        <div class="stat-card card-3d">
                            <div class="stat-value" id="totalEarningsAmount">0 USDT</div>
                            <div class="stat-label">Total Earnings</div>
                        </div>
                        <div class="stat-card card-3d">
                            <div class="stat-value" id="withdrawnAmount">0 USDT</div>
                            <div class="stat-label">Withdrawn</div>
                        </div>
                        <div class="stat-card card-3d">
                            <div class="stat-value" id="availableEarnings">0 USDT</div>
                            <div class="stat-label">Available</div>
                        </div>
                        <div class="stat-card card-3d">
                            <div class="stat-value" id="pendingEarnings">0 USDT</div>
                            <div class="stat-label">Pending</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 1.5rem;"><i class="fas fa-chart-bar"></i> Earning Sources</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Source</th>
                                <th>Amount</th>
                                <th>Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="earningsTable">
                            <tr><td colspan="4" style="text-align: center; padding: 2rem;">No earnings yet</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Transactions Tab -->
                <div id="transactions" class="tab-content">
                    <h2><i class="fas fa-exchange-alt"></i> Transaction History</h2>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem;">
                        <div>
                            <h3><i class="fas fa-arrow-down"></i> Deposits</h3>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Amount</th>
                                        <th>Method</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="depositsTable">
                                    <tr><td colspan="4" style="text-align: center; padding: 2rem;">No deposits yet</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div>
                            <h3><i class="fas fa-arrow-up"></i> Withdrawals</h3>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Amount</th>
                                        <th>Net Amount</th>
                                        <th>Fee (12%)</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="withdrawalsTable">
                                    <tr><td colspan="5" style="text-align: center; padding: 2rem;">No withdrawals yet</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Profile Tab -->
                <div id="profile" class="tab-content">
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 1.5rem;">
                        <div>
                            <div class="stat-card card-3d" style="text-align: center;">
                                <div class="user-avatar" style="width: 80px; height: 80px; margin: 0 auto 0.8rem; font-size: 1.8rem;">
                                    <span id="profileAvatar">U</span>
                                </div>
                                <h3 id="profileName">User Name</h3>
                                <p id="profileEmail" style="font-size: 0.9rem;">user@email.com</p>
                                <div style="margin: 0.8rem 0; font-size: 0.9rem;">
                                    <p>Member ID: <strong id="userId">USER001</strong></p>
                                    <p>Join Date: <strong id="joinDate">2023-11-01</strong></p>
                                    <p>Referral Code: <strong id="userReferralCode">ABC123</strong></p>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3><i class="fas fa-user-cog"></i> Account Settings</h3>
                            <div class="form-group">
                                <label>Full Name</label>
                                <input type="text" class="form-control" id="settingsName">
                            </div>
                            <div class="form-group">
                                <label>Email Address</label>
                                <input type="email" class="form-control" id="settingsEmail">
                            </div>
                            <div class="form-group">
                                <label>Phone Number</label>
                                <input type="tel" class="form-control" id="settingsPhone">
                            </div>
                            <div class="form-group">
                                <label>USDT BEP20 Wallet Address</label>
                                <input type="text" class="form-control" id="walletAddress" placeholder="Enter your USDT BEP20 wallet address">
                            </div>
                            <button class="btn" onclick="updateProfile()">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- All Modals -->
        <!-- Deposit Modal -->
        <div class="modal" id="depositModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closeDepositModal()">
                    
                </button>
                
                <h2><i class="fas fa-plus-circle"></i> Deposit USDT</h2>
                <p style="margin-bottom: 1rem;">Deposit USDT via BEP20 network only. Minimum: $5, Maximum: $5000</p>
                
                <div class="form-group">
                    <label>Amount (USDT)</label>
                    <input type="number" class="form-control" id="depositAmount" placeholder="5" min="5" max="5000" step="1">
                    <small style="color: #a0a0c0; font-size: 0.85rem;">Minimum $5, Maximum $5000</small>
                </div>
                
                <div class="qr-code">
                    <img src="" alt="USDT Deposit QR Code" id="depositQRCode">
                </div>
                
                <div class="form-group">
                    <label>USDT BEP20 Wallet Address</label>
                    <input type="text" class="form-control" id="depositAddress" value="" readonly>
                </div>
                
                <div style="background: rgba(0,255,157,0.1); padding: 0.8rem; border-radius: 8px; margin-top: 1rem; font-size: 0.9rem;">
                    <p><i class="fas fa-info-circle"></i> Important Instructions:</p>
                    <ol style="margin-left: 1.2rem; margin-top: 0.5rem;">
                        <li>Send USDT via BEP20 network only</li>
                        <li>Minimum deposit: <span id="minDepositAmount">5</span> USDT</li>
                        <li>Maximum deposit: <span id="maxDepositAmount">5000</span> USDT</li>
                        <li>Deposit will be credited within 5 minutes</li>
                        <li>Contact support if deposit not credited within 30 minutes</li>
                    </ol>
                </div>
                
                <div style="display: flex; gap: 0.8rem; margin-top: 1.2rem;">
                    <button class="btn" onclick="closeDepositModal()" style="flex: 1;">
                        <i class="fas fa-times"></i> Close
                    </button>
                    <button class="btn btn-success" style="flex: 2;" onclick="processDeposit()">
                        <i class="fas fa-paper-plane"></i> Confirm Deposit Request
                    </button>
                </div>
            </div>
        </div>

        <!-- Withdraw Modal -->
        <div class="modal" id="withdrawModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closeWithdrawModal()">
                    
                </button>
                
                <h2><i class="fas fa-wallet"></i> Withdraw USDT</h2>
                
                <div style="background: rgba(0,255,157,0.1); padding: 0.8rem; border-radius: 8px; margin-bottom: 1.2rem; font-size: 0.9rem;">
                    <p><i class="fas fa-info-circle"></i> Available Balance: <strong id="availableBalance">0 USDT</strong></p>
                    <p>Minimum Withdrawal: <strong>1 USDT</strong></p>
                    <p>Withdrawal Fee: <strong id="withdrawalFeePercent">12%</strong></p>
                    <p>Processing Time: <strong>1-24 hours</strong></p>
                    <p>Network: <strong>BEP20 Only</strong></p>
                </div>
                
                <div class="form-group">
                    <label>Amount (USDT)</label>
                    <input type="number" class="form-control" id="withdrawAmount" placeholder="1" min="1">
                    <small style="color: #a0a0c0; font-size: 0.85rem;">Minimum withdrawal: 1 USDT</small>
                </div>
                
                <div class="form-group">
                    <label>Withdrawal Fee (<span id="feePercent">12</span>%)</label>
                    <input type="text" class="form-control" id="withdrawalFee" value="0" readonly>
                </div>
                
                <div class="form-group">
                    <label>Net Amount (You Receive)</label>
                    <input type="text" class="form-control" id="netAmount" value="0" readonly>
                </div>
                
                <div class="form-group">
                    <label>USDT BEP20 Wallet Address</label>
                    <input type="text" class="form-control" id="withdrawAddress" placeholder="Enter your USDT BEP20 wallet address">
                </div>
                
                <div style="display: flex; gap: 0.8rem; margin-top: 1.2rem;">
                    <button class="btn" onclick="closeWithdrawModal()" style="flex: 1;">
                        <i class="fas fa-times"></i> Close
                    </button>
                    <button class="btn btn-warning" style="flex: 2;" onclick="processWithdrawal()">
                        <i class="fas fa-paper-plane"></i> Request Withdrawal
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Panel Modal -->
        <div class="modal admin-modal" id="adminModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closeAdminModal()">
                    
                </button>
                
                <h2><i class="fas fa-user-shield"></i> Admin Control Panel</h2>
                
                <div class="admin-tabs">
                    <button class="admin-tab-btn active" data-admin-tab="settings">System Settings</button>
                    <button class="admin-tab-btn" data-admin-tab="plans">Investment Plans</button>
                    <button class="admin-tab-btn" data-admin-tab="rewards">Leadership Rewards</button>
                    <button class="admin-tab-btn" data-admin-tab="commission">Commission Rates</button>
                    <button class="admin-tab-btn" data-admin-tab="deposits">Deposit Requests</button>
                    <button class="admin-tab-btn" data-admin-tab="withdrawals">Withdrawal Requests</button>
                    <button class="admin-tab-btn" data-admin-tab="users">User Management</button>
                </div>

                <!-- System Settings Tab -->
                <div id="adminSettings" class="admin-tab-content active">
                    <h3>System Settings</h3>
                    
                    <div class="form-group">
                        <label>Deposit Wallet Address</label>
                        <input type="text" class="form-control" id="adminDepositWallet" placeholder="Enter USDT BEP20 wallet address">
                    </div>
                    
                    <div class="form-group">
                        <label>Minimum Deposit (USDT)</label>
                        <input type="number" class="form-control" id="adminMinDeposit" placeholder="5" min="5">
                    </div>
                    
                    <div class="form-group">
                        <label>Maximum Deposit (USDT)</label>
                        <input type="number" class="form-control" id="adminMaxDeposit" placeholder="5000" min="5">
                    </div>
                    
                    <div class="form-group">
                        <label>Withdrawal Fee (%)</label>
                        <input type="number" class="form-control" id="adminWithdrawalFee" placeholder="12" min="0" max="100" step="0.1">
                    </div>
                    
                    <div class="form-group">
                        <label>Daily Bonus Amount (USDT)</label>
                        <input type="number" class="form-control" id="adminDailyBonus" placeholder="0.01" min="0" step="0.01">
                    </div>
                    
                    <button class="btn btn-success" onclick="updateSystemSettings()">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                </div>

                <!-- Investment Plans Tab -->
                <div id="adminPlans" class="admin-tab-content">
                    <h3>Manage Investment Plans</h3>
                    
                    <div id="adminPlansContainer">
                        <!-- Plans will be loaded here -->
                    </div>
                    
                    <button class="btn btn-purple" onclick="addNewPlan()" style="margin-top: 1rem;">
                        <i class="fas fa-plus"></i> Add New Plan
                    </button>
                </div>

                <!-- Leadership Rewards Tab -->
                <div id="adminRewards" class="admin-tab-content">
                    <h3>Manage Leadership Rewards</h3>
                    
                    <div id="adminRewardsContainer">
                        <!-- Rewards will be loaded here -->
                    </div>
                    
                    <button class="btn btn-purple" onclick="addNewReward()" style="margin-top: 1rem;">
                        <i class="fas fa-plus"></i> Add New Reward
                    </button>
                </div>

                <!-- Commission Rates Tab -->
                <div id="adminCommission" class="admin-tab-content">
                    <h3>Commission Rates</h3>
                    
                    <div class="level-grid">
                        <div class="level-card">
                            <div class="level-number">Level 1</div>
                            <input type="number" class="form-control" id="adminLevel1" placeholder="8" min="0" max="100" step="0.1">
                            <div class="stat-label">Direct Referrals</div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 2</div>
                            <input type="number" class="form-control" id="adminLevel2" placeholder="6" min="0" max="100" step="0.1">
                            <div class="stat-label">Second Level</div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 3</div>
                            <input type="number" class="form-control" id="adminLevel3" placeholder="5" min="0" max="100" step="0.1">
                            <div class="stat-label">Third Level</div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 4</div>
                            <input type="number" class="form-control" id="adminLevel4" placeholder="4" min="0" max="100" step="0.1">
                            <div class="stat-label">Fourth Level</div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 5</div>
                            <input type="number" class="form-control" id="adminLevel5" placeholder="3" min="0" max="100" step="0.1">
                            <div class="stat-label">Fifth Level</div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 6</div>
                            <input type="number" class="form-control" id="adminLevel6" placeholder="2" min="0" max="100" step="0.1">
                            <div class="stat-label">Sixth Level</div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 7</div>
                            <input type="number" class="form-control" id="adminLevel7" placeholder="2" min="0" max="100" step="0.1">
                            <div class="stat-label">Seventh Level</div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 8</div>
                            <input type="number" class="form-control" id="adminLevel8" placeholder="1" min="0" max="100" step="0.1">
                            <div class="stat-label">Eighth Level</div>
                        </div>
                        
                        <div class="level-card">
                            <div class="level-number">Level 9</div>
                            <input type="number" class="form-control" id="adminLevel9" placeholder="1" min="0" max="100" step="0.1">
                            <div class="stat-label">Ninth Level</div>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="updateCommissionRates()" style="margin-top: 1rem;">
                        <i class="fas fa-save"></i> Update Commission Rates
                    </button>
                </div>

                <!-- Deposit Requests Tab -->
                <div id="adminDeposits" class="admin-tab-content">
                    <h3>Deposit Requests</h3>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Amount</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="adminDepositsTable">
                            <tr><td colspan="5" style="text-align: center; padding: 2rem;">No deposit requests</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Withdrawal Requests Tab -->
                <div id="adminWithdrawals" class="admin-tab-content">
                    <h3>Withdrawal Requests</h3>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Amount</th>
                                <th>Wallet</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="adminWithdrawalsTable">
                            <tr><td colspan="6" style="text-align: center; padding: 2rem;">No withdrawal requests</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- User Management Tab -->
                <div id="adminUsers" class="admin-tab-content">
                    <h3>User Management</h3>
                    
                    <div class="form-group">
                        <input type="text" class="form-control" id="adminSearchUser" placeholder="Search by email, name or user ID">
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Balance</th>
                                <th>Referrals</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="adminUsersTable">
                            <tr><td colspan="6" style="text-align: center; padding: 2rem;">No users found</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Support Chat -->
        <div class="chat-container" id="chatContainer">
            <div class="chat-header">
                <h3 style="margin: 0; font-size: 1rem;"><i class="fas fa-comments"></i> Support Chat</h3>
                <button class="btn btn-small" onclick="hideChat()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message bot">
                    <strong>Support Bot:</strong> Welcome to Support Chat! How can I help you today?
                </div>
            </div>
            
            <div class="chat-input">
                <input type="text" id="chatInput" placeholder="Type your message...">
                <button class="btn" onclick="sendChatMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>

        <!-- Marketplace Button -->
        <div class="marketplace-button" onclick="showCryptoBot()">
            <i class="fas fa-robot"></i>
        </div>

        <!-- Admin Panel Button -->
        <div class="admin-panel-btn" onclick="openAdminPanel()">
            <i class="fas fa-user-shield"></i>
        </div>

        <!-- Crypto Bot Modal -->
        <div class="crypto-bot-modal" id="cryptoBotModal">
            <div class="bot-header">
                <h3 style="margin: 0; font-size: 1rem;"><i class="fas fa-robot"></i> Crypto Currency Chat Bot</h3>
                <button class="btn btn-small" onclick="hideCryptoBot()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="bot-content">
                <div class="bot-message">
                    <strong>Crypto Bot:</strong> Welcome! I'm your AI cryptocurrency assistant. How can I help you today?
                </div>
                
                <div class="bot-options">
                    <div class="bot-option" onclick="askBotQuestion('bitcoin')">
                        <i class="fab fa-bitcoin"></i>
                        <div>Bitcoin Info</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('ethereum')">
                        <i class="fab fa-ethereum"></i>
                        <div>Ethereum Info</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('usdt')">
                        <i class="fas fa-coins"></i>
                        <div>USDT Guide</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('investment')">
                        <i class="fas fa-chart-line"></i>
                        <div>Investment Tips</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('security')">
                        <i class="fas fa-shield-alt"></i>
                        <div>Security Tips</div>
                    </div>
                    <div class="bot-option" onclick="askBotQuestion('withdrawal')">
                        <i class="fas fa-wallet"></i>
                        <div>Withdrawal Help</div>
                    </div>
                </div>
                
                <div style="margin-top: 1.2rem;">
                    <input type="text" class="form-control" id="botQuestion" placeholder="Ask me anything about crypto..." onkeypress="if(event.key==='Enter') askCustomQuestion()">
                    <button class="btn" style="width: 100%; margin-top: 0.5rem;" onclick="askCustomQuestion()">
                        <i class="fas fa-paper-plane"></i> Ask Question
                    </button>
                </div>
            </div>
        </div>

        <!-- Referral Modal -->
        <div class="referral-modal" id="referralModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closeReferralModal()">
                    
                </button>
                
                <h2><i class="fas fa-share-alt"></i> Invite & Earn</h2>
                <p style="margin-bottom: 1rem;">Share your referral link and earn commissions from 9 levels!</p>
                
                <div class="referral-link-container">
                    <div class="referral-link" id="referralLinkText">https://cryptowealth.pro/ref/ABC123</div>
                    <button class="btn btn-small" onclick="copyReferralLink()" id="copyBtn">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
                
                <div style="background: rgba(0,255,157,0.1); padding: 0.8rem; border-radius: 8px; margin-top: 0.8rem; font-size: 0.9rem;">
                    <h4 style="margin-bottom: 0.5rem;"><i class="fas fa-money-bill-wave"></i> Commission Structure</h4>
                    <ul style="margin-left: 1.2rem; margin-top: 0.5rem;">
                        <li>Level 1 (Direct Referrals): <strong id="level1PercentText">8%</strong></li>
                        <li>Level 2: <strong id="level2PercentText">6%</strong></li>
                        <li>Level 3: <strong id="level3PercentText">5%</strong></li>
                        <li>Level 4: <strong id="level4PercentText">4%</strong></li>
                        <li>Level 5: <strong id="level5PercentText">3%</strong></li>
                        <li>Level 6: <strong id="level6PercentText">2%</strong></li>
                        <li>Level 7: <strong id="level7PercentText">2%</strong></li>
                        <li>Level 8: <strong id="level8PercentText">1%</strong></li>
                        <li>Level 9: <strong id="level9PercentText">1%</strong></li>
                    </ul>
                </div>
                
                <div style="background: rgba(168,85,247,0.1); padding: 0.8rem; border-radius: 8px; margin-top: 0.8rem;">
                    <h4 style="margin-bottom: 0.5rem; font-size: 1rem;"><i class="fas fa-bullhorn"></i> Share Your Link</h4>
                    <div style="display: flex; gap: 0.4rem; margin-top: 0.5rem;">
                        <button class="btn btn-small" style="flex: 1;" onclick="shareOnFacebook()">
                            <i class="fab fa-facebook"></i> Facebook
                        </button>
                        <button class="btn btn-small" style="flex: 1;" onclick="shareOnWhatsApp()">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </button>
                        <button class="btn btn-small" style="flex: 1;" onclick="shareOnTelegram()">
                            <i class="fab fa-telegram"></i> Telegram
                        </button>
                    </div>
                </div>
                
                <button class="btn btn-purple" style="width: 100%; margin-top: 1.2rem;" onclick="closeReferralModal()">
                    <i class="fas fa-check"></i> Done
                </button>
            </div>
        </div>

        <!-- Footer for App -->
        <footer>
            <div class="container">
                <div class="footer-grid">
                    <div>
                        <div class="logo">
                            <i class="fas fa-coins"></i>
                            CryptoWealth Pro
                        </div>
                        <p style="margin-top: 0.8rem; color: #a0a0c0; font-size: 0.9rem;">Advanced Crypto MLM Platform with Leadership Rewards & 9-Level Team Commission</p>
                    </div>
                    
                    <div>
                        <h4 style="font-size: 1rem;">Quick Links</h4>
                        <ul style="list-style: none; margin-top: 0.8rem;">
                            <li><a href="#" onclick="switchTab('dashboard')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Dashboard</a></li>
                            <li><a href="#" onclick="switchTab('plans')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Investment Plans</a></li>
                            <li><a href="#" onclick="switchTab('rewards')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Leadership Rewards</a></li>
                            <li><a href="#" onclick="switchTab('network')" style="color: #a0a0c0; text-decoration: none; font-size: 0.9rem;">Network</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="font-size: 1rem;">Contact</h4>
                        <p style="margin-top: 0.8rem; color: #a0a0c0; font-size: 0.9rem;">
                            <i class="fas fa-envelope"></i> support@cryptowealth.pro<br>
                            <i class="fas fa-globe"></i> cryptowealth.pro
                        </p>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1);">
                    <p style="font-size: 0.9rem;"> 2023 CryptoWealth Pro. All rights reserved.</p>
                    <p style="font-size: 0.8rem; color: #a0a0c0;">Cryptocurrency investments involve risk. Please invest responsibly.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- JavaScript -->
    <script>
        // ====================
        // FIREBASE CONFIGURATION
        // ====================
        const firebaseConfig = {
            apiKey: "AIzaSyB6vD81slzYeX4RrV-9Xn4agsEyo9eNWNE",
            authDomain: "fir-85dcd.firebaseapp.com",
            databaseURL: "https://fir-85dcd-default-rtdb.firebaseio.com",
            projectId: "fir-85dcd",
            storageBucket: "fir-85dcd.firebasestorage.app",
            messagingSenderId: "789997788238",
            appId: "1:789997788238:web:8c2e4fe48e12f6b8a5b71f"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // ====================
        // APPLICATION STATE
        // ====================
        let currentUser = null;
        let userData = null;
        let investmentPlans = {};
        let leadershipRewards = {};
        let commissionLevels = {};
        let publicSettings = {};
        let depositAddress = "";
        let investmentIntervals = {};
        let profileSidebarOpen = false;
        let userInvestedPlans = new Set(); // Track which plans user has already invested in
        let nextEarningTime = null;
        let earningTimerInterval = null;

        // ====================
        // INITIALIZATION
        // ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Hide loading screen after 2 seconds
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
                
                // Load public settings first
                loadPublicSettings();
                
                // Check auth state
                auth.onAuthStateChanged((user) => {
                    if (user) {
                        // User is signed in
                        currentUser = user;
                        loadUserData();
                        showApp();
                        // Setup plan calculators
                        setupPlanCalculators();
                        // Setup withdrawal calculator
                        setupWithdrawalCalculator();
                        // Update UI for logged in user
                        updateAuthUI(true);
                    } else {
                        // User is signed out
                        showCompanyOverview();
                        updateAuthUI(false);
                    }
                });
            }, 2000);

            // Setup event listeners
            setupEventListeners();
            
            // Prevent overflow issues
            preventOverflow();
        });

        // ====================
        // LOAD PUBLIC SETTINGS FROM FIREBASE
        // ====================
        function loadPublicSettings() {
            // Load public settings
            database.ref('publicSettings').on('value', (snapshot) => {
                const settings = snapshot.val();
                if (settings) {
                    publicSettings = settings;
                    
                    // Update deposit address
                    depositAddress = settings.depositWallet || "0x0000000000000000000000000000000000000000";
                    document.getElementById('depositAddress').value = depositAddress;
                    
                    // Update QR code
                    const qrImg = document.getElementById('depositQRCode');
                    if (qrImg && depositAddress) {
                        qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(depositAddress)}`;
                    }
                    
                    // Update other settings with minimum $5
                    if (settings.minDeposit) {
                        const minDeposit = Math.max(5, settings.minDeposit);
                        document.getElementById('minDepositAmount').textContent = minDeposit;
                    } else {
                        document.getElementById('minDepositAmount').textContent = '5';
                    }
                    
                    if (settings.maxDeposit) {
                        document.getElementById('maxDepositAmount').textContent = settings.maxDeposit;
                    }
                    if (settings.withdrawalFee) {
                        document.getElementById('withdrawalFeePercent').textContent = settings.withdrawalFee + "%";
                        document.getElementById('feePercent').textContent = settings.withdrawalFee;
                    }
                    
                    // Update deposit form limits with minimum $5
                    const depositInput = document.getElementById('depositAmount');
                    if (depositInput) {
                        const minDeposit = Math.max(5, settings.minDeposit || 5);
                        depositInput.min = minDeposit;
                        depositInput.max = settings.maxDeposit || 5000;
                        depositInput.placeholder = minDeposit;
                        depositInput.value = minDeposit;
                    }
                } else {
                    // Set default values with minimum $5
                    const minDeposit = 5;
                    document.getElementById('minDepositAmount').textContent = minDeposit;
                    document.getElementById('maxDepositAmount').textContent = '5000';
                    
                    const depositInput = document.getElementById('depositAmount');
                    if (depositInput) {
                        depositInput.min = minDeposit;
                        depositInput.max = 5000;
                        depositInput.placeholder = minDeposit;
                        depositInput.value = minDeposit;
                    }
                }
            });
            
            // Load investment plans from Firebase
            database.ref('public/plans').on('value', (snapshot) => {
                const plans = snapshot.val() || {};
                investmentPlans = {};
                
                Object.entries(plans).forEach(([id, plan]) => {
                    if (plan.status === 'active') {
                        investmentPlans[id] = {
                            min: plan.min || 5,
                            max: plan.max || 5000,
                            dailyReturn: plan.dailyReturn || 5,
                            days: plan.days || 60,
                            name: plan.name || 'Plan ' + id,
                            principalIncluded: plan.principal !== false
                        };
                    }
                });
                
                // If no plans in Firebase, use default plans with minimum $5
                if (Object.keys(investmentPlans).length === 0) {
                    investmentPlans = {
                        1: { min: 5, max: 100, dailyReturn: 6, days: 60, name: "Starter Plan", principalIncluded: true },
                        2: { min: 101, max: 500, dailyReturn: 6.5, days: 70, name: "Growth Plan", principalIncluded: true },
                        3: { min: 501, max: 1000, dailyReturn: 7, days: 80, name: "Premium Plan", principalIncluded: true },
                        4: { min: 1001, max: 5000, dailyReturn: 7.5, days: 100, name: "VIP Plan", principalIncluded: true }
                    };
                }
                
                // Update plans display if on plans page
                if (document.getElementById('plans').classList.contains('active')) {
                    updatePlansDisplay();
                }
            });
            
            // Load leadership rewards from Firebase
            database.ref('public/rewards').on('value', (snapshot) => {
                const rewards = snapshot.val() || {};
                leadershipRewards = {};
                
                Object.entries(rewards).forEach(([id, reward]) => {
                    if (reward.status === 'active') {
                        leadershipRewards[id] = {
                            name: reward.name,
                            selfBusiness: reward.selfBusiness || 0,
                            teamBusiness: reward.teamBusiness || 0,
                            type: reward.type || 'gadget'
                        };
                    }
                });
                
                // If no rewards in Firebase, use default rewards
                if (Object.keys(leadershipRewards).length === 0) {
                    leadershipRewards = {
                        1: { name: "iPhone 17 Pro Max", selfBusiness: 1000, teamBusiness: 3500, type: "gadget" },
                        2: { name: "Apple Laptop", selfBusiness: 750, teamBusiness: 3000, type: "gadget" },
                        3: { name: "Goa Trip", selfBusiness: 500, teamBusiness: 2500, type: "travel" },
                        4: { name: "Thailand Trip", selfBusiness: 1500, teamBusiness: 5000, type: "travel" }
                    };
                }
                
                // Update rewards display if on rewards page
                if (document.getElementById('rewards').classList.contains('active')) {
                    updateRewardsDisplay();
                }
            });
            
            // Load commission settings from Firebase
            database.ref('public/commissionSettings').on('value', (snapshot) => {
                const settings = snapshot.val() || {};
                commissionLevels = {};
                
                for (let i = 1; i <= 9; i++) {
                    commissionLevels[i] = settings[`level${i}`] || 
                        (i === 1 ? 8 : 
                         i === 2 ? 6 : 
                         i === 3 ? 5 : 
                         i === 4 ? 4 : 
                         i === 5 ? 3 : 
                         i === 6 ? 2 : 
                         i === 7 ? 2 : 
                         i === 8 ? 1 : 1);
                }
                
                // Update commission display
                updateCommissionDisplay();
            });
        }

        // ====================
        // UPDATE DISPLAY FUNCTIONS
        // ====================
        function updatePlansDisplay() {
            const plansContainer = document.getElementById('plansContainer');
            if (!plansContainer) return;
            
            plansContainer.innerHTML = '';
            
            if (Object.keys(investmentPlans).length === 0) {
                plansContainer.innerHTML = `
                    <div class="plan-card" style="text-align: center; padding: 3rem;">
                        <i class="fas fa-chart-line" style="font-size: 3rem; color: var(--modern-accent); margin-bottom: 1rem;"></i>
                        <h3>No Active Plans</h3>
                        <p>There are currently no active investment plans. Please check back later.</p>
                    </div>
                `;
                return;
            }
            
            // Get user's invested plans
            const investedPlanIds = userData ? 
                (userData.activeInvestments || []).map(inv => inv.planId) : [];
            userInvestedPlans = new Set(investedPlanIds);
            
            // Sort plans by minimum investment (left to right)
            const sortedPlans = Object.entries(investmentPlans).sort((a, b) => a[1].min - b[1].min);
            
            sortedPlans.forEach(([id, plan]) => {
                const planCard = document.createElement('div');
                planCard.className = 'plan-card card-3d';
                
                const isInvested = userInvestedPlans.has(id);
                if (isInvested) {
                    planCard.classList.add('already-invested');
                }
                
                // Check if this is the popular plan (based on daily return)
                const isPopular = plan.dailyReturn >= 7;
                if (isPopular && !isInvested) {
                    planCard.classList.add('popular');
                }
                
                planCard.innerHTML = `
                    ${isInvested ? '<div class="already-invested-badge">Already Invested</div>' : ''}
                    <div class="plan-icon"><i class="fas fa-chart-line"></i></div>
                    <h3>${plan.name}</h3>
                    <div class="stat-value">${plan.dailyReturn}% Daily</div>
                    <div class="stat-label">For ${plan.days} Days</div>
                    <div style="margin: 1.2rem 0; text-align: left; font-size: 0.9rem;">
                        <div><i class="fas fa-check" style="color: var(--modern-secondary);"></i> Investment: $${plan.min} - $${plan.max}</div>
                        <div><i class="fas fa-check" style="color: var(--modern-secondary);"></i> Daily Return: ${plan.dailyReturn}%</div>
                        <div><i class="fas fa-check" style="color: var(--modern-secondary);"></i> Duration: ${plan.days} Days</div>
                        <div><i class="fas fa-check" style="color: var(--modern-secondary);"></i> Total Return: ${(plan.dailyReturn * plan.days).toFixed(0)}%</div>
                        <div><i class="fas fa-check" style="color: var(--modern-secondary);"></i> ${plan.principalIncluded ? 'Principal Included' : 'Principal Not Included'}</div>
                    </div>
                    
                    ${!isInvested ? `
                    <div class="form-group">
                        <label>Investment Amount ($)</label>
                        <input type="number" class="form-control plan-amount-input" id="plan${id}Amount" 
                               placeholder="Enter amount (${plan.min}-${plan.max})" min="${plan.min}" max="${plan.max}" 
                               value="" step="1" oninput="updatePlanCalculator('${id}')">
                    </div>
                    
                    <div style="margin: 1rem 0; padding: 0.8rem; background: rgba(0,255,157,0.1); border-radius: 8px;">
                        <div>Daily Earning: <strong id="plan${id}Daily">$0.00</strong></div>
                        <div>Total Return: <strong id="plan${id}Total">$0.00</strong></div>
                    </div>
                    
                    <button class="btn btn-success" style="width: 100%;" onclick="investInPlan('${id}')">
                        <i class="fas fa-hand-holding-usd"></i> Invest Now
                    </button>
                    ` : `
                    <div style="margin: 1rem 0; padding: 0.8rem; background: rgba(239,68,68,0.1); border-radius: 8px;">
                        <div><i class="fas fa-info-circle"></i> You have already invested in this plan</div>
                        <div>You cannot invest in the same plan multiple times</div>
                    </div>
                    
                    <button class="btn" style="width: 100%;" disabled>
                        <i class="fas fa-check"></i> Already Invested
                    </button>
                    `}
                `;
                
                plansContainer.appendChild(planCard);
                
                // Initialize calculator for this plan
                if (!isInvested) {
                    updatePlanCalculator(id);
                }
            });
        }

        function updateRewardsDisplay() {
            const rewardsContainer = document.getElementById('rewardsContainer');
            if (!rewardsContainer) return;
            
            rewardsContainer.innerHTML = '';
            
            if (Object.keys(leadershipRewards).length === 0) {
                rewardsContainer.innerHTML = `
                    <div class="reward-card" style="text-align: center; padding: 3rem;">
                        <i class="fas fa-trophy" style="font-size: 3rem; color: var(--modern-accent); margin-bottom: 1rem;"></i>
                        <h3>No Rewards Available</h3>
                        <p>There are currently no leadership rewards available. Please check back later.</p>
                    </div>
                `;
                return;
            }
            
            Object.entries(leadershipRewards).forEach(([id, reward]) => {
                const rewardCard = document.createElement('div');
                rewardCard.className = 'reward-card card-3d';
                rewardCard.id = `reward${id}`;
                
                let icon = 'fas fa-gift';
                if (reward.type === 'gadget') icon = 'fas fa-mobile-alt';
                if (reward.type === 'travel') icon = 'fas fa-umbrella-beach';
                if (reward.type === 'car') icon = 'fas fa-car';
                if (reward.type === 'cash') icon = 'fas fa-money-bill-wave';
                
                rewardCard.innerHTML = `
                    <div class="reward-badge">Reward ${id}</div>
                    <div class="reward-icon"><i class="${icon}"></i></div>
                    <h3>${reward.name}</h3>
                    <div style="margin: 1.2rem 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 0.9rem;">
                            <span>Self Business:</span>
                            <strong>$${reward.selfBusiness}</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.8rem; font-size: 0.9rem;">
                            <span>Team Business:</span>
                            <strong>$${reward.teamBusiness}</strong>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="reward${id}Progress" style="width: 0%"></div>
                        </div>
                        <div style="text-align: center; margin-top: 0.5rem; font-size: 0.8rem;">
                            Progress: <span id="reward${id}ProgressText">0%</span>
                        </div>
                    </div>
                    <div style="margin: 1.2rem 0; padding: 0.8rem; background: rgba(0,255,157,0.1); border-radius: 8px; font-size: 0.85rem;">
                        <div><i class="fas fa-info-circle"></i> Required: $${reward.selfBusiness} self + $${reward.teamBusiness} team</div>
                        <div><i class="fas fa-users"></i> Counted from multiple IDs</div>
                    </div>
                    <button class="btn btn-success" id="reward${id}Btn" style="width: 100%;" onclick="claimReward('${id}')" disabled>
                        <i class="fas fa-gift"></i> Claim Reward
                    </button>
                `;
                
                rewardsContainer.appendChild(rewardCard);
            });
            
            // Update progress after display
            if (userData) {
                updateRewardsProgress();
            }
        }

        function updateCommissionDisplay() {
            // Update commission percentages in the UI
            for (let i = 1; i <= 9; i++) {
                const percentElement = document.getElementById(`level${i}Percent`);
                const percentTextElement = document.getElementById(`level${i}PercentText`);
                const percent = commissionLevels[i] || 
                    (i === 1 ? 8 : 
                     i === 2 ? 6 : 
                     i === 3 ? 5 : 
                     i === 4 ? 4 : 
                     i === 5 ? 3 : 
                     i === 6 ? 2 : 
                     i === 7 ? 2 : 
                     i === 8 ? 1 : 1);
                
                if (percentElement) percentElement.textContent = percent + '%';
                if (percentTextElement) percentTextElement.textContent = percent + '%';
            }
        }

        // ====================
        // RESPONSIVE FIXES
        // ====================
        function preventOverflow() {
            // Prevent horizontal scrolling on mobile
            document.body.style.overflowX = 'hidden';
            
            // Handle viewport on mobile
            const viewportMeta = document.querySelector('meta[name="viewport"]');
            if (viewportMeta) {
                viewportMeta.content = "width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";
            }
            
            // Fix for modals on mobile
            window.addEventListener('resize', handleResize);
            handleResize();
        }
        
        function handleResize() {
            // Adjust modal padding on mobile
            if (window.innerWidth <= 768) {
                document.querySelectorAll('.modal-content').forEach(modal => {
                    modal.style.padding = '1.2rem';
                });
            }
        }

        // ====================
        // UI NAVIGATION
        // ====================
        function showCompanyOverview() {
            document.getElementById('companyOverview').style.display = 'block';
            document.getElementById('appContainer').style.display = 'none';
            // Close profile sidebar if open
            profileSidebarOpen = false;
            document.getElementById('profileSidebar').classList.remove('active');
        }

        function showApp() {
            document.getElementById('companyOverview').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            if (userData) {
                updateDashboard();
                updateSidebarProfile();
                // Start next earning timer
                startNextEarningTimer();
            }
        }

        function showHomePage() {
            if (currentUser) {
                showApp();
                switchTab('dashboard');
            } else {
                showCompanyOverview();
                scrollToSection('hero');
            }
        }

        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
                // Close mobile menu if open
                document.getElementById('navLinks').classList.remove('active');
            }
        }

        // ====================
        // AUTH UI MANAGEMENT
        // ====================
        function updateAuthUI(isLoggedIn) {
            const guestAuthButtons = document.getElementById('guestAuthButtons');
            const userSection = document.getElementById('userSection');
            const navLinks = document.getElementById('navLinks');
            
            if (isLoggedIn) {
                // User is logged in
                if (guestAuthButtons) guestAuthButtons.style.display = 'none';
                if (userSection) userSection.style.display = 'flex';
                
                // Update navigation links for logged in user
                if (navLinks) {
                    navLinks.innerHTML = `
                        <li><a href="#" onclick="switchTab('dashboard')"><i class="fas fa-home"></i> Dashboard</a></li>
                        <li><a href="#" onclick="switchTab('plans')"><i class="fas fa-chart-line"></i> Investment Plans</a></li>
                        <li><a href="#" onclick="switchTab('rewards')"><i class="fas fa-trophy"></i> Leadership Rewards</a></li>
                        <li><a href="#" onclick="switchTab('levels')"><i class="fas fa-layer-group"></i> Team Commission</a></li>
                        <li><a href="#" onclick="switchTab('network')"><i class="fas fa-users"></i> Network</a></li>
                        <li><a href="#" onclick="switchTab('earnings')"><i class="fas fa-money-bill-wave"></i> Earnings</a></li>
                        <li><a href="#" onclick="switchTab('transactions')"><i class="fas fa-exchange-alt"></i> Transactions</a></li>
                        <li><a href="#" onclick="showChat()" id="chatBtn"><i class="fas fa-comments"></i> Support Chat</a></li>
                        <li><a href="#" onclick="openDepositModal()"><i class="fas fa-plus-circle"></i> Deposit</a></li>
                        <li><a href="#" onclick="openWithdrawModal()"><i class="fas fa-wallet"></i> Withdraw</a></li>
                        <li><a href="#" onclick="toggleProfileSidebar()"><i class="fas fa-user-circle"></i> Profile</a></li>
                    `;
                }
            } else {
                // User is not logged in
                if (guestAuthButtons) guestAuthButtons.style.display = 'flex';
                if (userSection) userSection.style.display = 'none';
                
                // Update navigation links for guest
                if (navLinks) {
                    navLinks.innerHTML = `
                        <li><a href="#" onclick="scrollToSection('hero')"><i class="fas fa-home"></i> Home</a></li>
                        <li><a href="#" onclick="scrollToSection('mission')"><i class="fas fa-bullseye"></i> Mission</a></li>
                        <li><a href="#" onclick="scrollToSection('features')"><i class="fas fa-star"></i> Features</a></li>
                        <li><a href="#" onclick="scrollToSection('plans')"><i class="fas fa-chart-line"></i> Investment Plans</a></li>
                        <li><a href="#" onclick="scrollToSection('cta')"><i class="fas fa-handshake"></i> Get Started</a></li>
                        <div class="auth-buttons" id="guestAuthButtons">
                            <button class="btn btn-small" onclick="openAuthModal('login')">
                                <i class="fas fa-sign-in-alt"></i> Login
                            </button>
                            <button class="btn btn-small btn-purple" onclick="openAuthModal('signup')">
                                <i class="fas fa-user-plus"></i> Sign Up
                            </button>
                        </div>
                    `;
                }
            }
        }

        // ====================
        // AUTH MODAL FUNCTIONS
        // ====================
        function openAuthModal(tab) {
            document.getElementById('authModal').classList.add('active');
            switchAuthTab(tab);
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
        }

        function switchAuthTab(tab) {
            // Update active tab
            document.querySelectorAll('.auth-tab').forEach(t => {
                t.classList.remove('active');
                if (t.getAttribute('data-auth-tab') === tab) {
                    t.classList.add('active');
                }
            });
            
            // Update active form
            document.querySelectorAll('.auth-form').forEach(form => {
                form.classList.remove('active');
                if (form.id === tab + 'Form') {
                    form.classList.add('active');
                }
            });
        }

        // Login Form Submission
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showNotification('Please enter email and password', 'error');
                return;
            }
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Auto login successful
                    showNotification('Login successful!', 'success');
                    closeAuthModal();
                })
                .catch((error) => {
                    showNotification(error.message, 'error');
                });
        });

        // Signup Form Submission - Fixed: USDT Wallet made optional
        document.getElementById('signupForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const phone = document.getElementById('signupPhone').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            const referralCode = document.getElementById('referralCode').value;
            const usdtWallet = document.getElementById('usdtWallet').value;
            
            // Validation - USDT Wallet is now optional
            if (!name || !email || !phone || !password || !confirmPassword) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }
            
            if (password.length < 6) {
                showNotification('Password must be at least 6 characters', 'error');
                return;
            }
            
            // Create user with Firebase Auth
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    
                    // Generate referral code
                    const refCode = generateReferralCode(name);
                    
                    // Create user data in Firebase - USDT wallet is optional
                    const userData = {
                        uid: user.uid,
                        name: name,
                        email: email,
                        phone: phone,
                        referralCode: refCode,
                        upline: null,
                        usdtWallet: usdtWallet || "", // Empty string if not provided
                        joinDate: new Date().toISOString(),
                        balance: 0,
                        totalEarnings: 0,
                        level: 1,
                        rank: 'Bronze',
                        directReferrals: 0,
                        totalDownline: 0,
                        walletAddress: usdtWallet || "",
                        activeInvestments: [],
                        totalInvested: 0,
                        totalWithdrawn: 0,
                        selfBusiness: 0,
                        teamBusiness: 0,
                        claimedRewards: [],
                        lastBonusClaimDate: null,
                        lastDailyEarningDate: null,
                        levelEarnings: {
                            level1: 0,
                            level2: 0,
                            level3: 0,
                            level4: 0,
                            level5: 0,
                            level6: 0,
                            level7: 0,
                            level8: 0,
                            level9: 0
                        },
                        levelCounts: {
                            level1: 0,
                            level2: 0,
                            level3: 0,
                            level4: 0,
                            level5: 0,
                            level6: 0,
                            level7: 0,
                            level8: 0,
                            level9: 0
                        }
                    };
                    
                    // Check if referral code exists and update upline
                    if (referralCode) {
                        database.ref('users').orderByChild('referralCode').equalTo(referralCode).once('value')
                            .then((snapshot) => {
                                if (snapshot.exists()) {
                                    const uplineData = snapshot.val();
                                    const uplineId = Object.keys(uplineData)[0];
                                    const upline = uplineData[uplineId];
                                    
                                    // Update user's upline
                                    userData.upline = uplineId;
                                    userData.uplineCode = upline.referralCode;
                                    
                                    // Update upline's referral count
                                    const updates = {};
                                    updates['users/' + uplineId + '/directReferrals'] = (upline.directReferrals || 0) + 1;
                                    updates['users/' + uplineId + '/levelCounts/level1'] = (upline.levelCounts?.level1 || 0) + 1;
                                    
                                    database.ref().update(updates);
                                }
                                
                                // Save user data
                                return database.ref('users/' + user.uid).set(userData);
                            });
                    } else {
                        // Save user data without upline
                        return database.ref('users/' + user.uid).set(userData);
                    }
                })
                .then(() => {
                    // AUTO LOGIN: Sign in the user after successful signup
                    return auth.signInWithEmailAndPassword(email, password);
                })
                .then((userCredential) => {
                    showNotification('Account created successfully! Welcome to CryptoWealth Pro!', 'success');
                    closeAuthModal();
                })
                .catch((error) => {
                    showNotification(error.message, 'error');
                });
        });

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                auth.signOut().then(() => {
                    showNotification('Logged out successfully', 'success');
                    // Close profile sidebar if open
                    profileSidebarOpen = false;
                    document.getElementById('profileSidebar').classList.remove('active');
                    // Clear earning timer
                    if (earningTimerInterval) {
                        clearInterval(earningTimerInterval);
                    }
                });
            }
        }

        function showForgotPassword() {
            const email = prompt('Enter your email address to reset password:');
            if (email) {
                auth.sendPasswordResetEmail(email)
                    .then(() => {
                        showNotification('Password reset email sent! Check your inbox.', 'success');
                    })
                    .catch((error) => {
                        showNotification(error.message, 'error');
                    });
            }
        }

        // ====================
        // PROFILE SIDEBAR
        // ====================
        function toggleProfileSidebar() {
            const sidebar = document.getElementById('profileSidebar');
            profileSidebarOpen = !profileSidebarOpen;
            
            if (profileSidebarOpen) {
                sidebar.classList.add('active');
                // Close mobile menu if open
                document.getElementById('navLinks').classList.remove('active');
                updateSidebarProfile();
            } else {
                sidebar.classList.remove('active');
            }
        }
        
        function updateSidebarProfile() {
            if (!userData) return;
            
            const initial = userData.name.charAt(0).toUpperCase();
            document.getElementById('sidebarAvatar').textContent = initial;
            document.getElementById('sidebarName').textContent = userData.name;
            document.getElementById('sidebarEmail').textContent = userData.email;
            document.getElementById('sidebarRank').textContent = userData.rank;
            document.getElementById('sidebarLevel').textContent = userData.level || 1;
            document.getElementById('sidebarReferrals').textContent = userData.directReferrals || 0;
            document.getElementById('sidebarBalance').textContent = userData.balance.toFixed(2) + ' USDT';
            
            // Truncate wallet address for display
            const wallet = userData.usdtWallet || '';
            if (wallet.length > 20) {
                document.getElementById('sidebarWallet').textContent = 
                    wallet.substring(0, 10) + '...' + wallet.substring(wallet.length - 10);
            } else {
                document.getElementById('sidebarWallet').textContent = wallet;
            }
            
            document.getElementById('sidebarJoinDate').textContent = 
                new Date(userData.joinDate).toLocaleDateString();
            
            document.getElementById('sidebarTotalEarned').textContent = 
                (userData.totalEarnings || 0).toFixed(2) + ' USDT';
            
            document.getElementById('sidebarWithdrawn').textContent = 
                (userData.totalWithdrawn || 0).toFixed(2) + ' USDT';
            
            document.getElementById('sidebarActiveInvestments').textContent = 
                (userData.activeInvestments || []).length;
            
            document.getElementById('sidebarTeamSize').textContent = 
                userData.totalDownline || 0;
        }

        // ====================
        // USER DATA MANAGEMENT
        // ====================
        function loadUserData() {
            if (!currentUser) return;
            
            database.ref('users/' + currentUser.uid).on('value', (snapshot) => {
                userData = snapshot.val();
                if (userData) {
                    updateDashboard();
                    updateLevelIncome();
                    updateNetworkTree();
                    updateActiveInvestments();
                    updateTransactions();
                    updateBusinessSummary();
                    updateRewardsProgress();
                    checkDailyBonusEligibility();
                    updateInvestmentHistory();
                    
                    // Update sidebar profile
                    if (profileSidebarOpen) {
                        updateSidebarProfile();
                    }
                    
                    // Start investment earnings if any active investments
                    startInvestmentEarnings();
                    
                    // Calculate next earning time
                    calculateNextEarningTime();
                }
            });
        }

        function updateUserData(updates) {
            if (!currentUser || !userData) return;
            
            return database.ref('users/' + currentUser.uid).update(updates)
                .then(() => {
                    console.log('User data updated successfully');
                    return true;
                })
                .catch((error) => {
                    showNotification('Error updating data: ' + error.message, 'error');
                    return false;
                });
        }

        // ====================
        // APP FUNCTIONS
        // ====================
        function setupEventListeners() {
            // Mobile menu
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const navLinks = document.getElementById('navLinks');
            
            if (mobileMenuBtn && navLinks) {
                mobileMenuBtn.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                    // Close profile sidebar if open
                    if (profileSidebarOpen) {
                        profileSidebarOpen = false;
                        document.getElementById('profileSidebar').classList.remove('active');
                    }
                });
            }
            
            // Auth tab switching
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-auth-tab');
                    switchAuthTab(tabName);
                });
            });
            
            // Main tab switching
            document.querySelectorAll('.tab-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            // Admin tab switching
            document.querySelectorAll('.admin-tab-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-admin-tab');
                    switchAdminTab(tabId);
                });
            });
            
            // Chat input enter key
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendChatMessage();
                    }
                });
            }
            
            // Bot question enter key
            const botQuestion = document.getElementById('botQuestion');
            if (botQuestion) {
                botQuestion.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        askCustomQuestion();
                    }
                });
            }
            
            // Close modals when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                    }
                });
            });
            
            // Close auth modal when clicking outside
            document.getElementById('authModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAuthModal();
                }
            });
            
            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', function(e) {
                const sidebar = document.getElementById('profileSidebar');
                const userAvatar = document.getElementById('userAvatar');
                const profileBtn = document.querySelector('[onclick="toggleProfileSidebar()"]');
                
                if (profileSidebarOpen && sidebar && 
                    !sidebar.contains(e.target) && 
                    !userAvatar.contains(e.target) && 
                    !profileBtn.contains(e.target)) {
                    profileSidebarOpen = false;
                    sidebar.classList.remove('active');
                }
            });
            
            // Handle escape key to close modals and sidebar
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    // Close all modals
                    document.querySelectorAll('.modal.active').forEach(modal => {
                        modal.classList.remove('active');
                    });
                    
                    // Close auth modal
                    closeAuthModal();
                    
                    // Close crypto bot modal
                    document.getElementById('cryptoBotModal').classList.remove('active');
                    
                    // Close chat
                    if (chatActive) {
                        hideChat();
                    }
                    
                    // Close profile sidebar
                    if (profileSidebarOpen) {
                        profileSidebarOpen = false;
                        document.getElementById('profileSidebar').classList.remove('active');
                    }
                }
            });
        }

        function switchTab(tabId) {
            // Update active tab button
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-tab') === tabId) {
                    btn.classList.add('active');
                }
            });
            
            // Update active tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId) {
                    content.classList.add('active');
                }
            });
            
            // Close mobile menu if open
            document.getElementById('navLinks').classList.remove('active');
            
            // Load specific tab data
            if (tabId === 'levels' && userData) {
                updateLevelIncome();
            } else if (tabId === 'earnings' && userData) {
                updateEarnings();
            } else if (tabId === 'transactions' && userData) {
                updateTransactions();
            } else if (tabId === 'plans' && userData) {
                updatePlansDisplay();
            } else if (tabId === 'rewards' && userData) {
                updateRewardsProgress();
            } else if (tabId === 'network' && userData) {
                updateNetworkTree();
            } else if (tabId === 'profile') {
                // Close profile sidebar when opening profile tab
                profileSidebarOpen = false;
                document.getElementById('profileSidebar').classList.remove('active');
            }
        }

        function switchAdminTab(tabId) {
            // Update active admin tab button
            document.querySelectorAll('.admin-tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-admin-tab') === tabId) {
                    btn.classList.add('active');
                }
            });
            
            // Update active admin tab content
            document.querySelectorAll('.admin-tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === 'admin' + tabId.charAt(0).toUpperCase() + tabId.slice(1)) {
                    content.classList.add('active');
                }
            });
            
            // Load specific admin tab data
            if (tabId === 'deposits') {
                loadDepositRequests();
            } else if (tabId === 'withdrawals') {
                loadWithdrawalRequests();
            } else if (tabId === 'users') {
                loadUsers();
            } else if (tabId === 'plans') {
                loadAdminPlans();
            } else if (tabId === 'rewards') {
                loadAdminRewards();
            } else if (tabId === 'commission') {
                loadCommissionSettings();
            } else if (tabId === 'settings') {
                loadSystemSettings();
            }
        }

        function updateDashboard() {
            if (!userData) return;
            
            // Update user info
            document.getElementById('welcomeMessage').textContent = `Welcome, ${userData.name}`;
            document.getElementById('userInfo').textContent = `${userData.rank} Member | Level ${userData.level}`;
            
            // Update avatar
            const initial = userData.name.charAt(0).toUpperCase();
            document.getElementById('userAvatar').textContent = initial;
            document.getElementById('profileAvatar').textContent = initial;
            
            // Update stats
            document.getElementById('balanceAmount').textContent = userData.balance.toFixed(2) + ' USDT';
            document.getElementById('todayEarnings').textContent = '+' + calculateTodayEarnings().toFixed(2) + ' USDT';
            document.getElementById('totalReferrals').textContent = userData.directReferrals;
            document.getElementById('userRank').textContent = userData.rank;
            
            // Update profile
            document.getElementById('profileName').textContent = userData.name;
            document.getElementById('profileEmail').textContent = userData.email;
            document.getElementById('userId').textContent = currentUser.uid.substring(0, 8);
            document.getElementById('joinDate').textContent = new Date(userData.joinDate).toLocaleDateString();
            document.getElementById('userReferralCode').textContent = userData.referralCode;
            
            // Update settings form
            document.getElementById('settingsName').value = userData.name;
            document.getElementById('settingsEmail').value = userData.email;
            document.getElementById('settingsPhone').value = userData.phone || '';
            document.getElementById('walletAddress').value = userData.usdtWallet || '';
            
            // Update recent activity
            updateRecentActivity();
        }

        function updateRecentActivity() {
            if (!userData) return;
            
            const activityTable = document.getElementById('recentActivity');
            activityTable.innerHTML = '';
            
            // Add recent transactions
            const transactions = userData.transactions || [];
            const recentTransactions = transactions.slice(-5).reverse();
            
            if (recentTransactions.length === 0) {
                activityTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 2rem;">No recent activity</td></tr>';
                return;
            }
            
            recentTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const time = new Date(transaction.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                const amount = transaction.amount.toFixed(2);
                let statusBadge = '';
                
                if (transaction.status === 'completed') {
                    statusBadge = '<span class="status-badge status-completed">Completed</span>';
                } else if (transaction.status === 'pending') {
                    statusBadge = '<span class="status-badge status-pending">Pending</span>';
                } else {
                    statusBadge = '<span class="status-badge status-active">Active</span>';
                }
                
                row.innerHTML = `
                    <td>${time}</td>
                    <td>${transaction.type} ${transaction.description || ''}</td>
                    <td>${amount} USDT</td>
                    <td>${statusBadge}</td>
                `;
                activityTable.appendChild(row);
            });
        }

        function calculateTodayEarnings() {
            if (!userData || !userData.activeInvestments) return 0;
            
            let todayEarnings = 0;
            const today = new Date().toDateString();
            
            // Check if we should add daily earnings (24 hours passed)
            const lastEarningDate = userData.lastDailyEarningDate ? 
                new Date(userData.lastDailyEarningDate).toDateString() : null;
            
            if (lastEarningDate !== today) {
                // Add daily earnings from all active investments
                userData.activeInvestments.forEach(investment => {
                    if (investment.status === 'active') {
                        const dailyEarning = (investment.amount * investment.dailyReturn / 100);
                        todayEarnings += dailyEarning;
                    }
                });
            }
            
            // Add level earnings
            if (userData.levelEarnings) {
                Object.values(userData.levelEarnings).forEach(earning => {
                    todayEarnings += (earning || 0);
                });
            }
            
            return todayEarnings;
        }

        function checkDailyBonusEligibility() {
            if (!userData) return;
            
            const today = new Date().toDateString();
            const lastClaimDate = userData.lastBonusClaimDate ? new Date(userData.lastBonusClaimDate).toDateString() : null;
            const dailyBonusBtn = document.getElementById('dailyBonusBtn');
            
            if (lastClaimDate === today) {
                dailyBonusBtn.disabled = true;
                dailyBonusBtn.innerHTML = '<i class="fas fa-check"></i> Bonus Claimed Today';
            } else {
                dailyBonusBtn.disabled = false;
                const bonusAmount = publicSettings.dailyBonus || 0.01;
                dailyBonusBtn.innerHTML = `<i class="fas fa-gift"></i> Claim Daily Bonus ($${bonusAmount})`;
            }
        }

        function claimDailyBonus() {
            if (!userData) return;
            
            const today = new Date().toDateString();
            const lastClaimDate = userData.lastBonusClaimDate ? new Date(userData.lastBonusClaimDate).toDateString() : null;
            
            if (lastClaimDate === today) {
                showNotification('You have already claimed your daily bonus today!', 'error');
                return;
            }
            
            // Only allow bonus claim if user has invested
            if (!userData.activeInvestments || userData.activeInvestments.length === 0) {
                showNotification('You need to make an investment first to claim daily bonus!', 'error');
                return;
            }
            
            // Get bonus amount from settings
            const bonusAmount = publicSettings.dailyBonus || 0.01;
            
            // Update user balance and claim date
            const updates = {
                balance: userData.balance + bonusAmount,
                lastBonusClaimDate: new Date().toISOString(),
                totalEarnings: (userData.totalEarnings || 0) + bonusAmount
            };
            
            // Add transaction
            addTransaction('bonus', bonusAmount, 'Daily Bonus Claim', 'completed');
            
            updateUserData(updates)
                .then(() => {
                    showNotification(`Daily bonus claimed! $${bonusAmount} added to your balance.`, 'success');
                    checkDailyBonusEligibility();
                })
                .catch((error) => {
                    showNotification('Error claiming bonus: ' + error.message, 'error');
                });
        }

        function addTransaction(type, amount, description, status) {
            if (!currentUser || !userData) return;
            
            const transaction = {
                type: type,
                amount: amount,
                description: description,
                status: status,
                timestamp: new Date().toISOString()
            };
            
            // Get existing transactions
            const transactions = userData.transactions || [];
            transactions.push(transaction);
            
            // Update user data
            return database.ref('users/' + currentUser.uid + '/transactions').set(transactions);
        }

        function setupPlanCalculators() {
            // This will be called when plans are loaded
        }

        // FIXED: Investment amount calculator - no auto-correction while typing
        function updatePlanCalculator(planId) {
            const amountInput = document.getElementById(`plan${planId}Amount`);
            if (!amountInput) return;
            
            let amount = parseFloat(amountInput.value) || 0;
            const plan = investmentPlans[planId];
            
            if (!plan) return;
            
            // FIXED: Don't auto-correct while user is typing
            // Only calculate earnings based on current input
            
            const dailyEarning = amount > 0 ? (amount * plan.dailyReturn / 100).toFixed(2) : '0.00';
            const totalReturn = amount > 0 ? (dailyEarning * plan.days).toFixed(2) : '0.00';
            
            const dailyElement = document.getElementById(`plan${planId}Daily`);
            const totalElement = document.getElementById(`plan${planId}Total`);
            
            if (dailyElement) dailyElement.textContent = '$' + dailyEarning;
            if (totalElement) totalElement.textContent = '$' + totalReturn;
        }

        // FIXED: Investment validation function
        function investInPlan(planId) {
            if (!userData) {
                showNotification('Please login to invest', 'error');
                return;
            }
            
            // Check if user has already invested in this plan
            if (userInvestedPlans.has(planId)) {
                showNotification('You have already invested in this plan. You cannot invest in the same plan multiple times.', 'error');
                return;
            }
            
            const amountInput = document.getElementById(`plan${planId}Amount`);
            const amount = parseFloat(amountInput.value) || 0;
            const plan = investmentPlans[planId];
            
            if (!plan) {
                showNotification('Invalid investment plan', 'error');
                return;
            }
            
            // FIXED: Better validation
            if (!amount || amount <= 0) {
                showNotification(`Please enter a valid amount`, 'error');
                amountInput.focus();
                return;
            }
            
            // Check if amount is within plan limits
            if (amount < plan.min || amount > plan.max) {
                showNotification(`Amount must be between $${plan.min} and $${plan.max}`, 'error');
                amountInput.focus();
                return;
            }
            
            // Check decimal numbers
            if (!Number.isInteger(amount)) {
                showNotification('Please enter whole numbers only (no decimals)', 'error');
                amountInput.focus();
                return;
            }
            
            if (amount > userData.balance) {
                showNotification('Insufficient balance. Please deposit first.', 'error');
                openDepositModal();
                return;
            }
            
            // Create investment with 24-hour earning cycle
            const now = new Date();
            const nextEarningTime = new Date(now.getTime() + 24 * 60 * 60 * 1000); // 24 hours from now
            
            const investment = {
                planId: planId,
                planName: plan.name,
                amount: amount,
                dailyReturn: plan.dailyReturn,
                days: plan.days,
                startDate: now.toISOString(),
                endDate: new Date(now.getTime() + plan.days * 24 * 60 * 60 * 1000).toISOString(),
                nextEarningDate: nextEarningTime.toISOString(),
                status: 'active',
                totalEarned: 0,
                daysCompleted: 0,
                lastEarningDate: null
            };
            
            // Update user data
            const activeInvestments = userData.activeInvestments || [];
            activeInvestments.push(investment);
            
            const updates = {
                activeInvestments: activeInvestments,
                balance: userData.balance - amount,
                totalInvested: (userData.totalInvested || 0) + amount,
                selfBusiness: (userData.selfBusiness || 0) + amount
            };
            
            // Add transaction
            addTransaction('investment', amount, `Invested in ${plan.name}`, 'completed');
            
            // Distribute commission to upline
            distributeCommissionToUpline(amount, userData.upline);
            
            updateUserData(updates)
                .then(() => {
                    showNotification(`Successfully invested $${amount} in ${plan.name}! Daily returns will be added every 24 hours.`, 'success');
                    updateInvestmentHistory();
                    updateBusinessSummary();
                    updatePlansDisplay();
                    
                    // Add to invested plans set
                    userInvestedPlans.add(planId);
                    
                    // Recalculate next earning time
                    calculateNextEarningTime();
                    
                    // Enable daily bonus
                    checkDailyBonusEligibility();
                    
                    // Reset input field
                    amountInput.value = '';
                    updatePlanCalculator(planId);
                })
                .catch((error) => {
                    showNotification('Error processing investment: ' + error.message, 'error');
                });
        }

        function distributeCommissionToUpline(amount, uplineId, level = 1) {
            if (!uplineId || level > 9) return;
            
            database.ref('users/' + uplineId).once('value')
                .then((snapshot) => {
                    const upline = snapshot.val();
                    if (!upline) return;
                    
                    const commissionRate = commissionLevels[level] || 
                        (level === 1 ? 8 : 
                         level === 2 ? 6 : 
                         level === 3 ? 5 : 
                         level === 4 ? 4 : 
                         level === 5 ? 3 : 
                         level === 6 ? 2 : 
                         level === 7 ? 2 : 
                         level === 8 ? 1 : 1);
                    
                    const commission = (amount * commissionRate / 100);
                    
                    // Update upline's earnings
                    const updates = {};
                    updates['balance'] = (upline.balance || 0) + commission;
                    updates['totalEarnings'] = (upline.totalEarnings || 0) + commission;
                    updates[`levelEarnings/level${level}`] = (upline.levelEarnings?.[`level${level}`] || 0) + commission;
                    updates[`levelCounts/level${level}`] = (upline.levelCounts?.[`level${level}`] || 0) + 1;
                    updates['teamBusiness'] = (upline.teamBusiness || 0) + amount;
                    
                    database.ref('users/' + uplineId).update(updates);
                    
                    // Add transaction for upline
                    addUplineTransaction(uplineId, commission, `Level ${level} commission from ${userData.name}`);
                    
                    // Continue to next level
                    if (upline.upline) {
                        distributeCommissionToUpline(amount, upline.upline, level + 1);
                    }
                });
        }

        function addUplineTransaction(userId, amount, description) {
            database.ref('users/' + userId + '/transactions').once('value')
                .then((snapshot) => {
                    const transactions = snapshot.val() || [];
                    transactions.push({
                        type: 'commission',
                        amount: amount,
                        description: description,
                        status: 'completed',
                        timestamp: new Date().toISOString()
                    });
                    
                    database.ref('users/' + userId + '/transactions').set(transactions);
                });
        }

        function updateInvestmentHistory() {
            if (!userData || !userData.activeInvestments) return;
            
            const historyTable = document.getElementById('investmentHistory');
            historyTable.innerHTML = '';
            
            if (userData.activeInvestments.length === 0) {
                historyTable.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 2rem;">No investment history</td></tr>';
                return;
            }
            
            userData.activeInvestments.forEach((investment, index) => {
                const startDate = new Date(investment.startDate);
                const endDate = new Date(investment.endDate);
                const now = new Date();
                const daysLeft = Math.max(0, Math.ceil((endDate - now) / (1000 * 60 * 60 * 24)));
                const totalEarned = investment.totalEarned || 0;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${investment.planName}</td>
                    <td>$${investment.amount.toFixed(2)}</td>
                    <td>${startDate.toLocaleDateString()}</td>
                    <td>${investment.dailyReturn}%</td>
                    <td>${daysLeft}</td>
                    <td>$${totalEarned.toFixed(2)}</td>
                    <td><span class="status-badge ${investment.status === 'active' ? 'status-active' : 'status-completed'}">${investment.status}</span></td>
                `;
                historyTable.appendChild(row);
            });
        }

        function startInvestmentEarnings() {
            if (!userData || !userData.activeInvestments) return;
            
            // Clear any existing intervals
            Object.values(investmentIntervals).forEach(interval => clearInterval(interval));
            investmentIntervals = {};
            
            // Start earning simulation for each active investment
            userData.activeInvestments.forEach((investment, index) => {
                if (investment.status === 'active') {
                    startInvestmentEarning(investment);
                }
            });
        }

        function startInvestmentEarning(investment) {
            const investmentId = Date.now() + Math.random();
            
            // Check every minute for earning time
            const interval = setInterval(() => {
                if (!userData) {
                    clearInterval(interval);
                    return;
                }
                
                const now = new Date();
                const endDate = new Date(investment.endDate);
                
                if (now >= endDate) {
                    // Investment completed
                    clearInterval(interval);
                    updateInvestmentStatus(investment, 'completed');
                    return;
                }
                
                // Check if it's time for daily earnings (24 hours passed)
                const nextEarningDate = new Date(investment.nextEarningDate);
                
                if (now >= nextEarningDate) {
                    // Calculate daily earnings
                    const dailyEarning = investment.amount * investment.dailyReturn / 100;
                    
                    // Update user balance
                    const updates = {
                        balance: userData.balance + dailyEarning,
                        totalEarnings: (userData.totalEarnings || 0) + dailyEarning,
                        lastDailyEarningDate: now.toISOString()
                    };
                    
                    // Update investment earnings and next earning date
                    const activeInvestments = userData.activeInvestments || [];
                    const investmentIndex = activeInvestments.findIndex(inv => 
                        inv.planId === investment.planId && 
                        inv.startDate === investment.startDate
                    );
                    
                    if (investmentIndex !== -1) {
                        activeInvestments[investmentIndex].totalEarned += dailyEarning;
                        activeInvestments[investmentIndex].daysCompleted += 1;
                        activeInvestments[investmentIndex].lastEarningDate = now.toISOString();
                        activeInvestments[investmentIndex].nextEarningDate = new Date(now.getTime() + 24 * 60 * 60 * 1000).toISOString();
                        updates.activeInvestments = activeInvestments;
                    }
                    
                    updateUserData(updates);
                    
                    // Add transaction
                    addTransaction('investment_earning', dailyEarning, `Daily return from ${investment.planName}`, 'completed');
                    
                    // Recalculate next earning time
                    calculateNextEarningTime();
                    
                    // Update investment history display
                    updateInvestmentHistory();
                }
                
            }, 60000); // Check every minute
            
            investmentIntervals[investmentId] = interval;
        }

        function calculateNextEarningTime() {
            if (!userData || !userData.activeInvestments || userData.activeInvestments.length === 0) {
                document.getElementById('nextEarningTimer').style.display = 'none';
                if (earningTimerInterval) {
                    clearInterval(earningTimerInterval);
                }
                return;
            }
            
            // Find the earliest next earning date among all active investments
            let earliestDate = null;
            
            userData.activeInvestments.forEach(investment => {
                if (investment.status === 'active') {
                    const nextEarningDate = new Date(investment.nextEarningDate);
                    if (!earliestDate || nextEarningDate < earliestDate) {
                        earliestDate = nextEarningDate;
                    }
                }
            });
            
            if (earliestDate) {
                nextEarningTime = earliestDate;
                document.getElementById('nextEarningTimer').style.display = 'block';
                updateNextEarningTimer();
                
                // Start timer interval if not already started
                if (!earningTimerInterval) {
                    earningTimerInterval = setInterval(updateNextEarningTimer, 1000);
                }
            } else {
                document.getElementById('nextEarningTimer').style.display = 'none';
                if (earningTimerInterval) {
                    clearInterval(earningTimerInterval);
                    earningTimerInterval = null;
                }
            }
        }

        function updateNextEarningTimer() {
            if (!nextEarningTime) return;
            
            const now = new Date();
            const diff = nextEarningTime - now;
            
            if (diff <= 0) {
                // Time's up, recalculate next earning time
                calculateNextEarningTime();
                return;
            }
            
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            document.getElementById('nextEarningTime').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function startNextEarningTimer() {
            calculateNextEarningTime();
        }

        function updateInvestmentStatus(investment, status) {
            if (!userData) return;
            
            const activeInvestments = userData.activeInvestments || [];
            const investmentIndex = activeInvestments.findIndex(inv => 
                inv.planId === investment.planId && 
                inv.startDate === investment.startDate
            );
            
            if (investmentIndex !== -1) {
                activeInvestments[investmentIndex].status = status;
                updateUserData({ activeInvestments: activeInvestments });
            }
        }

        function updateActiveInvestments() {
            // This function updates the active investments display
            if (!userData || !userData.activeInvestments) return;
            
            // Update investment history display
            updateInvestmentHistory();
        }

        function updateBusinessSummary() {
            if (!userData) return;
            
            document.getElementById('selfBusiness').textContent = (userData.selfBusiness || 0).toFixed(2) + ' USDT';
            document.getElementById('teamBusiness').textContent = (userData.teamBusiness || 0).toFixed(2) + ' USDT';
            document.getElementById('totalBusiness').textContent = ((userData.selfBusiness || 0) + (userData.teamBusiness || 0)).toFixed(2) + ' USDT';
        }

        function updateRewardsProgress() {
            if (!userData || Object.keys(leadershipRewards).length === 0) return;
            
            Object.keys(leadershipRewards).forEach(rewardId => {
                const reward = leadershipRewards[rewardId];
                const selfBusiness = userData.selfBusiness || 0;
                const teamBusiness = userData.teamBusiness || 0;
                
                const selfProgress = Math.min((selfBusiness / reward.selfBusiness) * 100, 100);
                const teamProgress = Math.min((teamBusiness / reward.teamBusiness) * 100, 100);
                const totalProgress = Math.min((selfProgress + teamProgress) / 2, 100);
                
                // Update progress bars
                const progressBar = document.getElementById(`reward${rewardId}Progress`);
                const progressText = document.getElementById(`reward${rewardId}ProgressText`);
                const claimBtn = document.getElementById(`reward${rewardId}Btn`);
                
                if (progressBar) {
                    progressBar.style.width = totalProgress + '%';
                }
                
                if (progressText) {
                    progressText.textContent = totalProgress.toFixed(0) + '%';
                }
                
                if (claimBtn) {
                    const isClaimed = userData.claimedRewards?.includes(parseInt(rewardId)) || false;
                    const canClaim = selfBusiness >= reward.selfBusiness && teamBusiness >= reward.teamBusiness;
                    
                    if (isClaimed) {
                        claimBtn.disabled = true;
                        claimBtn.innerHTML = '<i class="fas fa-check"></i> Claimed';
                        document.getElementById(`reward${rewardId}`).classList.add('achieved');
                    } else if (canClaim) {
                        claimBtn.disabled = false;
                        claimBtn.innerHTML = '<i class="fas fa-gift"></i> Claim Reward';
                    } else {
                        claimBtn.disabled = true;
                        claimBtn.innerHTML = '<i class="fas fa-gift"></i> Claim Reward';
                    }
                }
            });
            
            updateClaimedRewards();
        }

        function updateClaimedRewards() {
            if (!userData) return;
            
            const claimedTable = document.getElementById('claimedRewards');
            claimedTable.innerHTML = '';
            
            const claimedRewards = userData.claimedRewards || [];
            
            if (claimedRewards.length === 0) {
                claimedTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 2rem;">No rewards claimed yet</td></tr>';
                return;
            }
            
            claimedRewards.forEach(rewardId => {
                const reward = leadershipRewards[rewardId];
                if (!reward) return;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${reward.name}</td>
                    <td>$${reward.selfBusiness} self + $${reward.teamBusiness} team</td>
                    <td>${new Date().toLocaleDateString()}</td>
                    <td><span class="status-badge status-completed">Claimed</span></td>
                `;
                claimedTable.appendChild(row);
            });
        }

        function claimReward(rewardId) {
            if (!userData) return;
            
            const reward = leadershipRewards[rewardId];
            if (!reward) return;
            
            // Check if already claimed
            const isClaimed = userData.claimedRewards?.includes(parseInt(rewardId)) || false;
            if (isClaimed) {
                showNotification('Reward already claimed!', 'error');
                return;
            }
            
            // Check requirements
            if ((userData.selfBusiness || 0) < reward.selfBusiness || (userData.teamBusiness || 0) < reward.teamBusiness) {
                showNotification('Requirements not met for this reward!', 'error');
                return;
            }
            
            // Update claimed rewards
            const claimedRewards = userData.claimedRewards || [];
            claimedRewards.push(parseInt(rewardId));
            
            updateUserData({ claimedRewards: claimedRewards })
                .then(() => {
                    showNotification(`Congratulations! You've claimed ${reward.name}!`, 'success');
                    updateRewardsProgress();
                })
                .catch((error) => {
                    showNotification('Error claiming reward: ' + error.message, 'error');
                });
        }

        function updateLevelIncome() {
            if (!userData) return;
            
            let totalCommission = 0;
            
            // Update level counts and earnings
            for (let level = 1; level <= 9; level++) {
                const count = userData.levelCounts?.[`level${level}`] || 0;
                const earnings = userData.levelEarnings?.[`level${level}`] || 0;
                
                document.getElementById(`level${level}Count`).textContent = count;
                document.getElementById(`level${level}Earnings`).textContent = earnings.toFixed(2) + ' USDT';
                
                totalCommission += earnings;
            }
            
            document.getElementById('totalTeamCommission').textContent = totalCommission.toFixed(2) + ' USDT';
        }

        function updateNetworkTree() {
            if (!userData) return;
            
            // Update network statistics
            document.getElementById('totalDownline').textContent = userData.totalDownline || 0;
            document.getElementById('activeDownline').textContent = userData.directReferrals || 0;
            document.getElementById('totalTeams').textContent = Object.values(userData.levelCounts || {}).reduce((a, b) => a + b, 0);
            
            // Simple network tree visualization
            const networkTree = document.getElementById('networkTree');
            networkTree.innerHTML = '';
            
            // Add user node
            const userLevel = document.createElement('div');
            userLevel.className = 'tree-level';
            userLevel.innerHTML = `
                <div class="tree-node you" onclick="showUserDetails('${currentUser.uid}')">
                    YOU
                    <div class="node-info">${userData.name}</div>
                </div>
            `;
            networkTree.appendChild(userLevel);
            
            // Add direct referrals (level 1)
            if (userData.directReferrals > 0) {
                const level1 = document.createElement('div');
                level1.className = 'tree-level';
                
                for (let i = 0; i < Math.min(userData.directReferrals, 5); i++) {
                    level1.innerHTML += `
                        <div class="tree-node" onclick="showUserDetails('level1_${i}')">
                            L1
                            <div class="node-info">Member ${i + 1}</div>
                        </div>
                    `;
                }
                
                if (userData.directReferrals > 5) {
                    level1.innerHTML += `
                        <div class="tree-node">
                            +${userData.directReferrals - 5}
                            <div class="node-info">More</div>
                        </div>
                    `;
                }
                
                networkTree.appendChild(level1);
            }
        }

        function showUserDetails(userId) {
            if (userId === currentUser.uid) {
                alert(`Your Details:\n\nName: ${userData.name}\nEmail: ${userData.email}\nJoin Date: ${new Date(userData.joinDate).toLocaleDateString()}\nLevel: ${userData.level}\nReferrals: ${userData.directReferrals}\nBalance: $${userData.balance.toFixed(2)}\nSelf Business: $${userData.selfBusiness.toFixed(2)}\nTeam Business: $${userData.teamBusiness.toFixed(2)}`);
            } else {
                alert('This is a simplified demo. In a real system, this would show detailed user information from the database.');
            }
        }

        function updateEarnings() {
            if (!userData) return;
            
            document.getElementById('totalEarningsAmount').textContent = (userData.totalEarnings || 0).toFixed(2) + ' USDT';
            document.getElementById('withdrawnAmount').textContent = (userData.totalWithdrawn || 0).toFixed(2) + ' USDT';
            document.getElementById('availableEarnings').textContent = userData.balance.toFixed(2) + ' USDT';
            
            // Calculate pending earnings from active investments
            let pendingEarnings = 0;
            if (userData.activeInvestments) {
                userData.activeInvestments.forEach(investment => {
                    if (investment.status === 'active') {
                        const dailyEarning = investment.amount * investment.dailyReturn / 100;
                        pendingEarnings += dailyEarning;
                    }
                });
            }
            
            document.getElementById('pendingEarnings').textContent = pendingEarnings.toFixed(2) + ' USDT';
            
            updateEarningsTable();
        }

        function updateEarningsTable() {
            if (!userData) return;
            
            const earningsTable = document.getElementById('earningsTable');
            earningsTable.innerHTML = '';
            
            const transactions = userData.transactions || [];
            const earningTransactions = transactions.filter(t => 
                t.type === 'commission' || t.type === 'investment_earning' || t.type === 'bonus'
            ).slice(-10).reverse();
            
            if (earningTransactions.length === 0) {
                earningsTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 2rem;">No earnings yet</td></tr>';
                return;
            }
            
            earningTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const date = new Date(transaction.timestamp).toLocaleDateString();
                let source = '';
                
                switch (transaction.type) {
                    case 'commission':
                        source = 'Team Commission';
                        break;
                    case 'investment_earning':
                        source = 'Investment Return';
                        break;
                    case 'bonus':
                        source = 'Daily Bonus';
                        break;
                    default:
                        source = transaction.type;
                }
                
                row.innerHTML = `
                    <td>${source}</td>
                    <td>${transaction.amount.toFixed(2)} USDT</td>
                    <td>${date}</td>
                    <td><span class="status-badge status-completed">Completed</span></td>
                `;
                earningsTable.appendChild(row);
            });
        }

        function updateTransactions() {
            updateDepositsTable();
            updateWithdrawalsTable();
        }

        function updateDepositsTable() {
            if (!userData) return;
            
            const depositsTable = document.getElementById('depositsTable');
            depositsTable.innerHTML = '';
            
            const transactions = userData.transactions || [];
            const depositTransactions = transactions.filter(t => t.type === 'deposit').slice(-5).reverse();
            
            if (depositTransactions.length === 0) {
                depositsTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 2rem;">No deposits yet</td></tr>';
                return;
            }
            
            depositTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const date = new Date(transaction.timestamp).toLocaleDateString();
                
                row.innerHTML = `
                    <td>${date}</td>
                    <td>${transaction.amount.toFixed(2)} USDT</td>
                    <td>USDT BEP20</td>
                    <td><span class="status-badge status-completed">Completed</span></td>
                `;
                depositsTable.appendChild(row);
            });
        }

        function updateWithdrawalsTable() {
            if (!userData) return;
            
            const withdrawalsTable = document.getElementById('withdrawalsTable');
            withdrawalsTable.innerHTML = '';
            
            const transactions = userData.transactions || [];
            const withdrawalTransactions = transactions.filter(t => t.type === 'withdrawal').slice(-5).reverse();
            
            if (withdrawalTransactions.length === 0) {
                withdrawalsTable.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 2rem;">No withdrawals yet</td></tr>';
                return;
            }
            
            withdrawalTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const date = new Date(transaction.timestamp).toLocaleDateString();
                const fee = transaction.fee || (transaction.amount * (publicSettings.withdrawalFee || 12) / 100);
                const netAmount = transaction.netAmount || (transaction.amount - fee);
                
                row.innerHTML = `
                    <td>${date}</td>
                    <td>${transaction.amount.toFixed(2)} USDT</td>
                    <td>${netAmount.toFixed(2)} USDT</td>
                    <td>${fee.toFixed(2)} USDT</td>
                    <td><span class="status-badge ${transaction.status === 'pending' ? 'status-pending' : transaction.status === 'completed' ? 'status-completed' : 'status-active'}">${transaction.status}</span></td>
                `;
                withdrawalsTable.appendChild(row);
            });
        }

        // ====================
        // MODAL FUNCTIONS
        // ====================
        function openDepositModal() {
            document.getElementById('depositModal').classList.add('active');
            // Update available balance and limits with minimum $5
            const minDeposit = Math.max(5, publicSettings.minDeposit || 5);
            const maxDeposit = publicSettings.maxDeposit || 5000;
            
            document.getElementById('depositAmount').max = maxDeposit;
            document.getElementById('depositAmount').min = minDeposit;
            document.getElementById('depositAmount').placeholder = minDeposit;
            document.getElementById('depositAmount').value = minDeposit;
            
            // Update displayed values
            document.getElementById('minDepositAmount').textContent = minDeposit;
            document.getElementById('maxDepositAmount').textContent = maxDeposit;
        }

        function closeDepositModal() {
            document.getElementById('depositModal').classList.remove('active');
        }

        function processDeposit() {
            const amount = parseFloat(document.getElementById('depositAmount').value) || 0;
            const minDeposit = Math.max(5, publicSettings.minDeposit || 5);
            const maxDeposit = publicSettings.maxDeposit || 5000;
            
            if (amount < minDeposit || amount > maxDeposit) {
                showNotification(`Please enter amount between $${minDeposit} and $${maxDeposit}`, 'error');
                return;
            }
            
            // Create deposit request
            const depositRequest = {
                userId: currentUser.uid,
                userName: userData.name,
                amount: amount,
                status: 'pending',
                timestamp: new Date().toISOString(),
                type: 'deposit'
            };
            
            // Save deposit request to database
            database.ref('depositRequests').push(depositRequest)
                .then(() => {
                    showNotification('Deposit request submitted! Admin will approve it shortly.', 'success');
                    closeDepositModal();
                    
                    // Add to user transactions
                    addTransaction('deposit', amount, 'Deposit Request', 'pending');
                })
                .catch((error) => {
                    showNotification('Error submitting deposit request: ' + error.message, 'error');
                });
        }

        function openWithdrawModal() {
            document.getElementById('withdrawModal').classList.add('active');
            
            // Update available balance
            document.getElementById('availableBalance').textContent = userData.balance.toFixed(2) + ' USDT';
            
            // Setup withdrawal amount calculator
            const withdrawInput = document.getElementById('withdrawAmount');
            const minWithdrawal = publicSettings.minWithdrawal || 1;
            withdrawInput.value = Math.max(minWithdrawal, Math.min(userData.balance, 100));
            withdrawInput.max = userData.balance;
            withdrawInput.min = minWithdrawal;
            withdrawInput.placeholder = minWithdrawal;
            calculateWithdrawalAmount();
        }

        function closeWithdrawModal() {
            document.getElementById('withdrawModal').classList.remove('active');
        }

        function setupWithdrawalCalculator() {
            const withdrawInput = document.getElementById('withdrawAmount');
            if (withdrawInput) {
                withdrawInput.addEventListener('input', calculateWithdrawalAmount);
            }
        }

        function calculateWithdrawalAmount() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value) || 0;
            const withdrawalFeePercent = publicSettings.withdrawalFee || 12;
            const withdrawalFee = (amount * withdrawalFeePercent / 100);
            const netAmount = amount - withdrawalFee;
            
            document.getElementById('withdrawalFee').value = withdrawalFee.toFixed(2) + ' USDT';
            document.getElementById('netAmount').value = netAmount.toFixed(2) + ' USDT';
        }

        function processWithdrawal() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value) || 0;
            const walletAddress = document.getElementById('withdrawAddress').value.trim();
            const minWithdrawal = publicSettings.minWithdrawal || 1;
            
            if (amount < minWithdrawal) {
                showNotification(`Minimum withdrawal amount is ${minWithdrawal} USDT`, 'error');
                return;
            }
            
            if (amount > userData.balance) {
                showNotification('Insufficient balance', 'error');
                return;
            }
            
            if (!walletAddress || walletAddress.length < 20) {
                showNotification('Please enter a valid USDT BEP20 wallet address', 'error');
                return;
            }
            
            const withdrawalFeePercent = publicSettings.withdrawalFee || 12;
            const withdrawalFee = (amount * withdrawalFeePercent / 100);
            const netAmount = amount - withdrawalFee;
            
            // Create withdrawal request
            const withdrawalRequest = {
                userId: currentUser.uid,
                userName: userData.name,
                amount: amount,
                fee: withdrawalFee,
                netAmount: netAmount,
                walletAddress: walletAddress,
                status: 'pending',
                timestamp: new Date().toISOString(),
                type: 'withdrawal'
            };
            
            // Save withdrawal request to database
            database.ref('withdrawalRequests').push(withdrawalRequest)
                .then(() => {
                    showNotification('Withdrawal request submitted! Admin will process it within 24 hours.', 'success');
                    closeWithdrawModal();
                    
                    // Add to user transactions
                    addTransaction('withdrawal', amount, 'Withdrawal Request', 'pending');
                })
                .catch((error) => {
                    showNotification('Error submitting withdrawal request: ' + error.message, 'error');
                });
        }

        // ====================
        // ADMIN FUNCTIONS
        // ====================
        let chatActive = false;

        function openAdminPanel() {
            const password = prompt('Enter admin password:');
            if (password === 'admin123') { // Default admin password
                document.getElementById('adminModal').classList.add('active');
                loadSystemSettings();
            } else {
                showNotification('Invalid admin password', 'error');
            }
        }

        function closeAdminModal() {
            document.getElementById('adminModal').classList.remove('active');
        }

        function loadSystemSettings() {
            database.ref('publicSettings').once('value')
                .then((snapshot) => {
                    const settings = snapshot.val() || {};
                    
                    document.getElementById('adminDepositWallet').value = settings.depositWallet || '';
                    document.getElementById('adminMinDeposit').value = Math.max(5, settings.minDeposit || 5);
                    document.getElementById('adminMaxDeposit').value = settings.maxDeposit || 5000;
                    document.getElementById('adminWithdrawalFee').value = settings.withdrawalFee || 12;
                    document.getElementById('adminDailyBonus').value = settings.dailyBonus || 0.01;
                });
        }

        function updateSystemSettings() {
            const settings = {
                depositWallet: document.getElementById('adminDepositWallet').value,
                minDeposit: Math.max(5, parseFloat(document.getElementById('adminMinDeposit').value) || 5),
                maxDeposit: parseFloat(document.getElementById('adminMaxDeposit').value) || 5000,
                withdrawalFee: parseFloat(document.getElementById('adminWithdrawalFee').value) || 12,
                dailyBonus: parseFloat(document.getElementById('adminDailyBonus').value) || 0.01
            };
            
            database.ref('publicSettings').update(settings)
                .then(() => {
                    showNotification('System settings updated successfully!', 'success');
                })
                .catch((error) => {
                    showNotification('Error updating settings: ' + error.message, 'error');
                });
        }

        function loadAdminPlans() {
            database.ref('public/plans').once('value')
                .then((snapshot) => {
                    const plans = snapshot.val() || {};
                    const container = document.getElementById('adminPlansContainer');
                    container.innerHTML = '';
                    
                    Object.entries(plans).forEach(([id, plan]) => {
                        const planDiv = document.createElement('div');
                        planDiv.className = 'plan-card';
                        planDiv.innerHTML = `
                            <h3>${plan.name || 'Plan ' + id}</h3>
                            <div class="form-group">
                                <label>Plan Name</label>
                                <input type="text" class="form-control" value="${plan.name || ''}" id="adminPlanName${id}">
                            </div>
                            <div class="form-group">
                                <label>Minimum Investment ($)</label>
                                <input type="number" class="form-control" value="${Math.max(5, plan.min || 5)}" id="adminPlanMin${id}">
                            </div>
                            <div class="form-group">
                                <label>Maximum Investment ($)</label>
                                <input type="number" class="form-control" value="${plan.max || 0}" id="adminPlanMax${id}">
                            </div>
                            <div class="form-group">
                                <label>Daily Return (%)</label>
                                <input type="number" class="form-control" value="${plan.dailyReturn || 0}" step="0.1" id="adminPlanReturn${id}">
                            </div>
                            <div class="form-group">
                                <label>Duration (Days)</label>
                                <input type="number" class="form-control" value="${plan.days || 0}" id="adminPlanDays${id}">
                            </div>
                            <div class="form-group">
                                <label>Status</label>
                                <select class="form-control" id="adminPlanStatus${id}">
                                    <option value="active" ${plan.status === 'active' ? 'selected' : ''}>Active</option>
                                    <option value="inactive" ${plan.status === 'inactive' ? 'selected' : ''}>Inactive</option>
                                </select>
                            </div>
                            <button class="btn btn-success" onclick="updatePlan('${id}')">
                                <i class="fas fa-save"></i> Update Plan
                            </button>
                            <button class="btn btn-danger" onclick="deletePlan('${id}')" style="margin-top: 0.5rem;">
                                <i class="fas fa-trash"></i> Delete Plan
                            </button>
                        `;
                        container.appendChild(planDiv);
                    });
                });
        }

        function addNewPlan() {
            const newPlanId = Date.now().toString();
            const planDiv = document.createElement('div');
            planDiv.className = 'plan-card';
            planDiv.innerHTML = `
                <h3>New Plan</h3>
                <div class="form-group">
                    <label>Plan Name</label>
                    <input type="text" class="form-control" id="adminPlanName${newPlanId}" placeholder="Enter plan name">
                </div>
                <div class="form-group">
                    <label>Minimum Investment ($)</label>
                    <input type="number" class="form-control" id="adminPlanMin${newPlanId}" placeholder="5" min="5">
                </div>
                <div class="form-group">
                    <label>Maximum Investment ($)</label>
                    <input type="number" class="form-control" id="adminPlanMax${newPlanId}" placeholder="5000" min="5">
                </div>
                <div class="form-group">
                    <label>Daily Return (%)</label>
                    <input type="number" class="form-control" id="adminPlanReturn${newPlanId}" placeholder="6" step="0.1" min="0.1" max="100">
                </div>
                <div class="form-group">
                    <label>Duration (Days)</label>
                    <input type="number" class="form-control" id="adminPlanDays${newPlanId}" placeholder="60" min="1">
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select class="form-control" id="adminPlanStatus${newPlanId}">
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                </div>
                <button class="btn btn-success" onclick="saveNewPlan('${newPlanId}')">
                    <i class="fas fa-save"></i> Save New Plan
                </button>
            `;
            document.getElementById('adminPlansContainer').appendChild(planDiv);
        }

        function saveNewPlan(planId) {
            const plan = {
                name: document.getElementById(`adminPlanName${planId}`).value,
                min: Math.max(5, parseFloat(document.getElementById(`adminPlanMin${planId}`).value) || 5),
                max: parseFloat(document.getElementById(`adminPlanMax${planId}`).value) || 5000,
                dailyReturn: parseFloat(document.getElementById(`adminPlanReturn${planId}`).value) || 6,
                days: parseInt(document.getElementById(`adminPlanDays${planId}`).value) || 60,
                status: document.getElementById(`adminPlanStatus${planId}`).value,
                principal: true
            };
            
            database.ref(`public/plans/${planId}`).set(plan)
                .then(() => {
                    showNotification('New plan saved successfully!', 'success');
                    loadAdminPlans();
                })
                .catch((error) => {
                    showNotification('Error saving plan: ' + error.message, 'error');
                });
        }

        function updatePlan(planId) {
            const plan = {
                name: document.getElementById(`adminPlanName${planId}`).value,
                min: Math.max(5, parseFloat(document.getElementById(`adminPlanMin${planId}`).value) || 5),
                max: parseFloat(document.getElementById(`adminPlanMax${planId}`).value) || 5000,
                dailyReturn: parseFloat(document.getElementById(`adminPlanReturn${planId}`).value) || 6,
                days: parseInt(document.getElementById(`adminPlanDays${planId}`).value) || 60,
                status: document.getElementById(`adminPlanStatus${planId}`).value,
                principal: true
            };
            
            database.ref(`public/plans/${planId}`).update(plan)
                .then(() => {
                    showNotification('Plan updated successfully!', 'success');
                })
                .catch((error) => {
                    showNotification('Error updating plan: ' + error.message, 'error');
                });
        }

        function deletePlan(planId) {
            if (confirm('Are you sure you want to delete this plan?')) {
                database.ref(`public/plans/${planId}`).remove()
                    .then(() => {
                        showNotification('Plan deleted successfully!', 'success');
                        loadAdminPlans();
                    })
                    .catch((error) => {
                        showNotification('Error deleting plan: ' + error.message, 'error');
                    });
            }
        }

        function loadCommissionSettings() {
            database.ref('public/commissionSettings').once('value')
                .then((snapshot) => {
                    const settings = snapshot.val() || {};
                    
                    for (let i = 1; i <= 9; i++) {
                        const element = document.getElementById(`adminLevel${i}`);
                        if (element) {
                            element.value = settings[`level${i}`] || 
                                (i === 1 ? 8 : 
                                 i === 2 ? 6 : 
                                 i === 3 ? 5 : 
                                 i === 4 ? 4 : 
                                 i === 5 ? 3 : 
                                 i === 6 ? 2 : 
                                 i === 7 ? 2 : 
                                 i === 8 ? 1 : 1);
                        }
                    }
                });
        }

        function updateCommissionRates() {
            const settings = {};
            
            for (let i = 1; i <= 9; i++) {
                const value = parseFloat(document.getElementById(`adminLevel${i}`).value) || 0;
                settings[`level${i}`] = value;
            }
            
            database.ref('public/commissionSettings').update(settings)
                .then(() => {
                    showNotification('Commission rates updated successfully!', 'success');
                })
                .catch((error) => {
                    showNotification('Error updating commission rates: ' + error.message, 'error');
                });
        }

        function loadDepositRequests() {
            database.ref('depositRequests').once('value')
                .then((snapshot) => {
                    const requests = snapshot.val() || {};
                    const table = document.getElementById('adminDepositsTable');
                    table.innerHTML = '';
                    
                    Object.entries(requests).forEach(([id, request]) => {
                        if (request.status === 'pending') {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${request.userName || 'Unknown'}</td>
                                <td>$${request.amount || 0}</td>
                                <td>${new Date(request.timestamp).toLocaleDateString()}</td>
                                <td><span class="status-badge status-pending">Pending</span></td>
                                <td>
                                    <button class="btn btn-small btn-success" onclick="approveDeposit('${id}', '${request.userId}', ${request.amount})">
                                        <i class="fas fa-check"></i> Approve
                                    </button>
                                    <button class="btn btn-small btn-danger" onclick="rejectDeposit('${id}')">
                                        <i class="fas fa-times"></i> Reject
                                    </button>
                                </td>
                            `;
                            table.appendChild(row);
                        }
                    });
                    
                    if (table.innerHTML === '') {
                        table.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 2rem;">No pending deposit requests</td></tr>';
                    }
                });
        }

        function approveDeposit(requestId, userId, amount) {
            // Update request status
            database.ref(`depositRequests/${requestId}`).update({ status: 'approved' })
                .then(() => {
                    // Update user balance
                    database.ref(`users/${userId}`).once('value')
                        .then((snapshot) => {
                            const user = snapshot.val();
                            if (user) {
                                const newBalance = (user.balance || 0) + amount;
                                database.ref(`users/${userId}`).update({ balance: newBalance });
                                
                                // Add transaction for user
                                database.ref(`users/${userId}/transactions`).once('value')
                                    .then((snapshot) => {
                                        const transactions = snapshot.val() || [];
                                        transactions.push({
                                            type: 'deposit',
                                            amount: amount,
                                            description: 'Deposit Approved',
                                            status: 'completed',
                                            timestamp: new Date().toISOString()
                                        });
                                        
                                        database.ref(`users/${userId}/transactions`).set(transactions);
                                    });
                            }
                        });
                    
                    showNotification('Deposit approved successfully!', 'success');
                    loadDepositRequests();
                })
                .catch((error) => {
                    showNotification('Error approving deposit: ' + error.message, 'error');
                });
        }

        function rejectDeposit(requestId) {
            database.ref(`depositRequests/${requestId}`).update({ status: 'rejected' })
                .then(() => {
                    showNotification('Deposit rejected!', 'success');
                    loadDepositRequests();
                })
                .catch((error) => {
                    showNotification('Error rejecting deposit: ' + error.message, 'error');
                });
        }

        function loadWithdrawalRequests() {
            database.ref('withdrawalRequests').once('value')
                .then((snapshot) => {
                    const requests = snapshot.val() || {};
                    const table = document.getElementById('adminWithdrawalsTable');
                    table.innerHTML = '';
                    
                    Object.entries(requests).forEach(([id, request]) => {
                        if (request.status === 'pending') {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${request.userName || 'Unknown'}</td>
                                <td>$${request.amount || 0}</td>
                                <td style="font-size: 0.8rem;">${request.walletAddress ? request.walletAddress.substring(0, 20) + '...' : 'N/A'}</td>
                                <td>${new Date(request.timestamp).toLocaleDateString()}</td>
                                <td><span class="status-badge status-pending">Pending</span></td>
                                <td>
                                    <button class="btn btn-small btn-success" onclick="approveWithdrawal('${id}', '${request.userId}', ${request.amount})">
                                        <i class="fas fa-check"></i> Approve
                                    </button>
                                    <button class="btn btn-small btn-danger" onclick="rejectWithdrawal('${id}')">
                                        <i class="fas fa-times"></i> Reject
                                    </button>
                                </td>
                            `;
                            table.appendChild(row);
                        }
                    });
                    
                    if (table.innerHTML === '') {
                        table.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 2rem;">No pending withdrawal requests</td></tr>';
                    }
                });
        }

        function approveWithdrawal(requestId, userId, amount) {
            // Update request status
            database.ref(`withdrawalRequests/${requestId}`).update({ status: 'approved' })
                .then(() => {
                    // Update user balance and withdrawn amount
                    database.ref(`users/${userId}`).once('value')
                        .then((snapshot) => {
                            const user = snapshot.val();
                            if (user) {
                                const newBalance = Math.max(0, (user.balance || 0) - amount);
                                const newWithdrawn = (user.totalWithdrawn || 0) + amount;
                                
                                database.ref(`users/${userId}`).update({ 
                                    balance: newBalance,
                                    totalWithdrawn: newWithdrawn
                                });
                                
                                // Add transaction for user
                                database.ref(`users/${userId}/transactions`).once('value')
                                    .then((snapshot) => {
                                        const transactions = snapshot.val() || [];
                                        transactions.push({
                                            type: 'withdrawal',
                                            amount: amount,
                                            description: 'Withdrawal Approved',
                                            status: 'completed',
                                            timestamp: new Date().toISOString()
                                        });
                                        
                                        database.ref(`users/${userId}/transactions`).set(transactions);
                                    });
                            }
                        });
                    
                    showNotification('Withdrawal approved successfully!', 'success');
                    loadWithdrawalRequests();
                })
                .catch((error) => {
                    showNotification('Error approving withdrawal: ' + error.message, 'error');
                });
        }

        function rejectWithdrawal(requestId) {
            database.ref(`withdrawalRequests/${requestId}`).update({ status: 'rejected' })
                .then(() => {
                    showNotification('Withdrawal rejected!', 'success');
                    loadWithdrawalRequests();
                })
                .catch((error) => {
                    showNotification('Error rejecting withdrawal: ' + error.message, 'error');
                });
        }

        function loadUsers() {
            database.ref('users').once('value')
                .then((snapshot) => {
                    const users = snapshot.val() || {};
                    const table = document.getElementById('adminUsersTable');
                    table.innerHTML = '';
                    
                    Object.entries(users).forEach(([id, user]) => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${user.name || 'Unknown'}</td>
                            <td>${user.email || 'N/A'}</td>
                            <td>$${user.balance || 0}</td>
                            <td>${user.directReferrals || 0}</td>
                            <td><span class="status-badge status-active">Active</span></td>
                            <td>
                                <button class="btn btn-small" onclick="editUser('${id}')">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                            </td>
                        `;
                        table.appendChild(row);
                    });
                });
        }

        function editUser(userId) {
            alert(`Edit user ${userId} functionality would be implemented here.`);
        }

        // ====================
        // CHAT FUNCTIONS
        // ====================
        function showChat() {
            document.getElementById('chatContainer').classList.add('active');
            chatActive = true;
        }

        function hideChat() {
            document.getElementById('chatContainer').classList.remove('active');
            chatActive = false;
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addChatMessage('user', message);
            input.value = '';
            
            // Simulate bot response
            setTimeout(() => {
                const responses = [
                    "Thanks for your message! Our support team will get back to you soon.",
                    "I understand your concern. Can you please provide more details?",
                    "For immediate assistance, please email support@cryptowealth.pro",
                    "Your query has been noted. We'll respond within 24 hours.",
                    "Is there anything specific about our platform you'd like to know?"
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addChatMessage('bot', randomResponse);
            }, 1000);
        }

        function addChatMessage(sender, message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            if (sender === 'user') {
                messageDiv.innerHTML = `<strong>You:</strong> ${message}`;
            } else {
                messageDiv.innerHTML = `<strong>Support Bot:</strong> ${message}`;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // ====================
        // CRYPTO BOT FUNCTIONS
        // ====================
        function showCryptoBot() {
            document.getElementById('cryptoBotModal').classList.add('active');
        }

        function hideCryptoBot() {
            document.getElementById('cryptoBotModal').classList.remove('active');
        }

        function askBotQuestion(topic) {
            let response = "";
            
            switch(topic) {
                case 'bitcoin':
                    response = "Bitcoin (BTC) is the first decentralized cryptocurrency, created in 2009. It operates on blockchain technology with a limited supply of 21 million coins. Current market cap: $1.2 trillion+";
                    break;
                case 'ethereum':
                    response = "Ethereum (ETH) is a decentralized platform for smart contracts and dApps. It's the second-largest cryptocurrency by market cap. ETH 2.0 upgrade transitioned to Proof-of-Stake consensus.";
                    break;
                case 'usdt':
                    response = "USDT (Tether) is a stablecoin pegged 1:1 to the US Dollar. Use BEP20 network for fast and low-cost transactions. Always verify contract address before sending.";
                    break;
                case 'investment':
                    response = "Diversify your portfolio, start with small amounts, research thoroughly, never invest more than you can afford to lose, and consider long-term holding strategies.";
                    break;
                case 'security':
                    response = "Use hardware wallets for large amounts, enable 2FA, never share private keys, verify addresses before sending, and beware of phishing sites.";
                    break;
                case 'withdrawal':
                    response = "Withdrawals take 1-24 hours. Minimum withdrawal: 1 USDT. Fee: 12%. Use BEP20 network only. Ensure wallet address is correct.";
                    break;
                default:
                    response = "I'm here to help with cryptocurrency questions. What would you like to know?";
            }
            
            const botContent = document.querySelector('.bot-content');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'bot-message';
            messageDiv.innerHTML = `<strong>Crypto Bot:</strong> ${response}`;
            
            botContent.insertBefore(messageDiv, botContent.children[1]);
        }

        function askCustomQuestion() {
            const input = document.getElementById('botQuestion');
            const question = input.value.trim();
            
            if (!question) return;
            
            const responses = [
                "That's a great question about cryptocurrency! The key is to research thoroughly and understand the risks involved.",
                "Based on my analysis, diversification and long-term holding often yield better results than short-term trading.",
                "Security should always be your top priority. Use trusted wallets and enable all available security features.",
                "The crypto market is volatile. Consider dollar-cost averaging to minimize risk during price fluctuations.",
                "Always verify information from multiple sources before making investment decisions in cryptocurrency."
            ];
            
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            
            const botContent = document.querySelector('.bot-content');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'bot-message';
            messageDiv.innerHTML = `<strong>Crypto Bot:</strong> ${randomResponse}`;
            
            botContent.insertBefore(messageDiv, botContent.children[1]);
            input.value = '';
        }

        // ====================
        // REFERRAL FUNCTIONS
        // ====================
        function showReferralModal() {
            if (!userData) return;
            
            document.getElementById('referralModal').classList.add('active');
            document.getElementById('referralLinkText').textContent = 
                `https://cryptowealth.pro/ref/${userData.referralCode}`;
        }

        function closeReferralModal() {
            document.getElementById('referralModal').classList.remove('active');
        }

        function copyReferralLink() {
            const link = document.getElementById('referralLinkText').textContent;
            const copyBtn = document.getElementById('copyBtn');
            
            navigator.clipboard.writeText(link)
                .then(() => {
                    copyBtn.classList.add('copy-success');
                    copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                    
                    setTimeout(() => {
                        copyBtn.classList.remove('copy-success');
                        copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copy';
                    }, 2000);
                    
                    showNotification('Referral link copied to clipboard!', 'success');
                })
                .catch((error) => {
                    showNotification('Failed to copy link', 'error');
                });
        }

        function shareOnFacebook() {
            const link = encodeURIComponent(`https://cryptowealth.pro/ref/${userData.referralCode}`);
            const text = encodeURIComponent("Join CryptoWealth Pro and earn 6-7.5% daily returns! 9-level commission structure.");
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${link}&quote=${text}`, '_blank');
        }

        function shareOnWhatsApp() {
            const link = `https://cryptowealth.pro/ref/${userData.referralCode}`;
            const text = `Join CryptoWealth Pro and earn 6-7.5% daily returns! 9-level commission structure. Sign up here: ${link}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }

        function shareOnTelegram() {
            const link = `https://cryptowealth.pro/ref/${userData.referralCode}`;
            const text = `Join CryptoWealth Pro and earn 6-7.5% daily returns! 9-level commission structure. Sign up here: ${link}`;
            window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`, '_blank');
        }

        // ====================
        // PROFILE FUNCTIONS
        // ====================
        function updateProfile() {
            if (!userData) return;
            
            const name = document.getElementById('settingsName').value;
            const email = document.getElementById('settingsEmail').value;
            const phone = document.getElementById('settingsPhone').value;
            const walletAddress = document.getElementById('walletAddress').value;
            
            const updates = {};
            if (name !== userData.name) updates.name = name;
            if (email !== userData.email) updates.email = email;
            if (phone !== userData.phone) updates.phone = phone;
            if (walletAddress !== userData.usdtWallet) {
                if (walletAddress && walletAddress.length < 20) {
                    showNotification('Please enter a valid USDT BEP20 wallet address', 'error');
                    return;
                }
                updates.usdtWallet = walletAddress;
                updates.walletAddress = walletAddress;
            }
            
            if (Object.keys(updates).length > 0) {
                updateUserData(updates)
                    .then(() => {
                        showNotification('Profile updated successfully!', 'success');
                        // Update sidebar
                        updateSidebarProfile();
                    })
                    .catch((error) => {
                        showNotification('Error: ' + error.message, 'error');
                    });
            }
        }

        // ====================
        // UTILITY FUNCTIONS
        // ====================
        function generateReferralCode(name) {
            const initials = name.split(' ').map(n => n[0]).join('').toUpperCase();
            const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
            return initials + random;
        }

        function showNotification(message, type) {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                <div>${message}</div>
            `;
            
            container.appendChild(notification);
            
            // Show notification
            setTimeout(() => notification.classList.add('show'), 10);
            
            // Remove after 5 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }

        // ====================
        // ACTIVE INVESTMENTS SIMULATION
        // ====================
        function simulateActiveInvestments() {
            if (!userData || !userData.activeInvestments) return;
            
            setInterval(() => {
                if (!userData) return;
                
                let hasUpdate = false;
                const updates = {};
                const now = new Date();
                
                // Check each active investment
                userData.activeInvestments.forEach((investment, index) => {
                    if (investment.status === 'active') {
                        const endDate = new Date(investment.endDate);
                        
                        if (now >= endDate) {
                            // Investment completed
                            userData.activeInvestments[index].status = 'completed';
                            hasUpdate = true;
                        }
                    }
                });
                
                if (hasUpdate) {
                    updates.activeInvestments = userData.activeInvestments;
                    updateUserData(updates);
                }
                
            }, 60000); // Check every minute
        }

        // Start investment simulation
        if (userData && userData.activeInvestments) {
            simulateActiveInvestments();
        }
    </script>
</body>
</html>
